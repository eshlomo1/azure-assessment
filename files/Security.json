{
    "1": {
      "Part" :"Defender",
      "num_req": "2",
      "Title": "Active Azure Security Center Recommendations\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that all Microsoft Azure Security Center recommendations generated for your Azure cloud account are examined and implemented in order to follow security best practices and meet regulatory compliance and standards. It is very important to observe active recommendations in security center recommendations.\n",
      "Command":"az",
      "Reference":"https://learn.microsoft.com/en-us/azure/defender-for-cloud/recommendations-reference",
      "Args": "account list --query [*].id",
      "Second_Args": "security task list --subscription",
      "Second_To_Second_Args": "--query [?state=='Active'].name",
      "Problem": "not_equal",
      "Type": "print_iter",
      "Valid":""
    },
    "2": {
      "Part" :"Defender",
      "num_req": "2",
      "Title": "High Severity Azure Security Center Recommendations\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that all Microsoft Azure Security Center recommendations generated for your Azure cloud account are examined and implemented in order to follow security best practices and meet regulatory compliance and standards. It is very important to review high severity recommendations.\n",
      "Command":"az",
      "Reference":"https://github.com/aquasecurity/cloud-security-remediation-guides/blob/master/en/azure/securitycenter/high-severity-alerts-enabled.md",
      "Args": "account list --query [*].id",
      "Second_Args": "security task list --subscription",
      "Second_To_Second_Args": "--query [?securityTaskParameters.severity=='High'].name",
      "Problem": "not_equal",
      "Type": "print_iter",
      "Valid":""
    },
    "3": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Enable Microsoft Defender Standard Pricing Tier\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that Microsoft Defender for Cloud standard pricing tier (also known as enhanced security plan) is active in order to enable threat detection for networks and virtual machines, provide threat intelligence, anomaly detection, and behavior analytics within the protected subscription.\n",
      "Reference":"https://github.com/aquasecurity/cloud-security-remediation-guides/blob/master/en/azure/securitycenter/standard-pricing-enabled.md",
      "Args": "YXogYWNjb3VudCBnZXQtYWNjZXNzLXRva2VuIC0tcXVlcnkgIntzdWJzY3JpcHRpb246c3Vic2NyaXB0aW9uLGFjY2Vzc1Rva2VuOmFjY2Vzc1Rva2VufSIgLS1vdXQgdHN2IHwgeGFyZ3MgLUwxIGJhc2ggLWMgJ2N1cmwgLXMgLVggR0VUIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJDEiIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIEdFVCBodHRwczovL21hbmFnZW1lbnQuYXp1cmUuY29tL3N1YnNjcmlwdGlvbnMvJDAvcHJvdmlkZXJzL01pY3Jvc29mdC5TZWN1cml0eS9wcmljaW5ncz9hcGktdmVyc2lvbj0yMDE3LTA4LTAxLXByZXZpZXcnIHwganEgJy58LnZhbHVlW10gfCBzZWxlY3QoLm5hbWU9PSJkZWZhdWx0IiknfGpxICcucHJvcGVydGllcy5wcmljaW5nVGllcic=",
      "Problem": "not_equal",
      "Type": "oneshot",
      "Valid":"Standard"
    },
    "4": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Configure Additional Email Addresses for Azure Security Center Notifications\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that additional email addresses are configured within Microsoft Azure Security Center settings in order to receive email-based notifications whenever a high-severity alert is triggered within your Azure subscription. For compliance, you should provide one or more security contact email addresses as additional email addresses.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/defender-for-cloud/configure-email-notifications",
      "Args": "YXogYWNjb3VudCBnZXQtYWNjZXNzLXRva2VuIC0tcXVlcnkgIntzdWJzY3JpcHRpb246c3Vic2NyaXB0aW9uLGFjY2Vzc1Rva2VuOmFjY2Vzc1Rva2VufSIgLS1vdXQgdHN2IHwgeGFyZ3MgLUwxIGJhc2ggLWMgJ2N1cmwgLXMgLVggR0VUIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJDEiIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIGh0dHBzOi8vbWFuYWdlbWVudC5henVyZS5jb20vc3Vic2NyaXB0aW9ucy8kMC9wcm92aWRlcnMvTWljcm9zb2Z0LlNlY3VyaXR5L3NlY3VyaXR5Q29udGFjdHM/YXBpLXZlcnNpb249MjAxNy0wOC0wMS1wcmV2aWV3JyB8IGpxICcufC52YWx1ZVtdIHwgc2VsZWN0KC50eXBlPT0iTWljcm9zb2Z0LlNlY3VyaXR5L3NlY3VyaXR5Q29udGFjdHMiKSd8anEgJy5wcm9wZXJ0aWVzLmVtYWlsJw==",
      "Problem": "equal",
      "Type": "oneshot",
      "Valid":""
    },
    "5": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Email Notification for Alerts\n",
      "Risk_Level":"Medium",
      "Descrip": "Enable sending high severity alert notifications to the security contact email address defined within the Microsoft Defender for Cloud settings. The contact information provided will be used by Microsoft Defender for Cloud to contact the subscription owners and/or administrators if the Microsoft Security Response Center (MSRC) detects security issues, such as Remote Desktop Protocol (RDP) attacks or customer data accessed by an unauthorized party. MSRC performs in-depth security monitoring of the Azure network and infrastructure and receives threat intelligence and abuse complaints from third-party partners.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/defender-for-cloud/configure-email-notifications",
      "Args": "YXogYWNjb3VudCBnZXQtYWNjZXNzLXRva2VuIC0tcXVlcnkgIntzdWJzY3JpcHRpb246c3Vic2NyaXB0aW9uLGFjY2Vzc1Rva2VuOmFjY2Vzc1Rva2VufSIgLS1vdXQgdHN2IHwgeGFyZ3MgLUwxIGJhc2ggLWMgJ2N1cmwgLXMgLVggR0VUIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJDEiIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIGh0dHBzOi8vbWFuYWdlbWVudC5henVyZS5jb20vc3Vic2NyaXB0aW9ucy8kMC9wcm92aWRlcnMvTWljcm9zb2Z0LlNlY3VyaXR5L3NlY3VyaXR5Q29udGFjdHM/YXBpLXZlcnNpb249MjAxNy0wOC0wMS1wcmV2aWV3JyB8IGpxICcufC52YWx1ZVtdIHwgc2VsZWN0KC50eXBlPT0iTWljcm9zb2Z0LlNlY3VyaXR5L3NlY3VyaXR5Q29udGFjdHMiKSd8anEgJy5wcm9wZXJ0aWVzLmFsZXJ0Tm90aWZpY2F0aW9ucyc=",
      "Problem": "not_equal",
      "Type": "oneshot",
      "Valid":"On"
    },
    "6": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Email To Subscription Owners\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that Azure subscription owners receive security alert email notifications from Microsoft Defender for Cloud when compromised resources are detected within the Azure account. The contact information, in this case one or more email addresses, is used by the Azure subscription owners to contact the account administrator if the Microsoft Security Response Center (MSRC) discovers that the cloud resources and/or data has been accessed by an unauthorized actor or system.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/defender-for-cloud/configure-email-notifications",
      "Args": "YXogYWNjb3VudCBnZXQtYWNjZXNzLXRva2VuIC0tcXVlcnkgIntzdWJzY3JpcHRpb246c3Vic2NyaXB0aW9uLGFjY2Vzc1Rva2VuOmFjY2Vzc1Rva2VufSIgLS1vdXQgdHN2IHwgeGFyZ3MgLUwxIGJhc2ggLWMgJ2N1cmwgLXMgLVggR0VUIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJDEiIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIGh0dHBzOi8vbWFuYWdlbWVudC5henVyZS5jb20vc3Vic2NyaXB0aW9ucy8kMC9wcm92aWRlcnMvTWljcm9zb2Z0LlNlY3VyaXR5L3NlY3VyaXR5Q29udGFjdHM/YXBpLXZlcnNpb249MjAxNy0wOC0wMS1wcmV2aWV3JyB8IGpxICcufC52YWx1ZVtdIHwgc2VsZWN0KC50eXBlPT0iTWljcm9zb2Z0LlNlY3VyaXR5L3NlY3VyaXR5Q29udGFjdHMiKSd8anEgJy5wcm9wZXJ0aWVzLmFsZXJ0c1RvQWRtaW5zJw==",
      "Problem": "not_equal",
      "Type": "oneshot",
      "Valid":"On"
    },
    "7": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Enable Automatic Provisioning of the Monitoring Agent\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that automatic provisioning of the monitoring agent is enabled in your Microsoft Azure account to collect security data and events from your cloud compute resources in order to help you prevent, detect, and respond efficiently to security vulnerabilities and threats.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/defender-for-cloud/auto-deploy-azure-monitoring-agent",
      "Args": "YXogYWNjb3VudCBnZXQtYWNjZXNzLXRva2VuIC0tcXVlcnkgIntzdWJzY3JpcHRpb246c3Vic2NyaXB0aW9uLGFjY2Vzc1Rva2VuOmFjY2Vzc1Rva2VufSIgLS1vdXQgdHN2IHwgeGFyZ3MgLUwxIGJhc2ggLWMgJ2N1cmwgLXMgLVggR0VUIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJDEiIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIGh0dHBzOi8vbWFuYWdlbWVudC5henVyZS5jb20vc3Vic2NyaXB0aW9ucy8kMC9wcm92aWRlcnMvTWljcm9zb2Z0LlNlY3VyaXR5L2F1dG9Qcm92aXNpb25pbmdTZXR0aW5ncz9hcGktdmVyc2lvbj0yMDE3LTA4LTAxLXByZXZpZXcnIHwganEgJy58LnZhbHVlW10gfCBzZWxlY3QoLm5hbWU9PSJkZWZhdWx0IiknfGpxICcucHJvcGVydGllcy5hdXRvUHJvdmlzaW9uJw==",
      "Problem": "not_equal",
      "Type": "oneshot",
      "Valid":"On"
    },
    "8": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Enable DDoS Protection Standard Monitoring for Public Virtual Networks\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that the monitoring of 'DDoS Protection Standard' feature is enabled within your Microsoft Azure cloud account settings so that Azure Security Center can assess if DDoS protection is enabled for all the Azure Virtual Networks (VNets) with a subnet that is part of an application gateway with a public IP.\n",
      "Reference":"https://azure.microsoft.com/tr-tr/blog/azure-ddos-protection-for-virtual-networks-generally-available/",
      "Args": "YXogYWNjb3VudCBnZXQtYWNjZXNzLXRva2VuIC0tcXVlcnkgIntzdWJzY3JpcHRpb246c3Vic2NyaXB0aW9uLGFjY2Vzc1Rva2VuOmFjY2Vzc1Rva2VufSIgLS1vdXQgdHN2IHwgeGFyZ3MgLUwxIGJhc2ggLWMgJ2N1cmwgLXMgLVggR0VUIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJDEiIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIGh0dHBzOi8vbWFuYWdlbWVudC5henVyZS5jb20vc3Vic2NyaXB0aW9ucy8kMC9wcm92aWRlcnMvTWljcm9zb2Z0LkF1dGhvcml6YXRpb24vcG9saWN5QXNzaWdubWVudHMvU2VjdXJpdHlDZW50ZXJCdWlsdEluP2FwaS12ZXJzaW9uPTIwMTgtMDUtMDEnIHwganEgJ3NlbGVjdCgubmFtZT09IlNlY3VyaXR5Q2VudGVyQnVpbHRJbiIpJ3xqcSAnLnByb3BlcnRpZXMucGFyYW1ldGVycy52bmV0RW5hYmxlRERvU1Byb3RlY3Rpb25Nb25pdG9yaW5nRWZmZWN0LnZhbHVlJw==",
      "Problem": "not_equal",
      "Type": "oneshot",
      "Valid":"Enabled"
    },
    "9": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Enable Defender for Endpoint Integration with Microsoft Defender for Cloud\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that Microsoft Defender for Endpoint integration with Microsoft Defender for Cloud is enabled to allow the Defender for Endpoint security service to access your data in order to help prevent, detect, investigate, and respond to advanced security threats.\n",
      "Reference":"https://learn.microsoft.com/en-us/defender-cloud-apps/mde-integration",
      "Args": "YXogYWNjb3VudCBnZXQtYWNjZXNzLXRva2VuIC0tcXVlcnkgIntzdWJzY3JpcHRpb246c3Vic2NyaXB0aW9uLGFjY2Vzc1Rva2VuOmFjY2Vzc1Rva2VufSIgLS1vdXQgdHN2IHwgeGFyZ3MgLUwxIGJhc2ggLWMgJ2N1cmwgLXMgLVggR0VUIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJDEiIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIGh0dHBzOi8vbWFuYWdlbWVudC5henVyZS5jb20vc3Vic2NyaXB0aW9ucy8kMC9wcm92aWRlcnMvTWljcm9zb2Z0LlNlY3VyaXR5L3NldHRpbmdzP2FwaS12ZXJzaW9uPTIwMTktMDEtMDEnIHwganEgJy58LnZhbHVlW10gfCBzZWxlY3QoLm5hbWU9PSJXREFUUCIpJ3xqcSAnLnByb3BlcnRpZXMuZW5hYmxlZCc=",
      "Problem": "not_equal",
      "Type": "oneshot",
      "Valid":"true"
    },
    "10": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Enable Disk Encryption Monitoring\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that disk encryption monitoring is enabled within your Microsoft Azure cloud account so that Azure Security Center service can detect if your virtual machines (Windows and Linux) have disk encryption enabled.\n",
      "Reference":"https://github.com/aquasecurity/cloud-security-remediation-guides/blob/master/en/azure/securitycenter/monitor-disk-encryption.md",
      "Args": "YXogYWNjb3VudCBnZXQtYWNjZXNzLXRva2VuIC0tcXVlcnkgIntzdWJzY3JpcHRpb246c3Vic2NyaXB0aW9uLGFjY2Vzc1Rva2VuOmFjY2Vzc1Rva2VufSIgLS1vdXQgdHN2IHwgeGFyZ3MgLUwxIGJhc2ggLWMgJ2N1cmwgLXMgLVggR0VUIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJDEiIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIGh0dHBzOi8vbWFuYWdlbWVudC5henVyZS5jb20vc3Vic2NyaXB0aW9ucy8kMC9wcm92aWRlcnMvTWljcm9zb2Z0LkF1dGhvcml6YXRpb24vcG9saWN5QXNzaWdubWVudHMvU2VjdXJpdHlDZW50ZXJCdWlsdEluP2FwaS12ZXJzaW9uPTIwMTgtMDUtMDEnIHwganEgJ3NlbGVjdCgubmFtZT09IlNlY3VyaXR5Q2VudGVyQnVpbHRJbiIpJ3xqcSAnLnByb3BlcnRpZXMucGFyYW1ldGVycy5kaXNrRW5jcnlwdGlvbk1vbml0b3JpbmdFZmZlY3QudmFsdWUn",
      "Problem": "not_equal",
      "Type": "oneshot",
      "Valid":"Enabled"
    },
    "11": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Enable Endpoint Protection Monitoring\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that endpoint protection monitoring is enabled within Azure Security Center in order to identify and remove viruses, spyware, and other malicious software from your Azure virtual machines (VMs). Azure Security Center monitors security configurations using a large set of recommendations for auditing, detecting threats, hardening operating systems, configuring firewalls, setting password policies, and more.\n",
      "Reference":"https://github.com/aquasecurity/cloud-security-remediation-guides/blob/master/en/azure/securitycenter/monitor-endpoint-protection.md",
      "Args": "YXogYWNjb3VudCBnZXQtYWNjZXNzLXRva2VuIC0tcXVlcnkgIntzdWJzY3JpcHRpb246c3Vic2NyaXB0aW9uLGFjY2Vzc1Rva2VuOmFjY2Vzc1Rva2VufSIgLS1vdXQgdHN2IHwgeGFyZ3MgLUwxIGJhc2ggLWMgJ2N1cmwgLXMgLVggR0VUIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJDEiIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIGh0dHBzOi8vbWFuYWdlbWVudC5henVyZS5jb20vc3Vic2NyaXB0aW9ucy8kMC9wcm92aWRlcnMvTWljcm9zb2Z0LkF1dGhvcml6YXRpb24vcG9saWN5QXNzaWdubWVudHMvU2VjdXJpdHlDZW50ZXJCdWlsdEluP2FwaS12ZXJzaW9uPTIwMTgtMDUtMDEnIHwganEgJ3NlbGVjdCgubmFtZT09IlNlY3VyaXR5Q2VudGVyQnVpbHRJbiIpJ3xqcSAnLnByb3BlcnRpZXMucGFyYW1ldGVycy5lbmRwb2ludFByb3RlY3Rpb25Nb25pdG9yaW5nRWZmZWN0LnZhbHVlJw==",
      "Problem": "not_equal",
      "Type": "oneshot",
      "Valid":"Enabled"
    },
    "12": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Enable JIT Network Access Monitoring\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that 'Monitor JIT Network Access' feature is enabled within your Microsoft Azure cloud account settings so that Azure Security Center can assess if Just-In-Time network access is enabled for your eligible VMs. Just-In-Time (JIT) network access can be used to lock down inbound traffic to your Azure VMs, reducing exposure to different types of attacks while providing easy access to your virtual machines when needed.\n",
      "Reference":"https://github.com/aquasecurity/cloud-security-remediation-guides/blob/master/en/azure/securitycenter/monitor-jit-network-access.md",
      "Args": "YXogYWNjb3VudCBnZXQtYWNjZXNzLXRva2VuIC0tcXVlcnkgIntzdWJzY3JpcHRpb246c3Vic2NyaXB0aW9uLGFjY2Vzc1Rva2VuOmFjY2Vzc1Rva2VufSIgLS1vdXQgdHN2IHwgeGFyZ3MgLUwxIGJhc2ggLWMgJ2N1cmwgLXMgLVggR0VUIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJDEiIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIGh0dHBzOi8vbWFuYWdlbWVudC5henVyZS5jb20vc3Vic2NyaXB0aW9ucy8kMC9wcm92aWRlcnMvTWljcm9zb2Z0LkF1dGhvcml6YXRpb24vcG9saWN5QXNzaWdubWVudHMvU2VjdXJpdHlDZW50ZXJCdWlsdEluP2FwaS12ZXJzaW9uPTIwMTgtMDUtMDEnIHwganEgJ3NlbGVjdCgubmFtZT09IlNlY3VyaXR5Q2VudGVyQnVpbHRJbiIpJ3xqcSAnLnByb3BlcnRpZXMucGFyYW1ldGVycy5qaXROZXR3b3JrQWNjZXNzTW9uaXRvcmluZ0VmZmVjdC52YWx1ZSc=",
      "Problem": "not_equal",
      "Type": "oneshot",
      "Valid":"Enabled"
    },
    "13": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Enable Microsoft Defender for Cloud Apps Integration\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that Microsoft Defender for Cloud Apps (formerly known as Microsoft Cloud App Security) integration is enabled within Microsoft Defender for Cloud settings in order to allow the security service to access your data and provide recommendations for missing configuration and security controls.\n",
      "Reference":"https://learn.microsoft.com/en-us/defender-cloud-apps/general-setup",
      "Args": "YXogYWNjb3VudCBnZXQtYWNjZXNzLXRva2VuIC0tcXVlcnkgIntzdWJzY3JpcHRpb246c3Vic2NyaXB0aW9uLGFjY2Vzc1Rva2VuOmFjY2Vzc1Rva2VufSIgLS1vdXQgdHN2IHwgeGFyZ3MgLUwxIGJhc2ggLWMgJ2N1cmwgLXMgLVggR0VUIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJDEiIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIGh0dHBzOi8vbWFuYWdlbWVudC5henVyZS5jb20vc3Vic2NyaXB0aW9ucy8kMC9wcm92aWRlcnMvTWljcm9zb2Z0LlNlY3VyaXR5L3NldHRpbmdzP2FwaS12ZXJzaW9uPTIwMTktMDEtMDEnIHwganEgJy58LnZhbHVlW10gfCBzZWxlY3QoLm5hbWU9PSJNQ0FTIiknfGpxICcucHJvcGVydGllcy5lbmFibGVkJw==",
      "Problem": "not_equal",
      "Type": "oneshot",
      "Valid":"true"
    },
    "14": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Enable Microsoft Defender for Cloud for App Service Instances\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that Microsoft Defender for Cloud is enabled for the Microsoft Azure App Service instances. Turning on Defender for Cloud enables threat detection for Azure App Service, providing threat intelligence, anomaly detection, and behavior analytics.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-app-service-introduction",
      "Args": "YXogYWNjb3VudCBnZXQtYWNjZXNzLXRva2VuIC0tcXVlcnkgIntzdWJzY3JpcHRpb246c3Vic2NyaXB0aW9uLGFjY2Vzc1Rva2VuOmFjY2Vzc1Rva2VufSIgLS1vdXQgdHN2IHwgeGFyZ3MgLUwxIGJhc2ggLWMgJ2N1cmwgLXMgLVggR0VUIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJDEiIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIGh0dHBzOi8vbWFuYWdlbWVudC5henVyZS5jb20vc3Vic2NyaXB0aW9ucy8kMC9wcm92aWRlcnMvTWljcm9zb2Z0LlNlY3VyaXR5L3ByaWNpbmdzP2FwaS12ZXJzaW9uPTIwMTgtMDYtMDEnIHwganEgJy58LnZhbHVlW10gfCBzZWxlY3QoLm5hbWU9PSJBcHBTZXJ2aWNlcyIpJ3xqcSAnLnByb3BlcnRpZXMucHJpY2luZ1RpZXIn",
      "Problem": "not_equal",
      "Type": "oneshot",
      "Valid":"Standard"
    },
    "15": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Enable Microsoft Defender for Cloud for Azure Containers\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that Microsoft Defender for Cloud is enabled for all your Azure containers. Turning on the Defender for Cloud service enables threat detection for containers, providing threat intelligence, anomaly detection, and behavior analytics.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-containers-enable?tabs=aks-deploy-portal%2Ck8s-deploy-asc%2Ck8s-verify-asc%2Ck8s-remove-arc%2Caks-removeprofile-api&pivots=defender-for-container-aks",
      "Args": "YXogYWNjb3VudCBnZXQtYWNjZXNzLXRva2VuIC0tcXVlcnkgIntzdWJzY3JpcHRpb246c3Vic2NyaXB0aW9uLGFjY2Vzc1Rva2VuOmFjY2Vzc1Rva2VufSIgLS1vdXQgdHN2IHwgeGFyZ3MgLUwxIGJhc2ggLWMgJ2N1cmwgLXMgLVggR0VUIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJDEiIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIGh0dHBzOi8vbWFuYWdlbWVudC5henVyZS5jb20vc3Vic2NyaXB0aW9ucy8kMC9wcm92aWRlcnMvTWljcm9zb2Z0LlNlY3VyaXR5L3ByaWNpbmdzP2FwaS12ZXJzaW9uPTIwMTgtMDYtMDEnIHwganEgJy58LnZhbHVlW10gfCBzZWxlY3QoLm5hbWU9PSJDb250YWluZXJzIiknfGpxICcucHJvcGVydGllcy5wcmljaW5nVGllcic=",
      "Problem": "not_equal",
      "Type": "oneshot",
      "Valid":"Standard"
    },
    "16": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Enable Microsoft Defender for Cloud for Azure SQL Database Servers\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that Microsoft Defender for Cloud is enabled for your Azure SQL database servers. Defender for Cloud for SQL database servers includes functionalities for discovering and mitigating potential database vulnerabilities, and detecting anomalous activities that could indicate a threat to your SQL databases. Defender for Cloud protects Azure SQL managed database instances and dedicated SQL pools in Azure Synapse.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/azure-sql/database/azure-defender-for-sql?view=azuresql",
      "Args": "YXogYWNjb3VudCBnZXQtYWNjZXNzLXRva2VuIC0tcXVlcnkgIntzdWJzY3JpcHRpb246c3Vic2NyaXB0aW9uLGFjY2Vzc1Rva2VuOmFjY2Vzc1Rva2VufSIgLS1vdXQgdHN2IHwgeGFyZ3MgLUwxIGJhc2ggLWMgJ2N1cmwgLXMgLVggR0VUIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJDEiIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIGh0dHBzOi8vbWFuYWdlbWVudC5henVyZS5jb20vc3Vic2NyaXB0aW9ucy8kMC9wcm92aWRlcnMvTWljcm9zb2Z0LlNlY3VyaXR5L3ByaWNpbmdzP2FwaS12ZXJzaW9uPTIwMTgtMDYtMDEnIHwganEgJy58LnZhbHVlW10gfCBzZWxlY3QoLm5hbWU9PSJTcWxTZXJ2ZXJzIiknfGpxICcucHJvcGVydGllcy5wcmljaW5nVGllcic=",
      "Problem": "not_equal",
      "Type": "oneshot",
      "Valid":"Standard"
    },
    "17": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Enable Microsoft Defender for Cloud for Key Vaults\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that Microsoft Defender for Cloud is enabled for Azure key vaults. Key Vault is the Azure cloud service that safeguards encryption keys and secrets like certificates, connection-based strings, and passwords.\n",
      "Reference":"https://techcommunity.microsoft.com/t5/microsoft-defender-for-cloud/microsoft-defender-for-key-vault/ba-p/1825055",
      "Args": "YXogYWNjb3VudCBnZXQtYWNjZXNzLXRva2VuICAtLXF1ZXJ5ICJ7c3Vic2NyaXB0aW9uOnN1YnNjcmlwdGlvbixhY2Nlc3NUb2tlbjphY2Nlc3NUb2tlbn0iIC0tb3V0IHRzdiB8IHhhcmdzIC1MMSBiYXNoIC1jICdjdXJsIC1zIC1YIEdFVCAtSCAiQXV0aG9yaXphdGlvbjogQmVhcmVyICQxIiAtSCAiQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi9qc29uIiBodHRwczovL21hbmFnZW1lbnQuYXp1cmUuY29tL3N1YnNjcmlwdGlvbnMvJDAvcHJvdmlkZXJzL01pY3Jvc29mdC5TZWN1cml0eS9wcmljaW5ncz9hcGktdmVyc2lvbj0yMDE4LTA2LTAxJyB8IGpxICcufC52YWx1ZVtdIHwgc2VsZWN0KC5uYW1lPT0iS2V5VmF1bHRzIiknfGpxICcucHJvcGVydGllcy5wcmljaW5nVGllcic=",
      "Problem": "not_equal",
      "Type": "oneshot",
      "Valid":"Standard"
    },
    "18": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Enable Microsoft Defender for Cloud for SQL Server Virtual Machines\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that Microsoft Defender for Cloud is enabled for the Microsoft SQL servers running on virtual machines (VMs). Defender for Cloud for SQL servers on virtual machines provides functionalities for discovering and mitigating potential database vulnerabilities, and detecting abnormal activities that could indicate a threat to your Microsoft SQL database servers. Defender for Cloud extends the protections for your SQL VM servers to fully support hybrid environments and protect SQL servers hosted within Microsoft Azure cloud, other cloud environments, and even on-premises machines.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-sql-usage",
      "Args": "YXogYWNjb3VudCBnZXQtYWNjZXNzLXRva2VuIC0tcXVlcnkgIntzdWJzY3JpcHRpb246c3Vic2NyaXB0aW9uLGFjY2Vzc1Rva2VuOmFjY2Vzc1Rva2VufSIgLS1vdXQgdHN2IHwgeGFyZ3MgLUwxIGJhc2ggLWMgJ2N1cmwgLXMgLVggR0VUIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJDEiIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIGh0dHBzOi8vbWFuYWdlbWVudC5henVyZS5jb20vc3Vic2NyaXB0aW9ucy8kMC9wcm92aWRlcnMvTWljcm9zb2Z0LlNlY3VyaXR5L3ByaWNpbmdzP2FwaS12ZXJzaW9uPTIwMTgtMDYtMDEnIHwganEgJy58LnZhbHVlW10gfCBzZWxlY3QoLm5hbWU9PSJTcWxTZXJ2ZXJWaXJ0dWFsTWFjaGluZXMiKSd8anEgJy5wcm9wZXJ0aWVzLnByaWNpbmdUaWVyJw==",
      "Problem": "not_equal",
      "Type": "oneshot",
      "Valid":"Standard"
    },
    "19": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Enable Microsoft Defender for Cloud for Storage Accounts\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that Microsoft Defender for Cloud is enabled for your Microsoft Azure storage accounts. Defender for storage accounts is an Azure-native layer of security intelligence that detects unusual and potentially harmful attempts to access or exploit your Azure cloud storage accounts.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/storage/common/azure-defender-storage-configure?tabs=per-storage-account",
      "Args": "YXogYWNjb3VudCBnZXQtYWNjZXNzLXRva2VuIC0tcXVlcnkgIntzdWJzY3JpcHRpb246c3Vic2NyaXB0aW9uLGFjY2Vzc1Rva2VuOmFjY2Vzc1Rva2VufSIgLS1vdXQgdHN2IHwgeGFyZ3MgLUwxIGJhc2ggLWMgJ2N1cmwgLXMgLVggR0VUIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJDEiIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIGh0dHBzOi8vbWFuYWdlbWVudC5henVyZS5jb20vc3Vic2NyaXB0aW9ucy8kMC9wcm92aWRlcnMvTWljcm9zb2Z0LlNlY3VyaXR5L3ByaWNpbmdzP2FwaS12ZXJzaW9uPTIwMTgtMDYtMDEnIHwganEgJy58LnZhbHVlW10gfCBzZWxlY3QoLm5hbWU9PSJTdG9yYWdlQWNjb3VudHMiKSd8anEgJy5wcm9wZXJ0aWVzLnByaWNpbmdUaWVyJw==",
      "Problem": "not_equal",
      "Type": "oneshot",
      "Valid":"Standard"
    },
    "20": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Enable Microsoft Defender for Cloud for Virtual Machines\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that Microsoft Defender for Cloud is enabled for the virtual machine (VM) servers provisioned in your Azure cloud account. The threat detection and protection capabilities provided by Microsoft Defender for Cloud for VM servers include vulnerability assessment scanning, file integrity monitoring (also known as change monitoring), Just-in-time (JIT) virtual machine access monitoring, adaptive network hardening (ANH), fileless attack detection, and Docker host hardening.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/defender-for-cloud/enable-enhanced-security",
      "Args": "YXogYWNjb3VudCBnZXQtYWNjZXNzLXRva2VuIC0tcXVlcnkgIntzdWJzY3JpcHRpb246c3Vic2NyaXB0aW9uLGFjY2Vzc1Rva2VuOmFjY2Vzc1Rva2VufSIgLS1vdXQgdHN2IHwgeGFyZ3MgLUwxIGJhc2ggLWMgJ2N1cmwgLXMgLVggR0VUIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJDEiIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIGh0dHBzOi8vbWFuYWdlbWVudC5henVyZS5jb20vc3Vic2NyaXB0aW9ucy8kMC9wcm92aWRlcnMvTWljcm9zb2Z0LlNlY3VyaXR5L3ByaWNpbmdzP2FwaS12ZXJzaW9uPTIwMTgtMDYtMDEnIHwganEgJy58LnZhbHVlW10gfCBzZWxlY3QoLm5hbWU9PSJWaXJ0dWFsTWFjaGluZXMiKSd8anEgJy5wcm9wZXJ0aWVzLnByaWNpbmdUaWVyJw==",
      "Problem": "not_equal",
      "Type": "oneshot",
      "Valid":"Standard"
    },
    "21": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Enable Monitoring of Deprecated Accounts\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that all the deprecated accounts within your Azure cloud subscription(s) are monitored so that Microsoft Azure Security Center can determine if there are any accounts that need to be removed in order protect against unauthorized access. Deprecated accounts are those accounts that are no longer needed, and blocked from signing in by Azure Active Directory (AAD).\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/defender-for-cloud/policy-reference",
      "Args": "YXogYWNjb3VudCBnZXQtYWNjZXNzLXRva2VuIC0tcXVlcnkgIntzdWJzY3JpcHRpb246c3Vic2NyaXB0aW9uLGFjY2Vzc1Rva2VuOmFjY2Vzc1Rva2VufSIgLS1vdXQgdHN2IHwgeGFyZ3MgLUwxIGJhc2ggLWMgJ2N1cmwgLXMgLVggR0VUIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJDEiIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIGh0dHBzOi8vbWFuYWdlbWVudC5henVyZS5jb20vc3Vic2NyaXB0aW9ucy8kMC9wcm92aWRlcnMvTWljcm9zb2Z0LkF1dGhvcml6YXRpb24vcG9saWN5QXNzaWdubWVudHMvU2VjdXJpdHlDZW50ZXJCdWlsdEluP2FwaS12ZXJzaW9uPTIwMTgtMDUtMDEnIHwganEgJ3NlbGVjdCgubmFtZT09IlNlY3VyaXR5Q2VudGVyQnVpbHRJbiIpJ3xqcSAnLnByb3BlcnRpZXMucGFyYW1ldGVycy5pZGVudGl0eVJlbW92ZURlcHJlY2F0ZWRBY2NvdW50TW9uaXRvcmluZ0VmZmVjdC52YWx1ZSc=",
      "Problem": "not_equal",
      "Type": "oneshot",
      "Valid":"Enabled"
    },
    "22": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Enable Network Security Group Monitoring\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that network security group monitoring is enabled within your Microsoft Azure cloud account so that Azure Security Center service can audit the network security groups associated with your VMs for overly permissive traffic rules.\n",
      "Reference":"https://github.com/aquasecurity/cloud-security-remediation-guides/blob/master/en/azure/securitycenter/monitor-nsg-enabled.md",
      "Args": "YXogYWNjb3VudCBnZXQtYWNjZXNzLXRva2VuIC0tcXVlcnkgIntzdWJzY3JpcHRpb246c3Vic2NyaXB0aW9uLGFjY2Vzc1Rva2VuOmFjY2Vzc1Rva2VufSIgLS1vdXQgdHN2IHwgeGFyZ3MgLUwxIGJhc2ggLWMgJ2N1cmwgLXMgLVggR0VUIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJDEiIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIGh0dHBzOi8vbWFuYWdlbWVudC5henVyZS5jb20vc3Vic2NyaXB0aW9ucy8kMC9wcm92aWRlcnMvTWljcm9zb2Z0LkF1dGhvcml6YXRpb24vcG9saWN5QXNzaWdubWVudHMvU2VjdXJpdHlDZW50ZXJCdWlsdEluP2FwaS12ZXJzaW9uPTIwMTgtMDUtMDEnIHwganEgJ3NlbGVjdCgubmFtZT09IlNlY3VyaXR5Q2VudGVyQnVpbHRJbiIpJ3xqcSAnLnByb3BlcnRpZXMucGFyYW1ldGVycy5uZXR3b3JrU2VjdXJpdHlHcm91cHNNb25pdG9yaW5nRWZmZWN0LnZhbHVlJw==",
      "Problem": "not_equal",
      "Type": "oneshot",
      "Valid":"Enabled"
    },
    "23": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Enable Next Generation Firewall (NGFW) Monitoring\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that Next Generation Firewall (NGFW) monitoring is enabled within your Microsoft Azure cloud account so that Azure Security Center can assess if the necessary network endpoints have a next generation firewall solution currently deployed. A Next Generation Firewall (NGFW) represents the third generation of firewall technology that combines a traditional firewall with other network device filtering functionalities such as application firewalls using in-line Deep Packet Inspection (DPI), Intrusion Prevention Systems (IPSs), TLS/SSL encrypted traffic inspectors, website filtering, QoS/bandwidth management, antivirus and 3rd-party identity management integration (i.e. LDAP, Active Directory, RADIUS). The goal of NGFWs is to include more layers of the OSI model, improving filtering of network traffic that is dependent on the packet contents.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/defender-for-cloud/policy-reference",
      "Args": "YXogYWNjb3VudCBnZXQtYWNjZXNzLXRva2VuIC0tcXVlcnkgIntzdWJzY3JpcHRpb246c3Vic2NyaXB0aW9uLGFjY2Vzc1Rva2VuOmFjY2Vzc1Rva2VufSIgLS1vdXQgdHN2IHwgeGFyZ3MgLUwxIGJhc2ggLWMgJ2N1cmwgLXMgLVggR0VUIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJDEiIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIGh0dHBzOi8vbWFuYWdlbWVudC5henVyZS5jb20vc3Vic2NyaXB0aW9ucy8kMC9wcm92aWRlcnMvTWljcm9zb2Z0LkF1dGhvcml6YXRpb24vcG9saWN5QXNzaWdubWVudHMvU2VjdXJpdHlDZW50ZXJCdWlsdEluP2FwaS12ZXJzaW9uPTIwMTgtMDUtMDEnIHwganEgJ3NlbGVjdCgubmFtZT09IlNlY3VyaXR5Q2VudGVyQnVpbHRJbiIpJ3xqcSAnLnByb3BlcnRpZXMucGFyYW1ldGVycy5uZXh0R2VuZXJhdGlvbkZpcmV3YWxsTW9uaXRvcmluZ0VmZmVjdC52YWx1ZSc=",
      "Problem": "not_equal",
      "Type": "oneshot",
      "Valid":"Enabled"
    },
    "24": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Enable SQL Encryption Monitoring\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that 'Monitor SQL Encryption' feature is enabled within your Microsoft Azure cloud account settings so that Azure Security Center can verify if your SQL database servers have encryption enabled.\n",
      "Reference":"https://github.com/aquasecurity/cloud-security-remediation-guides/blob/master/en/azure/securitycenter/monitor-sql-encryption.md",
      "Args": "YXogYWNjb3VudCBnZXQtYWNjZXNzLXRva2VuIC0tcXVlcnkgIntzdWJzY3JpcHRpb246c3Vic2NyaXB0aW9uLGFjY2Vzc1Rva2VuOmFjY2Vzc1Rva2VufSIgLS1vdXQgdHN2IHwgeGFyZ3MgLUwxIGJhc2ggLWMgJ2N1cmwgLXMgLVggR0VUIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJDEiIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIGh0dHBzOi8vbWFuYWdlbWVudC5henVyZS5jb20vc3Vic2NyaXB0aW9ucy8kMC9wcm92aWRlcnMvTWljcm9zb2Z0LkF1dGhvcml6YXRpb24vcG9saWN5QXNzaWdubWVudHMvU2VjdXJpdHlDZW50ZXJCdWlsdEluP2FwaS12ZXJzaW9uPTIwMTgtMDUtMDEnIHwganEgJ3NlbGVjdCgubmFtZT09IlNlY3VyaXR5Q2VudGVyQnVpbHRJbiIpJ3xqcSAnLnByb3BlcnRpZXMucGFyYW1ldGVycy5zcWxFbmNyeXB0aW9uTW9uaXRvcmluZ0VmZmVjdC52YWx1ZSc=",
      "Problem": "not_equal",
      "Type": "oneshot",
      "Valid":"Enabled"
    },
    "25": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Enable Storage Encryption Monitoring\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that 'Monitor Storage Blob Encryption' feature is enabled within your Microsoft Azure cloud account so that Azure Security Center can assess storage accounts for encryption at rest. 'Monitor Storage Blob Encryption' applies only to Microsoft Azure Storage resources.\n",
      "Reference":"https://github.com/aquasecurity/cloud-security-remediation-guides/blob/master/en/azure/securitycenter/monitor-blob-encryption.md",
      "Args": "YXogYWNjb3VudCBnZXQtYWNjZXNzLXRva2VuIC0tcXVlcnkgIntzdWJzY3JpcHRpb246c3Vic2NyaXB0aW9uLGFjY2Vzc1Rva2VuOmFjY2Vzc1Rva2VufSIgLS1vdXQgdHN2IHwgeGFyZ3MgLUwxIGJhc2ggLWMgJ2N1cmwgLXMgLVggR0VUIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJDEiIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIGh0dHBzOi8vbWFuYWdlbWVudC5henVyZS5jb20vc3Vic2NyaXB0aW9ucy8kMC9wcm92aWRlcnMvTWljcm9zb2Z0LkF1dGhvcml6YXRpb24vcG9saWN5QXNzaWdubWVudHMvU2VjdXJpdHlDZW50ZXJCdWlsdEluP2FwaS12ZXJzaW9uPTIwMTgtMDUtMDEnIHwganEgJ3NlbGVjdCgubmFtZT09IlNlY3VyaXR5Q2VudGVyQnVpbHRJbiIpJ3xqcSAnLnByb3BlcnRpZXMucGFyYW1ldGVycy5zdG9yYWdlRW5jcnlwdGlvbk1vbml0b3JpbmdFZmZlY3QudmFsdWUn",
      "Problem": "not_equal",
      "Type": "oneshot",
      "Valid":"Enabled"
    },
    "26": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Enable System Updates Monitoring\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that system updates monitoring is enabled within your Azure cloud account in order to be notified about the security and critical updates released from Microsoft Windows Update or Microsoft Windows Server Update service.\n",
      "Reference":"https://github.com/aquasecurity/cloud-security-remediation-guides/blob/master/en/azure/securitycenter/monitor-system-updates.md",
      "Args": "YXogYWNjb3VudCBnZXQtYWNjZXNzLXRva2VuIC0tcXVlcnkgIntzdWJzY3JpcHRpb246c3Vic2NyaXB0aW9uLGFjY2Vzc1Rva2VuOmFjY2Vzc1Rva2VufSIgLS1vdXQgdHN2IHwgeGFyZ3MgLUwxIGJhc2ggLWMgJ2N1cmwgLXMgLVggR0VUIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJDEiIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIGh0dHBzOi8vbWFuYWdlbWVudC5henVyZS5jb20vc3Vic2NyaXB0aW9ucy8kMC9wcm92aWRlcnMvTWljcm9zb2Z0LkF1dGhvcml6YXRpb24vcG9saWN5QXNzaWdubWVudHMvU2VjdXJpdHlDZW50ZXJCdWlsdEluP2FwaS12ZXJzaW9uPTIwMTgtMDUtMDEnIHwganEgJ3NlbGVjdCgubmFtZT09IlNlY3VyaXR5Q2VudGVyQnVpbHRJbiIpJ3xqcSAnLnByb3BlcnRpZXMucGFyYW1ldGVycy5zeXN0ZW1VcGRhdGVzTW9uaXRvcmluZ0VmZmVjdC52YWx1ZSc=",
      "Problem": "not_equal",
      "Type": "oneshot",
      "Valid":"Enabled"
    },
    "27": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Enable Virtual Machine IP Forwarding Monitoring\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that the IP Forwarding feature available for your Microsoft Azure virtual machines (VMs) is monitored by the Azure Security Center service for security and compliance purposes.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/defender-for-cloud/policy-reference",
      "Args": "YXogYWNjb3VudCBnZXQtYWNjZXNzLXRva2VuIC0tcXVlcnkgIntzdWJzY3JpcHRpb246c3Vic2NyaXB0aW9uLGFjY2Vzc1Rva2VuOmFjY2Vzc1Rva2VufSIgLS1vdXQgdHN2IHwgeGFyZ3MgLUwxIGJhc2ggLWMgJ2N1cmwgLXMgLVggR0VUIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJDEiIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIGh0dHBzOi8vbWFuYWdlbWVudC5henVyZS5jb20vc3Vic2NyaXB0aW9ucy8kMC9wcm92aWRlcnMvTWljcm9zb2Z0LkF1dGhvcml6YXRpb24vcG9saWN5QXNzaWdubWVudHMvU2VjdXJpdHlDZW50ZXJCdWlsdEluP2FwaS12ZXJzaW9uPTIwMTgtMDUtMDEnIHwganEgJ3NlbGVjdCgubmFtZT09IlNlY3VyaXR5Q2VudGVyQnVpbHRJbiIpJ3xqcSAnLnByb3BlcnRpZXMucGFyYW1ldGVycy5kaXNhYmxlSVBGb3J3YXJkaW5nTW9uaXRvcmluZ0VmZmVjdC52YWx1ZSc=",
      "Problem": "not_equal",
      "Type": "oneshot",
      "Valid":"Enabled"
    },
    "28": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Enable Vulnerability Assessment Monitoring\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that 'Monitor Vulnerability Assessment' feature is enabled within your Microsoft Azure cloud account so that Azure Security Center can recommend a vulnerability assessment solution to be installed on your VMs. The vulnerability assessment is part of the Azure Security Center recommendations for virtual machine (VMs). Once the monitoring feature is enabled, Security Center searches your VMs for deployed vulnerability assessment solutions and if doesn't find any, it recommends that you install one. After such a solution is being deployed, a partner agent starts reporting vulnerability data to the partnerâ€™s management platform. In turn, the partner's management platform provides vulnerability monitoring data back to Azure Security Center so you can rapidly identify any vulnerable VMs on your Security Center dashboard.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/defender-for-cloud/policy-reference",
      "Args": "YXogYWNjb3VudCBnZXQtYWNjZXNzLXRva2VuIC0tcXVlcnkgIntzdWJzY3JpcHRpb246c3Vic2NyaXB0aW9uLGFjY2Vzc1Rva2VuOmFjY2Vzc1Rva2VufSIgLS1vdXQgdHN2IHwgeGFyZ3MgLUwxIGJhc2ggLWMgJ2N1cmwgLXMgLVggR0VUIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJDEiIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIGh0dHBzOi8vbWFuYWdlbWVudC5henVyZS5jb20vc3Vic2NyaXB0aW9ucy8kMC9wcm92aWRlcnMvTWljcm9zb2Z0LkF1dGhvcml6YXRpb24vcG9saWN5QXNzaWdubWVudHMvU2VjdXJpdHlDZW50ZXJCdWlsdEluP2FwaS12ZXJzaW9uPTIwMTgtMDUtMDEnIHwganEgJ3NlbGVjdCgubmFtZT09IlNlY3VyaXR5Q2VudGVyQnVpbHRJbiIpJ3xqcSAnLnByb3BlcnRpZXMucGFyYW1ldGVycy52dWxuZXJhYmlsaXR5QXNzZXNtZW50TW9uaXRvcmluZ0VmZmVjdC52YWx1ZSc=",
      "Problem": "not_equal",
      "Type": "oneshot",
      "Valid":"Enabled"
    },
    "29": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Enable Web Application Firewall Monitoring\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that Web Application Firewall (WAF) monitoring is enabled within your Microsoft Azure cloud account so that Azure Security Center can determine if your virtual machines (Windows and Linux) are associated with application firewalls for controlling traffic in and out of VMs.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/defender-for-cloud/policy-reference",
      "Args": "YXogYWNjb3VudCBnZXQtYWNjZXNzLXRva2VuIC0tcXVlcnkgIntzdWJzY3JpcHRpb246c3Vic2NyaXB0aW9uLGFjY2Vzc1Rva2VuOmFjY2Vzc1Rva2VufSIgLS1vdXQgdHN2IHwgeGFyZ3MgLUwxIGJhc2ggLWMgJ2N1cmwgLXMgLVggR0VUIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJDEiIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIGh0dHBzOi8vbWFuYWdlbWVudC5henVyZS5jb20vc3Vic2NyaXB0aW9ucy8kMC9wcm92aWRlcnMvTWljcm9zb2Z0LkF1dGhvcml6YXRpb24vcG9saWN5QXNzaWdubWVudHMvU2VjdXJpdHlDZW50ZXJCdWlsdEluP2FwaS12ZXJzaW9uPTIwMTgtMDUtMDEnIHwganEgJ3NlbGVjdCgubmFtZT09IlNlY3VyaXR5Q2VudGVyQnVpbHRJbiIpJ3xqcSAnLnByb3BlcnRpZXMucGFyYW1ldGVycy53ZWJBcHBsaWNhdGlvbkZpcmV3YWxsTW9uaXRvcmluZ0VmZmVjdC52YWx1ZSc=",
      "Problem": "not_equal",
      "Type": "oneshot",
      "Valid":"Enabled"
    },
    "30": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Monitor Adaptive Application Safelisting\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that the monitoring of the adaptive application controls is enabled within your Microsoft Azure cloud account so that Microsoft Defender for Cloud can determine if the Adaptive Application Control feature is enabled for your eligible virtual machines (VMs). Adaptive Application Control is an automated application whitelisting solution provided by Microsoft Defender for Cloud that helps you deal with malicious and/or unauthorized software, by allowing only specific applications to run on your Azure and non-Azure VMs (using both Windows and Linux).\n",
      "Reference":"https://github.com/aquasecurity/cloud-security-remediation-guides/blob/master/en/azure/securitycenter/application-whitelisting-enabled.md",
      "Args": "YXogYWNjb3VudCBnZXQtYWNjZXNzLXRva2VuIC0tcXVlcnkgIntzdWJzY3JpcHRpb246c3Vic2NyaXB0aW9uLGFjY2Vzc1Rva2VuOmFjY2Vzc1Rva2VufSIgLS1vdXQgdHN2IHwgeGFyZ3MgLUwxIGJhc2ggLWMgJ2N1cmwgLXMgLVggR0VUIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJDEiIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIGh0dHBzOi8vbWFuYWdlbWVudC5henVyZS5jb20vc3Vic2NyaXB0aW9ucy8kMC9wcm92aWRlcnMvTWljcm9zb2Z0LkF1dGhvcml6YXRpb24vcG9saWN5QXNzaWdubWVudHMvU2VjdXJpdHlDZW50ZXJCdWlsdEluP2FwaS12ZXJzaW9uPTIwMTgtMDUtMDEnIHwganEgJ3NlbGVjdCgubmFtZT09IlNlY3VyaXR5Q2VudGVyQnVpbHRJbiIpJ3xqcSAnLnByb3BlcnRpZXMucGFyYW1ldGVycy5hZGFwdGl2ZUFwcGxpY2F0aW9uQ29udHJvbHNNb25pdG9yaW5nRWZmZWN0LnZhbHVlJw==",
      "Problem": "not_equal",
      "Type": "oneshot",
      "Valid":"Enabled"
    },
    "31": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Monitor External Accounts with Write Permissions\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that all the external accounts that have write permissions to your Microsoft Azure subscription are monitored for review and audit purposes using the Azure Security Center service.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/defender-for-cloud/policy-reference",
      "Args": "YXogYWNjb3VudCBnZXQtYWNjZXNzLXRva2VuIC0tcXVlcnkgIntzdWJzY3JpcHRpb246c3Vic2NyaXB0aW9uLGFjY2Vzc1Rva2VuOmFjY2Vzc1Rva2VufSIgLS1vdXQgdHN2IHwgeGFyZ3MgLUwxIGJhc2ggLWMgJ2N1cmwgLXMgLVggR0VUIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJDEiIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIGh0dHBzOi8vbWFuYWdlbWVudC5henVyZS5jb20vc3Vic2NyaXB0aW9ucy8kMC9wcm92aWRlcnMvTWljcm9zb2Z0LkF1dGhvcml6YXRpb24vcG9saWN5QXNzaWdubWVudHMvU2VjdXJpdHlDZW50ZXJCdWlsdEluP2FwaS12ZXJzaW9uPTIwMTgtMDUtMDEnIHwganEgJ3NlbGVjdCgubmFtZT09IlNlY3VyaXR5Q2VudGVyQnVpbHRJbiIpJ3xqcSAnLnByb3BlcnRpZXMucGFyYW1ldGVycy5pZGVudGl0eVJlbW92ZUV4dGVybmFsQWNjb3VudFdpdGhXcml0ZVBlcm1pc3Npb25zTW9uaXRvcmluZ0VmZmVjdC52YWx1ZSc=",
      "Problem": "not_equal",
      "Type": "oneshot",
      "Valid":"Enabled"
    },
    "32": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Monitor OS Vulnerabilities\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that monitoring for operating system (OS) vulnerabilities is enabled within the Microsoft Defender for Cloud security policy in order to determine if your Azure virtual machines are vulnerable to attacks. Microsoft Defender for Cloud analyzes daily the operating system of your virtual machines for configurations that could make these VMs more vulnerable to cyberattacks. Microsoft Defender for Cloud also recommends specific configuration changes that you can apply in order to address any OS vulnerability found.\n",
      "Reference":"https://github.com/aquasecurity/cloud-security-remediation-guides/blob/master/en/azure/securitycenter/monitor-vm-vulnerability.md",
      "Args": "YXogYWNjb3VudCBnZXQtYWNjZXNzLXRva2VuIC0tcXVlcnkgIntzdWJzY3JpcHRpb246c3Vic2NyaXB0aW9uLGFjY2Vzc1Rva2VuOmFjY2Vzc1Rva2VufSIgLS1vdXQgdHN2IHwgeGFyZ3MgLUwxIGJhc2ggLWMgJ2N1cmwgLXMgLVggR0VUIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJDEiIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIGh0dHBzOi8vbWFuYWdlbWVudC5henVyZS5jb20vc3Vic2NyaXB0aW9ucy8kMC9wcm92aWRlcnMvTWljcm9zb2Z0LkF1dGhvcml6YXRpb24vcG9saWN5QXNzaWdubWVudHMvU2VjdXJpdHlDZW50ZXJCdWlsdEluP2FwaS12ZXJzaW9uPTIwMTgtMDUtMDEnIHwganEgJ3NlbGVjdCgubmFtZT09IlNlY3VyaXR5Q2VudGVyQnVpbHRJbiIpJ3xqcSAnLnByb3BlcnRpZXMucGFyYW1ldGVycy5zeXN0ZW1Db25maWd1cmF0aW9uc01vbml0b3JpbmdFZmZlY3QudmFsdWUn",
      "Problem": "not_equal",
      "Type": "oneshot",
      "Valid":"Enabled"
    },
    "33": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Monitor SQL Auditing\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that monitoring for unaudited Microsoft SQL servers is enabled within your Azure account so that Microsoft Defender for Cloud can determine if your SQL database servers have security auditing and threat detection enabled.\n",
      "Reference":"https://github.com/aquasecurity/cloud-security-remediation-guides/blob/master/en/azure/securitycenter/monitor-sql-auditing.md",
      "Args": "IGF6IGFjY291bnQgZ2V0LWFjY2Vzcy10b2tlbiAtLXF1ZXJ5ICJ7c3Vic2NyaXB0aW9uOnN1YnNjcmlwdGlvbixhY2Nlc3NUb2tlbjphY2Nlc3NUb2tlbn0iIC0tb3V0IHRzdiB8IHhhcmdzIC1MMSBiYXNoIC1jICdjdXJsIC1zIC1YIEdFVCAtSCAiQXV0aG9yaXphdGlvbjogQmVhcmVyICQxIiAtSCAiQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi9qc29uIiBodHRwczovL21hbmFnZW1lbnQuYXp1cmUuY29tL3N1YnNjcmlwdGlvbnMvJDAvcHJvdmlkZXJzL01pY3Jvc29mdC5BdXRob3JpemF0aW9uL3BvbGljeUFzc2lnbm1lbnRzL1NlY3VyaXR5Q2VudGVyQnVpbHRJbj9hcGktdmVyc2lvbj0yMDE4LTA1LTAxJyB8IGpxICdzZWxlY3QoLm5hbWU9PSJTZWN1cml0eUNlbnRlckJ1aWx0SW4iKSd8anEgJy5wcm9wZXJ0aWVzLnBhcmFtZXRlcnMuc3FsU2VydmVyQXVkaXRpbmdNb25pdG9yaW5nRWZmZWN0LnZhbHVlJw==",
      "Problem": "not_equal",
      "Type": "oneshot",
      "Valid":"Enabled"
    },
    "34": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Monitor the Total Number of Subscription Owners\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that the total number of subscription owners created for your Microsoft Azure account subscriptions is monitored by Azure Security Center service. Cloud Conformity recommends designating up to 3 Azure subscription owners in order to reduce the potential for security breaches by one or more compromised owners.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/defender-for-cloud/policy-reference",
      "Args": "YXogYWNjb3VudCBnZXQtYWNjZXNzLXRva2VuIC0tcXVlcnkgIntzdWJzY3JpcHRpb246c3Vic2NyaXB0aW9uLGFjY2Vzc1Rva2VuOmFjY2Vzc1Rva2VufSIgLS1vdXQgdHN2IHwgeGFyZ3MgLUwxIGJhc2ggLWMgJ2N1cmwgLXMgLVggR0VUIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJDEiIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIGh0dHBzOi8vbWFuYWdlbWVudC5henVyZS5jb20vc3Vic2NyaXB0aW9ucy8kMC9wcm92aWRlcnMvTWljcm9zb2Z0LkF1dGhvcml6YXRpb24vcG9saWN5QXNzaWdubWVudHMvU2VjdXJpdHlDZW50ZXJCdWlsdEluP2FwaS12ZXJzaW9uPTIwMTgtMDUtMDEnIHwganEgJ3NlbGVjdCgubmFtZT09IlNlY3VyaXR5Q2VudGVyQnVpbHRJbiIpJ3xqcSAnLnByb3BlcnRpZXMucGFyYW1ldGVycy5pZGVudGl0eURlc2lnbmF0ZUxlc3NUaGFuT3duZXJzTW9uaXRvcmluZ0VmZmVjdC52YWx1ZSc=",
      "Problem": "not_equal",
      "Type": "oneshot",
      "Valid":"Enabled"
    },
    "35": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Security Contact Emails In Use\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that appropriate contact information, in this case one or more email addresses, is set for the administrator who should be notified when Azure Security Center detects compromised resources within your Microsoft Azure cloud account. The contact information is used by Microsoft to contact your account administrator if the Microsoft Security Response Center (MSRC) discovers that your cloud resources and/or data has been accessed by an unauthorized actor or system.\n",
      "Reference":"https://github.com/aquasecurity/cloud-security-remediation-guides/blob/master/en/azure/securitycenter/security-contacts-enabled.md",
      "Args": "YXogYWNjb3VudCBnZXQtYWNjZXNzLXRva2VuIC0tcXVlcnkgIntzdWJzY3JpcHRpb246c3Vic2NyaXB0aW9uLGFjY2Vzc1Rva2VuOmFjY2Vzc1Rva2VufSIgLS1vdXQgdHN2IHwgeGFyZ3MgLUwxIGJhc2ggLWMgJ2N1cmwgLXMgLVggR0VUIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJDEiIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIGh0dHBzOi8vbWFuYWdlbWVudC5henVyZS5jb20vc3Vic2NyaXB0aW9ucy8kMC9wcm92aWRlcnMvTWljcm9zb2Z0LkF1dGhvcml6YXRpb24vcG9saWN5QXNzaWdubWVudHMvU2VjdXJpdHlDZW50ZXJCdWlsdEluP2FwaS12ZXJzaW9uPTIwMTgtMDUtMDEnIHwganEgJ3NlbGVjdCgubmFtZT09IlNlY3VyaXR5Q2VudGVyQnVpbHRJbiIpJ3xqcSAnLnByb3BlcnRpZXMucGFyYW1ldGVycy5pZGVudGl0eURlc2lnbmF0ZUxlc3NUaGFuT3duZXJzTW9uaXRvcmluZ0VmZmVjdC52YWx1ZSc=",
      "Problem": "not_equal",
      "Type": "oneshot",
      "Valid":""
    },
    "36": {
      "Part" :"Defender",
      "num_req": "1",
      "Title": "Security Contact Phone Numbers In Use\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that a security contact international phone number (including the country code, e.g. +1-425-1234567) is set for the administrator who should be notified when Azure Security Center detects compromised resources.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/defender-for-cloud/policy-reference",
      "Args": "YXogYWNjb3VudCBnZXQtYWNjZXNzLXRva2VuIC0tcXVlcnkgIntzdWJzY3JpcHRpb246c3Vic2NyaXB0aW9uLGFjY2Vzc1Rva2VuOmFjY2Vzc1Rva2VufSIgLS1vdXQgdHN2IHwgeGFyZ3MgLUwxIGJhc2ggLWMgJ2N1cmwgLXMgLVggR0VUIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJDEiIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIGh0dHBzOi8vbWFuYWdlbWVudC5henVyZS5jb20vc3Vic2NyaXB0aW9ucy8kMC9wcm92aWRlcnMvTWljcm9zb2Z0LlNlY3VyaXR5L3NlY3VyaXR5Q29udGFjdHM/YXBpLXZlcnNpb249MjAxNy0wOC0wMS1wcmV2aWV3JyB8IGpxICcufC52YWx1ZVsxXSd8anEgJy5wcm9wZXJ0aWVzLnBob25lJw==",
      "Problem": "not_equal",
      "Type": "oneshot",
      "Valid":""
    },
    "37": {
      "Part" :"Key Vault",
      "num_req": "3",
      "Title": "Enable Certificate Transparency\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that Certificate Transparency feature is enabled for all Azure Key Vault SSL/TLS certificates in order to adhere to web security best practices. Certificate Transparency (CT) is a new Internet standard that addresses the concerns about mis-issued certificates by making the Transport Layer Security (TLS) ecosystem publicly auditable. Without CT, as domain owner there is no way to be aware of certificates that are issued to your domain, unless you request it yourself. With Certificate Transparency, you can easily audit the quality of the certificates that the Certificate Authority (CA) issued and determine whether the certificate is compliant with the standards enforced by the Certification Authority Browser Forum, also known as CA/Browser Forum.\n",
      "Command":"az",
      "Reference":"https://learn.microsoft.com/en-us/azure/key-vault/certificates/about-certificates",
      "Args": "keyvault list --query [*].name",
      "Second_Args": "keyvault certificate list --vault-name",
      "Second_To_Second_Args": "--query [?(attributes.enabled==`true`)].id",
      "Third_Args": "keyvault certificate show --id",
      "Third_To_Third_Args":"--query policy.issuerParameters.certificateTransparency",
      "Problem": "not_equal",
      "Type": "stdout",
      "Valid":"true"
    },
    "38": {
      "Part" :"Key Vault",
      "num_req": "6",
      "Title": "Enable Key Vault Recoverability\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that production Azure Key Vaults are recoverable in order to prevent permanent deletion/purging of encryption keys, secrets and certificates stored within these vaults. To make your Azure Key Vault instances recoverable, you need to enable both 'Soft Delete' and 'Do Not Purge' features: \n'Soft Delete', implemented by enableSoftDelete parameter, ensures that even if the Key Vault is deleted, the vault itself or its objects (keys, secrets, certificates) remain recoverable for next 90 days. In this span of 90 days, either the vault and its objects can be recovered or purged (permanent deletion). If no action is taken, after 90 days, the Azure Key Vault and all its objects will be purged.\n 'Do Not Purge' feature, implemented by enablePurgeProtection parameter, ensures that the Azure Key Vault and its objects cannot be purged at all, preventing users from accidentally purging Azure Key Vault resources. This adds to the 'Soft Delete' feature which only ensures that Key Vault is not deleted permanently and will be recoverable for 90 days from the date of deletion.\n",
      "Command":"az",
      "first":"enableSoftDelete",
      "second":"enablePurgeProtection",
      "Reference":"https://learn.microsoft.com/en-us/azure/key-vault/general/key-vault-recovery?tabs=azure-portal",
      "Args": "keyvault list --query [*].name",
      "Second_Args": "keyvault show --name",
      "Second_To_Second_Args": "--query properties.{\"enableSoftDelete\":enableSoftDelete,\"enablePurgeProtection\":enablePurgeProtection}",
      "Valid1": "null",
      "Valid2": "null",
      "Problem": "equal",
      "Type": "stdout"
    },
    "39": {
      "Part" :"Key Vault",
      "num_req": "3",
      "Title": "Enable SSL Certificate Auto-Renewal\n",
      "Risk_Level":"High",
      "Descrip": "Microsoft Azure Key Vault service can renew your SSL certificates automatically in order to prevent any application or service outage, credential leak, or process violation that can disrupts your business. As long as your information with the public Certificate Authority (CA) is up-to-date, the Auto-Renewal feature does not require any action from you. The Key Vault service retrieves the new certificate before your old one expires and the Azure App service picks up the renewed certificate automatically and performs the SSL re-binding.\n",
      "Command":"az",
      "Reference":"https://learn.microsoft.com/en-us/azure/key-vault/certificates/overview-renew-certificate",
      "Args": "keyvault list --query [*].name",
      "Second_Args": "keyvault certificate list --vault-name",
      "Second_To_Second_Args": "--query [?(attributes.enabled==`true`)].id",
      "Third_Args": "keyvault certificate show --id",
      "Third_To_Third_Args":"--query policy.lifetimeActions[*].action.actionType",
      "Problem": "equal",
      "Type": "stdout",
      "Valid":"EmailContacts"
    },
    "40": {
      "Part" :"Key Vault",
      "num_req": "2",
      "Title": "Enable Trusted Microsoft Services for Key Vault Access\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that 'Allow trusted Microsoft services to bypass this firewall' exception is enabled within your Azure Key Vault network firewall configuration settings in order to grant vault access to trusted Azure cloud services. The trusted Microsoft services must also be given explicit permissions within the access policies associated with the Key Vault.\n",
      "Command":"az",
      "Reference":"https://learn.microsoft.com/en-us/azure/key-vault/general/network-security",
      "Args": "keyvault list --query [*].name",
      "Second_Args": "keyvault show --name",
      "Second_To_Second_Args": "--query properties.networkAcls.bypass",
      "Problem": "equal",
      "Type": "stdout",
      "Valid":"None"
    },
    "41": {
      "Part" :"Key Vault",
      "num_req": "3",
      "Title": "Restrict Default Network Access for Azure Key Vaults\n",
      "Risk_Level":"Medium",
      "Command":"az",
      "Descrip": "Ensure that your Microsoft Azure Key Vaults are configured to deny access to traffic from all networks (including the public Internet). By restricting the public access to your Azure Key Vaults, you add an important layer of security, since the default action is to accept connections from clients on any network. To limit access to trusted networks and/or IP addresses, you must change the Key Vault firewall default action from 'Allow' to 'Deny' and configure the appropriate access.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/key-vault/general/network-security",
      "Args": "keyvault list --query [*].name",
      "Second_Args": "keyvault show --name",
      "Second_To_Second_Args": "--query properties.networkAcls.defaultAction",
      "Problem": "not_equal",
      "Type": "stdout",
      "Valid":"Deny"
    },
    "42": {
      "Part" :"Key Vault",
      "num_req": "3",
      "Title": "Set Secret Key Expiration\n",
      "Risk_Level":"Medium",
      "Command":"az",
      "Descrip": "Ensure that all the secret keys available within your Microsoft Azure Key Vault have an expiration date/time set in order to follow security best practices and promote secret key rotation. The expiration parameter configured for an Azure secret identifies the expiration time after which the secret key must not be used anymore for storing sensitive data such as passwords and database connection strings.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/key-vault/secrets/about-secrets",
      "Args": "keyvault list --query [*].name",
      "Second_Args": "keyvault secret list --vault-name",
      "Second_To_Second_Args": "--query [*].id",
      "Third_Args":"keyvault secret show --id",
      "Third_To_Third_Args":"--query attributes.expires",
      "Problem": "equal",
      "Type": "stdout",
      "Valid":""
    },
    "43": {
      "Part" :"Key Vault",
      "num_req": "3",
      "Title": "Set Encryption Key Expiration\n",
      "Risk_Level":"Medium",
      "Command":"az",
      "Descrip": "Ensure that all the encryption keys available within your Microsoft Azure Key Vault have an expiration time set in order to follow security best practices and promote encryption key rotation. The expiration attribute configured for an encryption key identifies the expiration date and time after which the key must not be used anymore for a cryptographic operations.\n",
      "Reference":"https://github.com/aquasecurity/cloud-security-remediation-guides/blob/master/en/azure/keyvault/key-expiration-enabled.md",
      "Args": "keyvault list --query [*].name",
      "Second_Args": "keyvault key list --vault-name",
      "Second_To_Second_Args": "--query [*].kid",
      "Third_Args":"keyvault key show --id",
      "Third_To_Third_Args":"--query attributes.expires",
      "Problem": "equal",
      "Type": "stdout",
      "Valid":""
    },
    "44": {
      "Part" :"Key Vault",
      "num_req": "3",
      "Title": "Set Exportable Encryption Key\n",
      "Risk_Level":"Medium",
      "Command":"az",
      "Descrip": "Ensure that all the encryption keys available within your Microsoft Azure Key Vault have an exportable key set in order to follow security best practices.\n",
      "Reference":"",
      "Args": "keyvault list --query [*].name",
      "Second_Args": "keyvault key list --vault-name",
      "Second_To_Second_Args": "--query [*].kid",
      "Third_Args":"keyvault key show --id",
      "Third_To_Third_Args":"--query attributes.exportable",
      "Problem": "not_equal",
      "Type": "stdout",
      "Valid":"true"
    },
    "45": {
      "Part" :"Key Vault",
      "num_req": "3",
      "Title": "Check for Certificate Minimum Key Size\n",
      "Risk_Level":"Medium",
      "Command":"az",
      "Descrip": "Ensure that your Microsoft Azure Key Vault RSA certificates are generated with the minimum key size allowed within your organization, for security and compliance purposes.\n",
      "Reference":"https://www.ibm.com/docs/en/zos/2.4.0?topic=certificates-size-considerations-public-private-keys",
      "Args": "keyvault list --query [*].name",
      "Second_Args": "keyvault certificate list --vault-name",
      "Second_To_Second_Args": "--query [*].id",
      "Third_Args":"keyvault certificate show --id",
      "Third_To_Third_Args":"--query policy.keyProperties.keySize",
      "Problem": "equal",
      "Type": "stdout",
      "Valid":"2048"
    },
    "46": {
      "Part" :"Key Vault",
      "num_req": "2",
      "Title": "Enable Azure Resource Locks\n",
      "Risk_Level":"High",
      "Command":"az",
      "Descrip": "Ensure that all your mission critical Azure cloud resources have resource locks enabled so that certain users are not be able to delete or modify these resources in order to help prevent accidental and malicious changes or deletion.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/lock-resources?tabs=json",
      "Args": "keyvault list --query [*].id",
      "Second_Args": "lock list --resource",
      "Second_To_Second_Args": "--query --query [?level=='ReadOnly'||level=='CanNotDelete'].id",
      "Problem": "not_equal",
      "Type": "print_iter",
      "Valid":""
    }                
  }