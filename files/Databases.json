{
    "1": {
          "Part" :"CosmosDB",
          "num_req": "2",
          "Title": "Enable Automatic Failover\n",
          "Risk_Level":"Medium",
          "Descrip": "Ensure that your Microsoft Azure Cosmos DB accounts are using the Automatic Failover feature in order to enable resource replication and fault tolerance at the account level. Automatic failover allows Azure Cosmos DB to failover to the Azure cloud region with the highest failover priority when the source region become unavailable, without any additional action from the application or the user. The Cosmos DB account must have two or more regions configured in order to enable the feature.\n",
          "Reference":"https://learn.microsoft.com/en-us/azure/cosmos-db/high-availability",
          "Command":"az",
          "Args":"cosmosdb list --query [*].id",
          "Second_Args": "cosmosdb show --ids",
          "Second_To_Second_Args":"--query enableAutomaticFailover",
          "Problem": "not_equal",
          "Type": "stdout",
          "Valid": "true"
        },
    "2": {
          "Part" :"CosmosDB",
          "num_req": "2",
          "Title": "Restrict Default Network Access for Azure Cosmos DB Accounts\n",
          "Risk_Level":"Medium",
          "Descrip": "Ensure that your Microsoft Azure Cosmos DB accounts are configured to deny access to traffic from all networks, including the public Internet. By restricting the public access to your Azure Cosmos accounts, you add an additional layer of security to the account resources, as the default action is to accept requests from any source. To limit access to trusted networks and/or IP addresses only, you must update the firewall and the virtual network configuration for your Cosmos DB accounts.\n",
          "Reference":"https://learn.microsoft.com/en-us/azure/cosmos-db/how-to-configure-vnet-service-endpoint",
          "Command":"az",
          "Args":"cosmosdb list --query [*].id",
          "Second_Args": "cosmosdb show --ids",
          "Second_To_Second_Args":"--query isVirtualNetworkFilterEnabled",
          "Problem": "not_equal",
          "Type": "stdout",
          "Valid": "true"
        },
    "3": {
          "Part" :"CosmosDB",
          "num_req": "2",
          "Title": "Enable Analytical Storage\n",
          "Risk_Level":"Low",
          "Descrip": "Azure Cosmos DB analytical store is a fully isolated column store for enabling large-scale analytics against operational data in your Azure Cosmos DB, without any impact to your transactional workloads. Azure Cosmos DB transactional store is schema-agnostic, and it allows you to iterate on your transactional applications without having to deal with schema or index management. In contrast to this, Azure Cosmos DB analytical store is schematized to optimize for analytical query performance. \n",
          "Reference":"https://learn.microsoft.com/en-us/azure/cosmos-db/configure-synapse-link",
          "Command":"az",
          "Args":"cosmosdb list --query [*].id",
          "Second_Args": "cosmosdb show --ids",
          "Second_To_Second_Args":"--query enableAnalyticalStorage",
          "Problem": "not_equal",
          "Type": "stdout",
          "Valid": "true"
        },
    "4": {
          "Part" :"CosmosDB",
          "num_req": "2",
          "Title": "Disable Local Authentication\n",
          "Risk_Level":"Low",
          "Descrip": "Azure Cosmos DB disable local authentication methods so that your Cosmos DB database accounts exclusively require Azure Active Directory identities for authentication.\n",
          "Reference":"https://learn.microsoft.com/en-us/azure/cosmos-db/policy-reference",
          "Command":"az",
          "Args":"cosmosdb list --query [*].id",
          "Second_Args": "cosmosdb show --ids",
          "Second_To_Second_Args":"--query disableLocalAuth",
          "Problem": "not_equal",
          "Type": "stdout",
          "Valid": "true"
        },
        "5": {
          "Part" :"SQL Server",
          "num_req": "2",
          "Title": "Check SQL Servers TLS Protocol Version\n",
          "Risk_Level":"Medium",
          "Descrip": "Ensure that all Microsoft SQL Servers are using the latest version of TLS encryption protocol to secure the applications traffic over the Internet and comply with the industry standards.\n",
          "Reference":"https://support.microsoft.com/en-us/topic/kb3135244-tls-1-2-support-for-microsoft-sql-server-e4472ef8-90a9-13c1-e4d8-44aad198cdbe",
          "Command":"az",
          "Args": "sql server list --query [*].id",
          "Second_Args": "sql server show --ids",
          "Second_To_Second_Args": "--query minimalTlsVersion",
          "Problem": "not_equal",
          "Type": "stdout",
          "Valid":"1.2"
         },
         "6": {
            "Part" :"SQL Server",
            "num_req": "2",
            "Title": "Check SQL Servers Public Network Access\n",
            "Risk_Level":"High",
            "Descrip": "Ensure that all Microsoft SQL Servers does not have 'Public Network Access'.\n",
            "Reference":"https://learn.microsoft.com/en-us/azure/mysql/single-server/how-to-deny-public-network-access",
            "Command":"az",
            "Args": "sql server list --query [*].id",
            "Second_Args": "sql server show --ids",
            "Second_To_Second_Args": "--query publicNetworkAccess",
            "Problem": "not_equal",
            "Type": "stdout",
            "Valid":"Enabled"
          },
          "7": {
            "Part" :"SQL Server",
            "num_req": "2",
            "Title": "Check SQL Servers Outbound Network Access\n",
            "Risk_Level":"High",
            "Descrip": "Ensure that SQL Servers are not communicating to the outside.\n",
            "Reference":"https://techcommunity.microsoft.com/t5/azure-database-support-blog/how-to-enable-outbound-firewall-rules-for-azure-sql-databases/ba-p/3073540",
            "Command":"az",
            "Args": "sql server list --query [*].id",
            "Second_Args": "sql server show --ids",
            "Second_To_Second_Args": "--query restrictOutboundNetworkAccess",
            "Problem": "not_equal",
            "Type": "stdout",
            "Valid":"Enabled"
          },
          "8": {
            "Part" :"SQL Server",
            "num_req": "2",
            "Title": "Check SQL Servers Encryption Protectors Auto Rotation Enabled\n",
            "Risk_Level":"Medium",
            "Descrip": "Ensure that SQL Servers Encryption Protectors are using auto rotation for keys.\n",
            "Reference":"https://learn.microsoft.com/en-us/azure/azure-sql/database/transparent-data-encryption-byok-key-rotation?view=azuresql&tabs=azure-portal",
            "Command":"az",
            "Args": "sql server list --query [*].id",
            "Second_Args": "sql server tde-key show --ids",
            "Second_To_Second_Args": "--query autoRotationEnabled",
            "Problem": "not_equal",
            "Type": "stdout",
            "Valid":"Enabled"
          },
          "9": {
            "Part" :"SQL Server",
            "num_req": "3",
            "Title": "Check SQL Servers Backup Storage Zone\n",
            "Risk_Level":"Medium",
            "Descrip": "Ensure that SQL Servers Backup Storages are using 'Zone' for backup.\n",
            "Reference":"https://learn.microsoft.com/en-us/azure/azure-sql/database/automated-backups-overview?view=azuresql",
            "Command":"az",
            "Args": "sql server list --query [*].id",
            "Second_Args": "sql db list --ids",
            "Second_To_Second_Args": "--query [*].id",
            "Third_Args":"sql db show --ids",
            "Third_To_Third_Args":"--query currentBackupStorageRedundancy",
            "Problem": "not_equal",
            "Type": "stdout",
            "Valid":"Zone"
          },
          "10": {
            "Part" :"SQL Server",
            "num_req": "3",
            "Title": "Check SQL Servers Infrastructure Encryption\n",
            "Risk_Level":"Medium",
            "Descrip": "Ensure that SQL Servers are using 'Infrastructure Encryption'.\n",
            "Reference":"https://learn.microsoft.com/en-us/azure/azure-sql/database/transparent-data-encryption-tde-overview?view=azuresql&tabs=azure-portal",
            "Command":"az",
            "Args": "sql server list --query [*].id",
            "Second_Args": "sql db list --ids",
            "Second_To_Second_Args": "--query [*].id",
            "Third_Args":"sql db show --ids",
            "Third_To_Third_Args":"--query isInfraEncryptionEnabled",
            "Problem": "not_equal",
            "Type": "stdout",
            "Valid":"true"
          },
          "11": {
            "Part" :"SQL Server",
            "num_req": "3",
            "Title": "Check SQL Servers Zone Redundant Enabled\n",
            "Risk_Level":"Low",
            "Descrip": "Ensure that SQL Servers are using 'Zone Redundant'. The zone redundancy to associate with the Azure Sql Database\n",
            "Reference":"https://techcommunity.microsoft.com/t5/azure-sql-blog/zone-redundancy-for-azure-sql-database-general-purpose-tier/ba-p/3280376",
            "Command":"az",
            "Args": "sql server list --query [*].id",
            "Second_Args": "sql db list --ids",
            "Second_To_Second_Args": "--query [*].id",
            "Third_Args":"sql db show --ids",
            "Third_To_Third_Args":"--query zoneRedundant",
            "Problem": "not_equal",
            "Type": "stdout",
            "Valid":"true"
          },
          "12": {
            "Part" :"SQL Server",
            "num_req": "3",
            "Title": "Check SQL Servers Ledger Enabled\n",
            "Risk_Level":"Medium",
            "Descrip": "Ensure that SQL Servers are using 'Ledger'. The Ledger authenticates the integrity of your data encrypted and detects any changes that may have occurred\n",
            "Reference":"https://learn.microsoft.com/en-us/sql/relational-databases/security/ledger/ledger-overview?view=sql-server-ver16",
            "Command":"az",
            "Args": "sql server list --query [*].id",
            "Second_Args": "sql db list --ids",
            "Second_To_Second_Args": "--query [*].id",
            "Third_Args":"sql db show --ids",
            "Third_To_Third_Args":"--query ledgerOn",
            "Problem": "not_equal",
            "Type": "stdout",
            "Valid":"true"
          },
          "13": {
            "Part" :"SQL Server",
            "num_req": "3",
            "Title": "Check SQL Servers Read Scale Enabled\n",
            "Risk_Level":"Low",
            "Descrip": "Ensure that SQL Servers are using 'readScale'. The read scale-out feature allows you to offload read-only workloads using the compute capacity of one of the read-only replicas, instead of running them on the read-write replica. This way, some read-only workloads can be isolated from the read-write workloads, and will not affect their performance.\n",
            "Reference":"https://learn.microsoft.com/en-us/azure/azure-sql/database/read-scale-out?view=azuresql",
            "Command":"az",
            "Args": "sql server list --query [*].id",
            "Second_Args": "sql db list --ids",
            "Second_To_Second_Args": "--query [*].id",
            "Third_Args":"sql db show --ids",
            "Third_To_Third_Args":"--query readScale",
            "Problem": "not_equal",
            "Type": "stdout",
            "Valid":"Enabled"
          },
          "14": {
            "Part" :"SQL Server",
            "num_req": "3",
            "Title": "Check SQL Servers Standard Edition is Enabled\n",
            "Risk_Level":"Medium",
            "Descrip": "Ensure that SQL Servers are using 'Standard Edition'. \n",
            "Reference":"https://learn.microsoft.com/en-us/sql/sql-server/editions-and-components-of-sql-server-2019?view=sql-server-ver16",
            "Command":"az",
            "Args": "sql server list --query [*].id",
            "Second_Args": "sql db list --ids",
            "Second_To_Second_Args": "--query [*].id",
            "Third_Args":"sql db show --ids",
            "Third_To_Third_Args":"--query edition",
            "Problem": "not_equal",
            "Type": "stdout",
            "Valid":"Standard"
          },
          "15": {
            "Part" :"SQL Server",
            "num_req": "2",
            "Title": "Enable Auto-Failover Groups\n",
            "Risk_Level":"Medium",
            "Descrip": "Ensure that Microsoft Azure SQL database servers are using auto-failover groups in order to enable database replication and automatic failover. A Microsoft Azure SQL failover group is designed to automatically manage replication, connectivity, high availability and failover for a set of SQL databases.\n",
            "Reference":"https://learn.microsoft.com/en-us/azure/azure-sql/database/auto-failover-group-configure-sql-db?view=azuresql&tabs=azure-portal&pivots=azure-sql-single-db",
            "Command":"az",
            "Args": "sql server list --query [*].id",
            "Second_Args": "sql failover-group list --ids",
            "Second_To_Second_Args": "",
            "Problem": "equal",
            "Type": "stdout",
            "Valid":""
          },
          "16": {
            "Part" :"SQL Server",
            "num_req": "2",
            "Title": "Use BYOK for Transparent Data Encryption\n",
            "Risk_Level":"Medium",
            "Descrip": "Ensure that your Microsoft Azure SQL server's Transparent Data Encryption protector (i.e. TDE master key) is encrypted with BYOK (Bring Your Own Key) in order to protect your SQL databases with a key from your own Azure key vault.\n",
            "Reference":"https://learn.microsoft.com/en-us/azure/azure-sql/database/transparent-data-encryption-byok-overview?view=azuresql",
            "Command":"az",
            "Args": "sql server list --query [*].id",
            "Second_Args": "sql server tde-key show --ids",
            "Second_To_Second_Args": "--query serverKeyType",
            "Problem": "equal",
            "Type": "stdout",
            "Valid":"ServiceManaged"
          },
          "17": {
            "Part" :"SQL Server",
            "num_req": "3",
            "Title": "Enable Advanced Threat Protection for SQL Databases\n",
            "Risk_Level":"High",
            "Descrip": "Ensure that Advanced Threat Protection is enabled for all SQL databases available within your Microsoft Azure cloud account for protecting your data.\n",
            "Reference":"https://learn.microsoft.com/en-us/azure/azure-sql/managed-instance/threat-detection-configure?view=azuresql",
            "Command":"az",
            "Args": "sql server list --query [*].id",
            "Second_Args": "sql db list --ids",
            "Second_To_Second_Args": "--query [*].id",
            "Third_Args":"sql server advanced-threat-protection-setting show --ids",
            "Third_To_Third_Args":"--query state",
            "Problem": "not_equal",
            "Type": "stdout",
            "Valid":"Enabled"
          },
          "18": {
            "Part" :"SQL Server",
            "num_req": "3",
            "Title": "Enable Auditing for SQL Servers\n",
            "Risk_Level":"Medium",
            "Descrip": "Ensure that the 'Auditing' feature is enabled within your Microsoft Azure SQL server configuration settings in order to monitor your SQL databases for security, compliance and troubleshooting purposes. Microsoft Azure allows an SQL server to be created as a service. Enabling auditing at the server level ensures that all existing and newly created databases on that SQL server are audited.\n",
            "Reference":"https://learn.microsoft.com/en-us/azure/azure-sql/database/auditing-overview?view=azuresql",
            "Command":"az",
            "Args": "sql server list --query [*].id",
            "Second_Args": "sql server audit-policy show --ids",
            "Second_To_Second_Args": "--query state",
            "Problem": "not_equal",
            "Type": "stdout",
            "Valid":"Enabled"
          },
          "19": {
            "Part" :"SQL Server",
            "num_req": "2",
            "Title": "Check SQL Servers Audits for BLOB Storage Option Enabled\n",
            "Risk_Level":"Low",
            "Descrip": "Ensure that SQL Servers are using BLOB Storage option.\n",
            "Reference":"https://learn.microsoft.com/en-us/samples/azure/azure-quickstart-templates/sql-auditing-server-policy-to-blob-storage/",
            "Command":"az",
            "Args": "sql server list --query [*].id",
            "Second_Args": "sql server audit-policy show --ids",
            "Second_To_Second_Args": "--query blobStorageTargetState",
            "Problem": "not_equal",
            "Type": "stdout",
            "Valid":"Enabled"
          },
          "20": {
            "Part" :"SQL Server",
            "num_req": "2",
            "Title": "Check SQL Servers Audits for Event Hub Option Enabled\n",
            "Risk_Level":"Low",
            "Descrip": "Ensure that SQL Servers are triggering Event Hub Actions.\n",
            "Reference":"https://learn.microsoft.com/en-us/samples/azure/azure-quickstart-templates/sql-auditing-server-policy-to-eventhub/",
            "Command":"az",
            "Args": "sql server list --query [*].id",
            "Second_Args": "sql server audit-policy show --ids",
            "Second_To_Second_Args": "--query eventHubTargetState",
            "Problem": "not_equal",
            "Type": "stdout",
            "Valid":"Enabled"
          },
          "21": {
            "Part" :"SQL Server",
            "num_req": "2",
            "Title": "Check SQL Servers Audits for Azure Monitor Target Enabled\n",
            "Risk_Level":"Low",
            "Descrip": "Ensure that SQL Servers are using Azure Monitor for monitoring activities.\n",
            "Reference":"https://learn.microsoft.com/en-us/azure/azure-sql/database/monitor-tune-overview?view=azuresql",
            "Command":"az",
            "Args": "sql server list --query [*].id",
            "Second_Args": "sql server audit-policy show --ids",
            "Second_To_Second_Args": "--query isAzureMonitorTargetEnabled",
            "Problem": "not_equal",
            "Type": "stdout",
            "Valid":"true"
          },
          "22": {
            "Part" :"SQL Server",
            "num_req": "2",
            "Title": "Check SQL Servers Audits for Log Analytics Target Set\n",
            "Risk_Level":"Low",
            "Descrip": "Ensure that SQL Servers are using Log Analytics.\n",
            "Reference":"https://learn.microsoft.com/en-us/azure/azure-sql/database/auditing-overview?view=azuresql",
            "Command":"az",
            "Args": "sql server list --query [*].id",
            "Second_Args": "sql server audit-policy show --ids",
            "Second_To_Second_Args": "--query logAnalyticsTargetState",
            "Problem": "not_equal",
            "Type": "stdout",
            "Valid":"Enabled"
          },
          "23": {
            "Part" :"SQL Server",
            "num_req": "2",
            "Title": "SQL Unlimited Auditing Retention\n",
            "Risk_Level":"Medium",
            "Descrip": "Ensure that the database auditing policy attached to your Microsoft Azure SQL servers has a sufficient log data retention period, i.e. 90 days or more, configured for reliability and compliance purposes. The retention period represents the number of days to retain audit log data for the databases hosted on Azure SQL servers.\n",
            "Reference":"https://learn.microsoft.com/en-us/azure/azure-sql/database/auditing-overview?view=azuresql",
            "Command":"az",
            "Args": "sql server list --query [*].id",
            "Second_Args": "sql server audit-policy show --ids",
            "Second_To_Second_Args": "--query retentionDays",
            "Problem": "equal",
            "Type": "stdout",
            "Valid":"0"
          },
          "24": {
            "Part" :"SQL Server",
            "num_req": "2",
            "Title": "Configure 'AuditActionGroup' for SQL Server Auditing\n",
            "Risk_Level":"Medium",
            "Descrip": "Ensure that the 'AuditActionGroup' property is properly configured within the auditing policy implemented at the Microsoft Azure SQL server level, in order to capture all critical activity triggered on your SQL database servers and on all the SQL databases hosted on those servers. Prior to running this rule by the Cloud Conformity engine, SQL database auditing needs to be enabled for all Microsoft Azure SQL servers.\n",
            "Reference":"https://learn.microsoft.com/en-us/sql/relational-databases/security/auditing/sql-server-audit-action-groups-and-actions?view=sql-server-ver16",
            "Command":"az",
            "Args": "sql server list --query [*].id",
            "Second_Args": "sql server audit-policy show --ids",
            "Second_To_Second_Args": "--query auditActionsAndGroups",
            "Problem": "equal",
            "Type": "stdout",
            "Valid":""
          },
          "25": {
            "Part" :"PostgreSQL",
            "num_req": "5",
            "Title": "Check for PostgreSQL Log Retention Period\n",
            "Risk_Level":"Medium",
            "Descrip": "Ensure that all your Microsoft Azure PostgreSQL servers have a sufficient log retention period, i.e. greater than 3 days, configured for reliability and compliance purposes. The retention period, represented by the log_retention_days parameter, is the number of days to retain log data for the databases hosted on Azure PostgreSQL servers. The compliant value for the retention period is 4 to 7 days (inclusive).\n",
            "Reference":"https://learn.microsoft.com/en-us/azure/postgresql/single-server/concepts-server-logs",
            "Command":"az",
            "Args": "postgres server list --output json",
            "Len": "--query [].id",
            "Second_Args": "postgres server configuration show --server-name",
            "Second_To_Second_Args": "--name log_retention_days --query value --resource-group",
            "Problem": "equal-less",
            "Type": "stdout",
            "Valid":"3"
          },
          "26": {
            "Part" :"PostgreSQL",
            "num_req": "5",
            "Title": "Enable 'CONNECTION_THROTTLING' Parameter for PostgreSQL Servers\n",
            "Risk_Level":"Medium",
            "Descrip": "Ensure that 'connection_throttling' server parameter is enabled for all PostgreSQL database servers provisioned within your Microsoft Azure cloud account. The 'connection_throttling' parameter enables temporary connection throttling per IP address for too many invalid login failures.\n",
            "Reference":"https://learn.microsoft.com/en-us/azure/postgresql/flexible-server/concepts-server-parameters",
            "Command":"az",
            "Args": "postgres server list --output json",
            "Len": "--query [].id",
            "Second_Args": "postgres server configuration show --server-name",
            "Second_To_Second_Args": "--name connection_throttling --query value --resource-group",
            "Problem": "equal",
            "Type": "stdout",
            "Valid":"off"
          },
          "27": {
            "Part" :"PostgreSQL",
            "num_req": "5",
            "Title": "Enable 'LOG_CHECKPOINTS' Parameter for PostgreSQL Servers\n",
            "Risk_Level":"Medium",
            "Descrip": "Ensure that 'log_checkpoints' server parameter is enabled for all PostgreSQL database servers available within your Microsoft Azure cloud account. The 'log_checkpoints' parameter allows checkpoints and restart points to be logged in the Azure PostgreSQL server log.\n",
            "Reference":"https://learn.microsoft.com/en-us/azure/postgresql/flexible-server/concepts-server-parameters",
            "Command":"az",
            "Args": "postgres server list --output json",
            "Len": "--query [].id",
            "Second_Args": "postgres server configuration show --server-name",
            "Second_To_Second_Args": "--name log_checkpoints --query value --resource-group",
            "Problem": "equal",
            "Type": "stdout",
            "Valid":"off"
          },
          "28": {
            "Part" :"PostgreSQL",
            "num_req": "5",
            "Title": "Enable 'LOG_CONNECTIONS' Parameter for PostgreSQL Servers\n",
            "Risk_Level":"Medium",
            "Descrip": "Ensure that 'log_connections' server parameter is enabled for all PostgreSQL database servers available in your Microsoft Azure cloud account. The 'log_connections' parameter allows each attempted connection to the database server to be logged, including successful client authentication requests. Only Azure users with administrative privileges can change this parameter at session start, and it cannot be changed during an access session.\n",
            "Reference":"https://learn.microsoft.com/en-us/azure/postgresql/flexible-server/concepts-server-parameters",
            "Command":"az",
            "Args": "postgres server list --output json",
            "Len": "--query [].id",
            "Second_Args": "postgres server configuration show --server-name",
            "Second_To_Second_Args": "--name log_connections --query value --resource-group",
            "Problem": "equal",
            "Type": "stdout",
            "Valid":"off"
          },
          "29": {
            "Part" :"PostgreSQL",
            "num_req": "5",
            "Title": "Enable 'LOG_DISCONNECTIONS' Parameter for PostgreSQL Servers\n",
            "Risk_Level":"Medium",
            "Descrip": "Ensure that the 'log_disconnections' server parameter is enabled for all PostgreSQL database servers provisioned in your Microsoft Azure cloud account. The 'log_disconnections' parameter enables the logging of session termination. The log output provides information similar to the one generated by the 'log_connections' parameter, plus the duration of the session. Only Azure account admins can change this parameter at the session start, and it cannot be changed at all during a session.\n",
            "Reference":"https://learn.microsoft.com/en-us/azure/postgresql/flexible-server/concepts-server-parameters",
            "Command":"az",
            "Args": "postgres server list --output json",
            "Len": "--query [].id",
            "Second_Args": "postgres server configuration show --server-name",
            "Second_To_Second_Args": "--name log_disconnections --query value --resource-group",
            "Problem": "equal",
            "Type": "stdout",
            "Valid":"off"
          },
          "30": {
            "Part" :"PostgreSQL",
            "num_req": "5",
            "Title": "Enable 'LOG_DURATION' Parameter for PostgreSQL Servers\n",
            "Risk_Level":"Medium",
            "Descrip": "Ensure that 'log_duration' server parameter is enabled for all PostgreSQL database servers created in your Microsoft Azure cloud account. Once enabled, the 'log_duration' parameter allows recording the duration of each completed PostgreSQL statement. Only users with administrative privileges can change this setting within Azure PostgreSQL server configuration. For database clients using extended query protocol, the duration of the 'Parse', 'Bind', and 'Execute' steps is logged independently.\n",
            "Reference":"https://learn.microsoft.com/en-us/azure/postgresql/flexible-server/concepts-server-parameters",
            "Command":"az",
            "Args": "postgres server list --output json",
            "Len": "--query [].id",
            "Second_Args": "postgres server configuration show --server-name",
            "Second_To_Second_Args": "--name log_duration --query value --resource-group",
            "Problem": "equal",
            "Type": "stdout",
            "Valid":"off"
          }, 
          "31": {
            "Part" :"PostgreSQL",
            "num_req": "5",
            "Title": "Enable 'log_checkpoints' Parameter for PostgreSQL Flexible Servers\n",
            "Risk_Level":"Medium",
            "Descrip": "Ensure that 'log_checkpoints' server parameter is enabled for all PostgreSQL flexible database servers available within your Microsoft Azure cloud account. The 'log_checkpoints' parameter allows checkpoints and restart points to be logged in the Azure PostgreSQL server log.\n",
            "Reference":"https://learn.microsoft.com/en-us/azure/postgresql/flexible-server/concepts-server-parameters",
            "Command":"az",
            "Args": "postgres flexible-server list --output json",
            "Len": "--query [].id",
            "Second_Args": "postgres flexible-server parameter show --server-name",
            "Second_To_Second_Args": "--name log_checkpoints --query value --resource-group",
            "Problem": "equal",
            "Type": "stdout",
            "Valid":"off"
          },
          "32": {
            "Part" :"PostgreSQL",
            "num_req": "5",
            "Title": "Enable Geo-Redundant Backups\n",
            "Risk_Level":"High",
            "Descrip": "Ensure that your Microsoft Azure PostgreSQL database servers have geo-redundant backups enabled, to allow you to restore your PostgreSQL servers to a different Azure region in the event of a regional outage or a disaster.\n",
            "Reference":"https://learn.microsoft.com/en-us/azure/azure-sql/database/automated-backups-overview?view=azuresql",
            "Command":"az",
            "Args": "postgres server list --output json",
            "Len": "--query [].id",
            "Second_Args": "postgres server show --name",
            "Second_To_Second_Args": "--query storageProfile.geoRedundantBackup --resource-group",
            "Problem": "equal",
            "Type": "stdout",
            "Valid":"Disabled"
          },
          "33": {
            "Part" :"PostgreSQL",
            "num_req": "5",
            "Title": "Enable In-Transit Encryption for PostgreSQL Database Servers\n",
            "Risk_Level":"High",
            "Descrip": "Ensure that Microsoft Azure PostgreSQL server data is encrypted in transit in order to meet security and compliance requirements. In-transit encryption helps prevent unauthorized users from getting access to critical data available in your Azure PostgreSQL databases.\n",
            "Reference":"https://learn.microsoft.com/en-us/azure/postgresql/single-server/concepts-security",
            "Command":"az",
            "Args": "postgres server list --output json",
            "Len": "--query [].id",
            "Second_Args": "postgres server show --name",
            "Second_To_Second_Args": "--query sslEnforcement --resource-group",
            "Problem": "equal",
            "Type": "stdout",
            "Valid":"Disabled"
          },
          "34": {
            "Part" :"PostgreSQL",
            "num_req": "5",
            "Title": "Enable Infrastructure Double Encryption for Single Servers\n",
            "Risk_Level":"Medium",
            "Descrip": "Ensure that infrastructure double encryption is enabled for your Single Server Azure PostgreSQL database servers in order to add a second layer of encryption for your PostgreSQL databases using a different encryption algorithm which provides enhanced data protection.\n",
            "Reference":"https://learn.microsoft.com/en-us/azure/postgresql/single-server/concepts-infrastructure-double-encryption",
            "Command":"az",
            "Args": "postgres server list --output json",
            "Len": "--query [].id",
            "Second_Args": "postgres server show --name",
            "Second_To_Second_Args": "--query infrastructureEncryption --resource-group",
            "Problem": "equal",
            "Type": "stdout",
            "Valid":"Disabled"
          },
          "35": {
            "Part" :"PostgreSQL",
            "num_req": "5",
            "Title": "Enable Storage Auto-Growth\n",
            "Risk_Level":"High",
            "Descrip": "Ensure that Storage Auto-Growth feature is enabled for your production Azure PostgreSQL database servers. Storage auto-growth prevents your PostgreSQL servers from running out of storage and becoming read-only.\n",
            "Reference":"https://learn.microsoft.com/en-us/azure/postgresql/single-server/how-to-auto-grow-storage-portal",
            "Command":"az",
            "Args": "postgres server list --output json",
            "Len": "--query [].id",
            "Second_Args": "postgres server show --name",
            "Second_To_Second_Args": "--query storageProfile.storageAutogrow --resource-group",
            "Problem": "equal",
            "Type": "stdout",
            "Valid":"Disabled"
          },
          "36": {
            "Part" :"Redis Cache",
            "num_req": "2",
            "Title": "Check for TLS Protocol Latest Version\n",
            "Risk_Level":"Medium",
            "Descrip": "Ensure that all your Microsoft Azure Redis Cache servers are using the latest available version of TLS encryption protocol in order to enhance the security of the SSL/TLS connection between the cache servers and their web applications, and comply with the industry standards.\n",
            "Reference":"https://learn.microsoft.com/en-us/azure/azure-cache-for-redis/cache-remove-tls-10-11",
            "Command":"az",
            "Args":"redis list --query [*].id",
            "Second_Args": "redis show --ids",
            "Second_To_Second_Args":"--query minimumTlsVersion",
            "Problem": "not_equal",
            "Type": "stdout",
            "Valid": "1.2"
          },
          "37": {
              "Part" :"Redis Cache",
              "num_req": "2",
              "Title": "Check for AOF Backup\n",
              "Risk_Level":"Medium",
              "Descrip": "Ensure that all your Microsoft Azure Redis Cache servers are using the backup feature. It is important for emergency issues.\n",
              "Reference":"https://learn.microsoft.com/en-us/azure/azure-cache-for-redis/cache-how-to-premium-persistence",
              "Command":"az",
              "Args":"redis list --query [*].id",
              "Second_Args": "redis show --ids",
              "Second_To_Second_Args":"--query redisConfiguration.aofBackupEnabled",
              "Problem": "not_equal",
              "Type": "stdout",
              "Valid": "true"
            },
          "38": {
                "Part" :"Redis Cache",
                "num_req": "2",
                "Title": "Check for RDB Backup\n",
                "Risk_Level":"Medium",
                "Descrip": "Ensure that all your Microsoft Azure Redis Cache servers are using the backup feature. It is important for emergency issues.\n",
                "Reference":"https://learn.microsoft.com/en-us/azure/azure-cache-for-redis/cache-how-to-premium-persistence",
                "Command":"az",
                "Args":"redis list --query [*].id",
                "Second_Args": "redis show --ids",
                "Second_To_Second_Args":"--query redisConfiguration.rdbBackupEnabled",
                "Problem": "not_equal",
                "Type": "stdout",
                "Valid": "true"
              },
              "39": {
                "Part" :"MySQL",
                "num_req": "2",
                "Title": "Check for Azure Cloud Budget Alerts\n",
                "Risk_Level":"Medium",
                "Descrip": "Because keeping the cost of your Microsoft Azure cloud infrastructure under control can be vital for your organization, you have to ensure that budget exceeding alerts are created to prevent unexpected expenditure within your Azure account.\n",
                "Reference":"https://learn.microsoft.com/en-us/azure/cost-management-billing/costs/cost-mgt-alerts-monitor-usage-spending",
                "Command":"az",
                "Args":"mysql flexible-server list --query [*].id",
                "Second_Args": "mysql flexible-server show --ids",
                "Second_To_Second_Args":"--query dataEncryption",
                "Problem": "not_equal",
                "Type": "stdout",
                "Valid": "true"
              },
           "40": {
              "Part" :"MySQL",
              "num_req": "5",
              "Title": "Configure TLS Version for MySQL Flexible Database Servers\n",
              "Risk_Level":"Medium",
              "Descrip": "Ensure that your Azure MySQL flexible database servers are using the latest version of TLS encryption protocol (i.e. TLS version 1.2 or TLS version 1.3) in order to secure the connection between your MySQL database servers and their clients/applications.\n",
              "Reference":"https://learn.microsoft.com/en-us/azure/mysql/single-server/how-to-tls-configurations",
              "Command":"az",
              "Len":"--query [].id",
              "Args":"mysql flexible-server list --output json",
              "Second_Args": "mysql flexible-server parameter show --server-name",
              "Second_To_Second_Args":"--name tls_version --query value --resource-group",
              "Problem": "not_equal",
              "Type": "stdout",
              "Valid": "TLSv1.2"
              },
           "41": {
              "Part" :"MySQL",
              "num_req": "2",
              "Title": "Enable In-Transit Encryption for MySQL Servers\n",
              "Risk_Level":"High",
              "Descrip": "Ensure that Microsoft Azure MySQL server data is encrypted in transit in order to meet security and compliance requirements. In-transit data encryption helps prevent unauthorized users from reading sensitive data available on your MySQL databases.\n",
              "Reference":"https://learn.microsoft.com/en-us/azure/mysql/single-server/concepts-security",
              "Command":"az",
              "Args":"mysql server list --query [*].id",
              "Second_Args": "mysql server show --ids",
              "Second_To_Second_Args":"--query sslEnforcement",
              "Problem": "not_equal",
              "Type": "stdout",
              "Valid": "Enabled"
              }
}