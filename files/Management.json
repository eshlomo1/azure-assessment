{
    "1": {
          "Part" :"Subscriptions",
          "num_req": "2",
          "Title": "Check for Azure Cloud Budget Alerts\n",
          "Risk_Level":"Medium",
          "Descrip": "Ensure that your Microsoft Azure Cosmos DB accounts are using the Automatic Failover feature in order to enable resource replication and fault tolerance at the account level. Automatic failover allows Azure Cosmos DB to failover to the Azure cloud region with the highest failover priority when the source region become unavailable, without any additional action from the application or the user. The Cosmos DB account must have two or more regions configured in order to enable the feature.\n",
          "Command":"az",
          "Reference":"https://learn.microsoft.com/en-us/azure/cost-management-billing/costs/cost-mgt-alerts-monitor-usage-spending",
          "Args":"account list --query [*].id",
          "Second_Args": "consumption budget list --subscription",
          "Second_To_Second_Args":"",
          "Problem": "equal",
          "Type": "stdout",
          "Valid": ""
        },
     "2": {
          "Part" :"Subscriptions",
          "num_req": "1",
          "Title": "Ensure 'Not Allowed Resource Types' Policy Assignment in Use\n",
          "Risk_Level":"Medium",
          "Descrip": "Ensure that a 'Not Allowed Resource Types' policy is assigned to your Azure subscriptions in order to deny deploying restricted resources within your Azure cloud account for security and compliance purposes. Microsoft Azure Policy service allows you to enforce organizational standards and assess cloud compliance at-scale. With Azure Policy you can define, assign, and manage policies. These policies enforce different rules and effects over your cloud resources in order to stay compliant with corporate standards and service level agreements (SLAs). An assignment is a policy definition or initiative that has been assigned to a specific scope (e.g. a subscription or a resource group). For compliance, the 'Not Allowed Resource Types' policy assignment must use the 'Not Allowed Resource Types' built-in policy definition. This policy definition enables you to specify the cloud resource types that your organization cannot deploy.\n",
          "Reference":"https://learn.microsoft.com/en-us/azure/governance/policy/overview",
          "Args": "YXogcG9saWN5IGRlZmluaXRpb24gbGlzdCAtLXF1ZXJ5ICJbP2Rpc3BsYXlOYW1lIT0nTm90IGFsbG93ZWQgcmVzb3VyY2UgdHlwZXMnXS5pZCI=",
          "Problem": "not_equal",
          "Type": "print_iter",
          "Valid": ""
        },
        "3": {
        "Part" :"Advisor",
        "num_req": "2",
        "Title": "Check for Azure Advisors Medium Impact Recommendations\n",
        "Risk_Level":"Medium",
        "Descrip": "Ensure that all Microsoft Azure Advisor recommendations (i.e. best practices) found within your Azure account are implemented in order to optimize your cloud. The advisor is very important for cloud environments. Check Medium impact recommendations for your accounts.\n",
        "Command":"az",
        "Reference":"https://learn.microsoft.com/en-us/azure/advisor/view-recommendations",
        "Args": "account list --query [*].id",
        "Second_Args": "advisor recommendation list --subscription",
        "Second_To_Second_Args": "--query [?impact=='Medium'].name",
        "Problem": "not_equal",
        "Type": "print_iter",
        "Valid":""
      },
      "4": {
        "Part" :"Advisor",
        "num_req": "2",
        "Title": "Check for Azure Advisors High Impact Recommendations\n",
        "Risk_Level":"High",
        "Descrip": "Ensure that all Microsoft Azure Advisor recommendations (i.e. best practices) found within your Azure account are implemented in order to optimize your cloud. The advisor is very important for cloud environments. Check High impact recommendations for your accounts.\n",
        "Command":"az",
        "Reference":"https://learn.microsoft.com/en-us/azure/advisor/view-recommendations",
        "Args": "account list --query [*].id",
        "Second_Args": "advisor recommendation list --subscription",
        "Second_To_Second_Args": "--query [?impact=='High'].name",
        "Problem": "not_equal",
        "Type": "print_iter",
        "Valid":""
      },
      "5": {
        "Part" :"Advisor",
        "num_req": "2",
        "Title": "Check for Azure Advisors High Availability Recommendations\n",
        "Risk_Level":"Medium",
        "Descrip": "Ensure that all Microsoft Azure Advisor recommendations (i.e. best practices) found within your Azure account are implemented in order to optimize your cloud. The advisor is very important for cloud environments. Check High Availability Recommendations for your accounts.\n",
        "Command":"az",
        "Reference":"https://learn.microsoft.com/en-us/azure/advisor/advisor-high-availability-recommendations",
        "Args": "account list --query [*].id",
        "Second_Args": "advisor recommendation list --subscription",
        "Second_To_Second_Args": "--query [?category=='HighAvailability'].name",
        "Problem": "not_equal",
        "Type": "print_iter",
        "Valid":""
      },
      "6": {
        "Part" :"Advisor",
        "num_req": "2",
        "Title": "Check for Azure Advisors Security Recommendations\n",
        "Risk_Level":"High",
        "Descrip": "Ensure that all Microsoft Azure Advisor recommendations (i.e. best practices) found within your Azure account are implemented in order to optimize your cloud. The advisor is very important for cloud environments. Check Security Recommendations for your accounts.\n",
        "Command":"az",
        "Reference":"https://learn.microsoft.com/en-us/azure/advisor/advisor-security-recommendations",
        "Args": "account list --query [*].id",
        "Second_Args": "advisor recommendation list --subscription",
        "Second_To_Second_Args": "--query [?category=='Security'].name",
        "Problem": "not_equal",
        "Type": "print_iter",
        "Valid":""
      },
      "7": {
        "Part" :"Advisor",
        "num_req": "2",
        "Title": "Check for Azure Advisors Performance Recommendations\n",
        "Risk_Level":"High",
        "Descrip": "Ensure that all Microsoft Azure Advisor recommendations (i.e. best practices) found within your Azure account are implemented in order to optimize your cloud. The advisor is very important for cloud environments. Check Performance Recommendations for your accounts.\n",
        "Command":"az",
        "Reference":"https://learn.microsoft.com/en-us/azure/advisor/advisor-reference-performance-recommendations",
        "Args": "account list --query [*].id",
        "Second_Args": "advisor recommendation list --subscription",
        "Second_To_Second_Args": "--query [?category=='Performance'].name",
        "Problem": "not_equal",
        "Type": "print_iter",
        "Valid":""
      },
      "8": {
        "Part" :"Advisor",
        "num_req": "2",
        "Title": "Check for Azure Advisors Operational Excellence Recommendations\n",
        "Risk_Level":"High",
        "Descrip": "Ensure that all Microsoft Azure Advisor recommendations (i.e. best practices) found within your Azure account are implemented in order to optimize your cloud. The advisor is very important for cloud environments. Check Operational Excellence Recommendations for your accounts.\n",
        "Command":"az",
        "Reference":"https://learn.microsoft.com/en-us/azure/advisor/advisor-operational-excellence-recommendations",
        "Args": "account list --query [*].id",
        "Second_Args": "advisor recommendation list --subscription",
        "Second_To_Second_Args": "--query [?category=='OperationalExcellence'].name",
        "Problem": "not_equal",
        "Type": "print_iter",
        "Valid":""
      },
      "9": {
        "Part" :"Advisor",
        "num_req": "2",
        "Title": "Check for Azure Advisors Cost Recommendations\n",
        "Risk_Level":"High",
        "Descrip": "Ensure that all Microsoft Azure Advisor recommendations (i.e. best practices) found within your Azure account are implemented in order to optimize your cloud. The advisor is very important for cloud environments. Check Cost Recommendations for your accounts.\n",
        "Command":"az",
        "Reference":"https://learn.microsoft.com/en-us/azure/advisor/advisor-reference-cost-recommendations",
        "Args": "account list --query [*].id",
        "Second_Args": "advisor recommendation list --subscription",
        "Second_To_Second_Args": "--query [?category=='Cost'].name",
        "Problem": "not_equal",
        "Type": "print_iter",
        "Valid":""
      },
        "10": {
            "Part" :"Active Directory",
            "num_req": "2",
            "Title": "Enable Azure Active Directory Group Mails\n",
            "Risk_Level":"High",
            "Descrip": "Ensure that Microsoft Azure Active Directory groups are using mails to communicate.\n",
            "Reference":"https://learn.microsoft.com/en-us/azure/active-directory/fundamentals/how-to-manage-groups",
            "Command":"az",
            "Args": "ad group list --query [*].id",
            "Second_Args": "ad group show --group",
            "Second_To_Second_Args": "--query mailEnabled",
            "Problem": "not_equal",
            "Type": "stdout",
            "Valid":"true"
          },
          "11": {
            "Part" :"Active Directory",
            "num_req": "2",
            "Title": "Enable Security Defaults\n",
            "Risk_Level":"High",
            "Descrip": "Ensure that the Security Defaults feature is enabled for Azure Active Directory (AAD) in order to help protect your organization from common attacks. The Security Defaults feature is a set of basic identity security mechanisms recommended by Microsoft and provided at no extra cost in Active Directory. The security feature recommendations will be enforced within your organization to help users and administrators to protect themselves against common identity-related attacks. When enabled, the Security Defaults feature will recommend you to: Require all users and admins to register for Multi-Factor Authentication (MFA). Challenge users with MFA (usually when they use a new device or application, but more often for critical roles and tasks). Disable authentication from legacy authentication clients, which can't use Multi-Factor Authentication (MFA).\n",
            "Reference":"https://learn.microsoft.com/en-us/azure/active-directory/fundamentals/concept-fundamentals-security-defaults",
            "Command":"az",
            "Args": "ad group list --query [*].id",
            "Second_Args": "ad group show --group",
            "Second_To_Second_Args": "--query securityEnabled",
            "Problem": "not_equal",
            "Type": "stdout",
            "Valid":"true"
          }       
}