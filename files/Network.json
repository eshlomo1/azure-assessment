{
  "1": {
      "Part" :"Network",
      "num_req": "5",
      "Title": "Check for Unrestricted CIFS Access\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that Microsoft Azure network security groups (NSGs) do not allow unrestricted access on TCP port 445 in order to protect against attackers that use brute force methods to gain access to Azure virtual machines associated with these NSGs. Common Internet File System (CIFS) port 445 is used by client/server applications to provide shared access to files, printers, and communications between network nodes directly over TCP (without NetBIOS) in Microsoft Windows Server 2003 and later. CIFS is based on the enhanced version of Server Message Block (SMB) protocol for internet/intranet file sharing, developed by Microsoft.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/security/fundamentals/network-overview",
      "Command":"az",
      "Args": "network nsg list --output json",
      "Len":"--query [*].id",
      "Second_Args": "network nsg rule list --nsg-name",
      "Second_To_Second_Args": "--query [?direction=='Inbound'&&access=='Allow'&&protocol=='TCP'&&(destinationPortRange=='445')].sourceAddressPrefix --resource-group",
      "Problem": "three_equal",
      "Type": "stdout",
      "Valid":"*",
      "Valid2":"internet",
      "Valid3":"any"
    },
    "2": {
      "Part" :"Network",
      "num_req": "5",
      "Title": "Check for Unrestricted DNS Access\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that Microsoft Azure network security groups (NSGs) do not allow unrestricted access on TCP and UDP port 53 in order to protect against attackers that use brute force methods to gain access to Azure virtual machines associated with these NSGs. TCP/UDP port 53 is used by the Domain Name Service during DNS resolution (DNS lookup), when the requests are sent from DNS clients to DNS servers or between DNS servers.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview",
      "Command":"az",
      "Args": "network nsg list --output json",
      "Len":"--query [*].id",
      "Second_Args": "network nsg rule list --nsg-name",
      "Second_To_Second_Args": "--query [?direction=='Inbound'&&access=='Allow'&&protocol=='TCP'&&(destinationPortRange=='53')].sourceAddressPrefix --resource-group",
      "Problem": "three_equal",
      "Type": "stdout",
      "Valid":"*",
      "Valid2":"internet",
      "Valid3":"any"
    },
    "3": {
      "Part" :"Network",
      "num_req": "5",
      "Title": "Check for Unrestricted FTP Access\n",
      "Risk_Level":"Critical",
      "Descrip": "Ensure that Microsoft Azure network security groups (NSGs) do not allow unrestricted access on TCP ports 20 and 21 in order to protect against attackers that use brute force methods to gain access to Azure virtual machines associated with these NSGs. TCP ports 20 and 21 are used for data transfer and communication by the File Transfer Protocol (FTP) client-server applications.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview",
      "Command":"az",
      "Args": "network nsg list --output json",
      "Len":"--query [*].id",
      "Second_Args": "network nsg rule list --nsg-name",
      "Second_To_Second_Args": "--query [?direction=='Inbound'&&access=='Allow'&&protocol=='TCP'&&(destinationPortRange=='21')].sourceAddressPrefix --resource-group",
      "Problem": "three_equal",
      "Type": "stdout",
      "Valid":"*",
      "Valid2":"internet",
      "Valid3":"any"
    },
    "4": {
      "Part" :"Network",
      "num_req": "5",
      "Title": "Check for Unrestricted HTTP Access\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that Microsoft Azure network security groups (NSGs) do not allow unrestricted access on TCP port 80 in order to protect against attackers that use brute force methods to gain access to Azure virtual machines associated with these NSGs.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview",
      "Command":"az",
      "Args": "network nsg list --output json",
      "Len":"--query [*].id",
      "Second_Args": "network nsg rule list --nsg-name",
      "Second_To_Second_Args": "--query [?direction=='Inbound'&&access=='Allow'&&protocol=='TCP'&&(destinationPortRange=='80')].sourceAddressPrefix --resource-group",
      "Problem": "three_equal",
      "Type": "stdout",
      "Valid":"*",
      "Valid2":"internet",
      "Valid3":"any"
    },
    "5": {
      "Part" :"Network",
      "num_req": "5",
      "Title": "Check for Unrestricted HTTPS Access\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that Microsoft Azure network security groups (NSGs) do not allow unrestricted access on TCP port 443 in order to protect against attackers that use brute force methods to gain access to Azure virtual machines associated with these NSGs. Hypertext Transfer Protocol Secure (HTTPS) is a secure extension of the HTTP protocol TLS/SSL and the primary communication protocol used in web browsers.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview",
      "Command":"az",
      "Args": "network nsg list --output json",
      "Len":"--query [*].id",
      "Second_Args": "network nsg rule list --nsg-name",
      "Second_To_Second_Args": "--query [?direction=='Inbound'&&access=='Allow'&&protocol=='TCP'&&(destinationPortRange=='443')].sourceAddressPrefix --resource-group",
      "Problem": "three_equal",
      "Type": "stdout",
      "Valid":"*",
      "Valid2":"internet",
      "Valid3":"any"
    },
    "6": {
      "Part" :"Network",
      "num_req": "5",
      "Title": "Check for Unrestricted ICMP Access\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that Microsoft Azure network security groups (NSGs) do not allow unrestricted Internet Control Message Protocol (ICMP) access in order to protect against attackers that use brute force methods to gain access to Azure virtual machines associated with these NSGs. Internet Control Message Protocol (ICMP) is an error-reporting protocol that is typically used to troubleshoot TCP/IP networks by generating error messages for any issues with delivering IP packets. Even if ICMP is not a transport protocol, it can be used to exploit network vulnerabilities.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview",
      "Command":"az",
      "Args": "network nsg list --output json",
      "Len":"--query [*].id",
      "Second_Args": "network nsg rule list --nsg-name",
      "Second_To_Second_Args": "--query [?direction=='Inbound'&&access=='Allow'&&protocol=='ICMP'].sourceAddressPrefix --resource-group",
      "Problem": "three_equal",
      "Type": "stdout",
      "Valid":"*",
      "Valid2":"internet",
      "Valid3":"any"
    },
    "7": {
      "Part" :"Network",
      "num_req": "5",
      "Title": "Check for Unrestricted MS SQL Server Access\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that all your Microsoft Azure network security groups (NSGs) restrict inbound/ingress access on TCP port 1433 to trusted IP addresses only in order to implement the principle of least privilege and significantly reduce the attack surface. TCP port 1433 is used by Microsoft Azure SQL Server, the relational database management system developed by Microsoft.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview",
      "Command":"az",
      "Args": "network nsg list --output json",
      "Len":"--query [*].id",
      "Second_Args": "network nsg rule list --nsg-name",
      "Second_To_Second_Args": "--query [?direction=='Inbound'&&access=='Allow'&&protocol=='TCP'&&destinationPortRange=='1433'].sourceAddressPrefix --resource-group",
      "Problem": "three_equal",
      "Type": "stdout",
      "Valid":"*",
      "Valid2":"internet",
      "Valid3":"any"
    },
    "8": {
      "Part" :"Network",
      "num_req": "5",
      "Title": "Check for Unrestricted MongoDB Access\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that Microsoft Azure network security groups (NSGs) do not allow unrestricted access on TCP ports 27017, 27018 or 27019 in order to protect against attackers that use brute force methods to gain access to Azure virtual machines associated with these NSGs. MongoDB Database is a free and open-source cross-platform document-oriented NoSQL database.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview",
      "Command":"az",
      "Args": "network nsg list --output json",
      "Len":"--query [*].id",
      "Second_Args": "network nsg rule list --nsg-name",
      "Second_To_Second_Args": "--query [?direction=='Inbound'&&access=='Allow'&&protocol=='TCP'&&(destinationPortRange=='27017'||destinationPortRange=='27018'||destinationPortRange=='27019')].sourceAddressPrefix --resource-group",
      "Problem": "three_equal",
      "Type": "stdout",
      "Valid":"*",
      "Valid2":"internet",
      "Valid3":"any"
    },
    "9": {
      "Part" :"Network",
      "num_req": "5",
      "Title": "Check for Unrestricted MySQL Database Access\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that Microsoft Azure network security groups (NSGs) do not allow unrestricted access (i.e. 0.0.0.0/0) on TCP port 3306 in order to protect against malicious actors and significantly reduce the attack surface. TCP port 3306 is used by the MySQL Database Server, a popular open-source Relational Database Management System (RDBMS) server.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview",
      "Command":"az",
      "Args": "network nsg list --output json",
      "Len":"--query [*].id",
      "Second_Args": "network nsg rule list --nsg-name",
      "Second_To_Second_Args": "--query [?direction=='Inbound'&&access=='Allow'&&protocol=='TCP'&&destinationPortRange=='3306'].sourceAddressPrefix --resource-group",
      "Problem": "three_equal",
      "Type": "stdout",
      "Valid":"*",
      "Valid2":"internet",
      "Valid3":"any"
    },
    "10": {
      "Part" :"Network",
      "num_req": "5",
      "Title": "Check for Unrestricted NetBIOS Access\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that Microsoft Azure network security groups (NSGs) do not allow unrestricted access on TCP port 139 or UDP ports 137 and 138 in order to protect against attackers that use brute force methods to gain access to Azure virtual machines associated with these NSGs. TCP port 139 and UDP ports 137 and 138 are used for Network Basic Input/Output System (NetBIOS) name resolution (i.e. mapping a NetBIOS name to an IP address) by services such as File and Printer Sharing service running on Microsoft Windows Server OS.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview",
      "Command":"az",
      "Args": "network nsg list --output json",
      "Len":"--query [*].id",
      "Second_Args": "network nsg rule list --nsg-name",
      "Second_To_Second_Args": "--query [?direction=='Inbound'&&access=='Allow'&&((protocol=='TCP'&&destinationPortRange=='139')||(protocol=='UDP'&&(destinationPortRange=='137'||destinationPortRange=='138')))].sourceAddressPrefix --resource-group",
      "Problem": "three_equal",
      "Type": "stdout",
      "Valid":"*",
      "Valid2":"internet",
      "Valid3":"any"
    },
    "11": {
      "Part" :"Network",
      "num_req": "5",
      "Title": "Check for Unrestricted Oracle Database Access\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that your Microsoft Azure network security groups (NSGs) restrict inbound/ingress access on TCP port 1521 to trusted entities only (i.e. IP addresses) in order to implement the principle of least privilege and vastly reduce the attack surface. TCP port 1521 is used by Oracle Database Server, which is an object-relational database management system (RDBMS) server developed by Oracle Corporation.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview",
      "Command":"az",
      "Args": "network nsg list --output json",
      "Len":"--query [*].id",
      "Second_Args": "network nsg rule list --nsg-name",
      "Second_To_Second_Args": "--query [?direction=='Inbound'&&access=='Allow'&&protocol=='TCP'&&destinationPortRange=='1521'].sourceAddressPrefix --resource-group",
      "Problem": "three_equal",
      "Type": "stdout",
      "Valid":"*",
      "Valid2":"internet",
      "Valid3":"any"
    },
    "12": {
      "Part" :"Network",
      "num_req": "5",
      "Title": "Check for Unrestricted PostgreSQL Database Access\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that your Microsoft Azure network security groups (NSGs) allow inbound/ingress access on TCP port 5432 to trusted IP addresses only, in order to implement the principle of least privilege and greatly reduce the attack surface. TCP port 5432 is used by the PostgreSQL Database Server, an object-relational database management system (RDBMS) server developed by PostgreSQL Global Development Group.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview",
      "Command":"az",
      "Args": "network nsg list --output json",
      "Len":"--query [*].id",
      "Second_Args": "network nsg rule list --nsg-name",
      "Second_To_Second_Args": "--query [?direction=='Inbound'&&access=='Allow'&&protocol=='TCP'&&destinationPortRange=='5432'].sourceAddressPrefix --resource-group",
      "Problem": "three_equal",
      "Type": "stdout",
      "Valid":"*",
      "Valid2":"internet",
      "Valid3":"any"
    },
    "13": {
      "Part" :"Network",
      "num_req": "5",
      "Title": "Check for Unrestricted RDP Access\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that Microsoft Azure network security groups (NSGs) do not allow unrestricted access (i.e. 0.0.0.0/0) on TCP port 3389 in order to protect against attackers that use brute force techniques to gain access to the Azure virtual machines associated with the NSGs. TCP port 3389 is used for secure remote GUI login to Microsoft VMs by connecting a Remote Desktop Protocol (RDP) client application with an RDP server.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview",
      "Command":"az",
      "Args": "network nsg list --output json",
      "Len":"--query [*].id",
      "Second_Args": "network nsg rule list --nsg-name",
      "Second_To_Second_Args": "--query [?direction=='Inbound'&&access=='Allow'&&protocol=='TCP'&&destinationPortRange=='3389'].sourceAddressPrefix --resource-group",
      "Problem": "three_equal",
      "Type": "stdout",
      "Valid":"*",
      "Valid2":"internet",
      "Valid3":"any"
    },
    "14": {
      "Part" :"Network",
      "num_req": "5",
      "Title": "Check for Unrestricted RPC Access\n",
      "Risk_Level":"Critical",
      "Descrip": "Ensure that Microsoft Azure network security groups (NSGs) do not allow unrestricted access (i.e. 0.0.0.0/0) on TCP port 3389 in order to protect against attackers that use brute force techniques to gain access to the Azure virtual machines associated with the NSGs. TCP port 3389 is used for secure remote GUI login to Microsoft VMs by connecting a Remote Desktop Protocol (RDP) client application with an RDP server.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview",
      "Command":"az",
      "Args": "network nsg list --output json",
      "Len":"--query [*].id",
      "Second_Args": "network nsg rule list --nsg-name",
      "Second_To_Second_Args": "--query [?direction=='Inbound'&&access=='Allow'&&protocol=='TCP'&&destinationPortRange=='135'].sourceAddressPrefix --resource-group",
      "Problem": "three_equal",
      "Type": "stdout",
      "Valid":"*",
      "Valid2":"internet",
      "Valid3":"any"
    },
    "15": {
      "Part" :"Network",
      "num_req": "5",
      "Title": "Check for Unrestricted SMTP Access\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that Microsoft Azure network security groups (NSGs) do not allow unrestricted access on TCP port 25 in order to protect against attackers that use brute force methods to gain access to Azure virtual machines associated with these NSGs. TCP port 25 is used by Simple Mail Transfer Protocol (SMTP) servers for email transmission.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview",
      "Command":"az",
      "Args": "network nsg list --output json",
      "Len":"--query [*].id",
      "Second_Args": "network nsg rule list --nsg-name",
      "Second_To_Second_Args": "--query [?direction=='Inbound'&&access=='Allow'&&protocol=='TCP'&&(destinationPortRange=='25')].sourceAddressPrefix --resource-group",
      "Problem": "three_equal",
      "Type": "stdout",
      "Valid":"*",
      "Valid2":"internet",
      "Valid3":"any"
    },
    "16": {
      "Part" :"Network",
      "num_req": "5",
      "Title": "Check for Unrestricted SSH Access\n",
      "Risk_Level":"Critical",
      "Descrip": "Check your Microsoft Azure network security groups (NSGs) for inbound rules that allow unrestricted access (i.e. 0.0.0.0/0) on TCP port 22 and restrain access to only those IP addresses that require it in order to implement the principle of least privilege and reduce the possibility of a breach. TCP port 22 is used for secure remote login by connecting an SSH client application with an SSH server.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview",
      "Command":"az",
      "Args": "network nsg list --output json",
      "Len":"--query [*].id",
      "Second_Args": "network nsg rule list --nsg-name",
      "Second_To_Second_Args": "--query [?direction=='Inbound'&&access=='Allow'&&protocol=='TCP'&&(destinationPortRange=='22')].sourceAddressPrefix --resource-group",
      "Problem": "three_equal",
      "Type": "stdout",
      "Valid":"*",
      "Valid2":"internet",
      "Valid3":"any"
    },
    "17": {
      "Part" :"Network",
      "num_req": "5",
      "Title": "Check for Unrestricted Telnet Access\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that Microsoft Azure network security groups (NSGs) do not allow unrestricted access on TCP port 23 in order to protect against attackers that use brute force methods to gain access to Azure virtual machines associated with these NSGs. TCP port 23 is used by the Telnet server application (telnetd). Telnet is usually used to check whether a client can make TCP/IP connections to a particular service.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview",
      "Command":"az",
      "Args": "network nsg list --output json",
      "Len":"--query [*].id",
      "Second_Args": "network nsg rule list --nsg-name",
      "Second_To_Second_Args": "--query [?direction=='Inbound'&&access=='Allow'&&protocol=='TCP'&&(destinationPortRange=='23')].sourceAddressPrefix --resource-group",
      "Problem": "three_equal",
      "Type": "stdout",
      "Valid":"*",
      "Valid2":"internet",
      "Valid3":"any"
    },
    "18": {
      "Part" :"Network",
      "num_req": "5",
      "Title": "Check for Unrestricted UDP Access\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that Microsoft Azure network security groups (NSGs) do not allow unrestricted access (i.e. 0.0.0.0/0) on UDP ports in order to implement the Principle of Least Privilege (POLP) and effectively reduce the attack surface. UDP or User Datagram Protocol is a communication protocol used across the Internet for time-sensitive transmissions such as video streaming or DNS lookups. With UDP, the data can be transferred very quickly, but it can also cause packets to become lost in transit and this can create opportunities for malicious activities such as DDoS attacks.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview",
      "Command":"az",
      "Args": "network nsg list --output json",
      "Len":"--query [*].id",
      "Second_Args": "network nsg rule list --nsg-name",
      "Second_To_Second_Args": "--query [?direction=='Inbound'&&access=='Allow'&&protocol=='UDP'].sourceAddressPrefix --resource-group",
      "Problem": "three_equal",
      "Type": "stdout",
      "Valid":"*",
      "Valid2":"internet",
      "Valid3":"any"
    },
    "19": {
      "Part" :"Network",
      "num_req": "1",
      "Title": "Enable Azure Network Watcher\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that Network Watcher service is enabled within your Azure account subscriptions to help you monitor and diagnose various conditions at the network level. Microsoft Azure Network Watcher provides tools to monitor, diagnose, view metrics, and enable or disable logs for resources within a virtual network.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/network-watcher/network-watcher-create",
      "Args": "YXogbmV0d29yayB3YXRjaGVyIGxpc3QgLS1xdWVyeSAnWypdLnsibG9jYXRpb24iOmxvY2F0aW9uLCJwcm92aXNpb25pbmdTdGF0ZSI6cHJvdmlzaW9uaW5nU3RhdGUsInJlc291cmNlR3JvdXAiOnJlc291cmNlR3JvdXB9Jw==",
      "Problem": "equal",
      "Type": "oneshot",
      "Valid":""
    },
    "20": {
      "Part" :"Network",
      "num_req": "4",
      "Title": "Enable DDoS Standard Protection for Virtual Networks\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that DDoS Standard Protection feature is enabled for all your security-critical Microsoft Azure virtual networks (VNETs). DDoS Protection Standard is a premium paid cloud feature that offers enhanced Distributed Denial-of-Service (DDoS) mitigation capabilities via adaptive tuning, attack alert notifications, and telemetry to protect against the impacts of large DDoS attacks for all the protected resources available within your Azure virtual networks.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/ddos-protection/manage-ddos-protection",
      "Command":"az",
      "Args": "account list --query [*].id",
      "Len":"--query [].id",
      "Second_Args": "network vnet list --subscription",
      "Second_To_Second_Args": "--output json",
      "Third_Args":"network vnet show --name",
      "Third_To_Third_Args":"--query enableDdosProtection --resource-group",
      "Problem": "not_equal",
      "Type": "stdout",
      "Valid":"false"
    },
    "21": {
      "Part" :"Network",
      "num_req": "5",
      "Title": "Review Network Interfaces with IP Forwarding Enabled\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that all the Microsoft Azure network interfaces (NICs) with IP forwarding enabled are regularly reviewed for security and compliance reasons. The IP Forwarding feature enables the virtual machine (VM) associated with the network interface attached, to receive network traffic that is not intended for one of the IP addresses defined within the IP configurations attached to the network interface, and send network traffic with a different source IP address than the one assigned to one of a network interface's IP configurations. Therefore, IP forwarding is used only by Azure virtual machines that need to forward traffic (also known as a network virtual appliances).\n",
      "Reference":"https://docs.securestate.vmware.com/rule-docs/azure-security-center-disable-ip-forwarding",
      "Command":"az",
      "Len":"--query [].id",
      "Args":"network nic list --output json",
      "Second_Args": "network nic show --name",
      "Second_To_Second_Args":"--query enableIpForwarding --resource-group ",
      "Problem": "equal",
      "Type": "stdout",
      "Valid": "true"
    },
    "22": {
      "Part" :"Network",
      "num_req": "5",
      "Title": "Review Network Interfaces with Accelerated Networking Enable\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that all the Microsoft Azure network interfaces (NICs) with Accelerated networking enabled are regularly reviewed for security and compliance reasons. Accelerated networking improves performance as it allows the network interfaces of Azure VM to bypass the host\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/site-recovery/azure-vm-disaster-recovery-with-accelerated-networking",
      "Command":"az",
      "Len":"--query [].id",
      "Args":"network nic list --output json",
      "Second_Args": "network nic show --name",
      "Second_To_Second_Args":"--query enableAcceleratedNetworking --resource-group ",
      "Problem": "equal",
      "Type": "stdout",
      "Valid": "true"
    },
    "23": {
      "Part" :"Network",
      "num_req": "5",
      "Title": "Check Encryption Support for VMNET\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that all the Microsoft Azure network interfaces (NICs) with Accelerated networking enabled are regularly reviewed for security and compliance reasons. Accelerated networking improves performance as it allows the network interfaces of Azure VM to bypass the host\n",
      "Reference":"https://learn.microsoft.com/en-us/javascript/api/@azure/arm-network/networkinterface?view=azure-node-latest",
      "Command":"az",
      "Len":"--query [].id",
      "Args":"network nic list --output json",
      "Second_Args": "network nic show --name",
      "Second_To_Second_Args":"--query vnetEncryptionSupported --resource-group ",
      "Problem": "equal",
      "Type": "stdout",
      "Valid": "true"
    }, 
    "24": {
      "Part" :"API Gateway",
      "num_req": "5",
      "Title": "Ensure The API Is Using Auth0\n",
      "Risk_Level":"Medium",
      "Descrip": "It is important to implement a secure authentication mechanism in your Azure environment to protect your APIs. This rule helps to ensure that the API is using a secure authentication mechanism, such as Auth0, to authenticate and authorize clients accessing the API. Auth0 is an identity and access management platform that provides secure and easy-to-use authentication and authorization services for your APIs. By using Auth0, you can easily manage and secure your API, and ensure that only authorized clients are able to access the API.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/api-management/api-management-howto-protect-backend-with-aad",
      "Command":"az",
      "Args": "apim list --output json",
      "Len": "--query [*].id",
      "Second_Args": "apim api list --service-name",
      "Second_To_Second_Args": "--query [?authenticationSettings.oAuth2==null || authenticationSettings.oAuth2==false].id  --resource-group",
      "Problem": "not_equal",
      "Type": "print_iter",
      "Valid":""
    }, 
    "25": {
      "Part" :"API Gateway",
      "num_req": "5",
      "Title": "Ensure That Named Values Are Encrypted\n",
      "Risk_Level":"Medium",
      "Descrip": "This rule involves ensuring that sensitive information stored in named values are encrypted to prevent unauthorized access. Named values are used to store configuration information and secrets, such as connection strings and API keys, that are used by Logic Apps and other Azure services. When named values are encrypted, they are protected from potential security breaches that could compromise sensitive information. To implement this rule, you can use the Azure Key Vault to encrypt named values. Azure Key Vault provides a centralized location to store and manage keys, secrets, and certificates used to encrypt and protect sensitive information. By using Azure Key Vault, you can ensure that named values are encrypted and that only authorized users can access the encrypted information.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/api-management/api-management-howto-properties?tabs=azure-portal#key-vault-secrets",
      "Command":"az",
      "Args": "apim list --output json",
      "Len": "--query [*].id",
      "Second_Args": "apim nv list --service-name",
      "Second_To_Second_Args": "--query [?keyVault==null].id   --resource-group",
      "Problem": "not_equal",
      "Type": "print_iter",
      "Valid":""
    },
    "26": {
      "Part" :"CDN",
      "num_req": "8",
      "Title": "Ensure that CDN Traffic is Using HTTPS\n",
      "Risk_Level":"Medium",
      "Descrip": "We use SSL certificates for secure traffic between client and server. Ensure your systems are using SSL certified traffic and try using the HTTPS (443) protocol.\n",
      "Reference":"https://www.cloudflare.com/learning/ssl/why-is-http-not-secure",
      "Command":"az",
      "Len":"--query [*].id",
      "Args":"cdn profile list --output json",
      "Second_Args": "cdn endpoint list --profile-name",
      "Second_To_Second_Args":"--query [*].id --resource-group",
      "Third_Args":"cdn endpoint show --ids",
      "Third_To_Third_Args":"--query isHttpAllowed",
      "Problem": "equal",
      "Type": "stdout",
      "Valid": "true"
    }, 
    "27": {
      "Part" :"CDN",
      "num_req": "8",
      "Title": "Configure HTTPS on an Azure CDN\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure the https port is allowed on your CDN. The HTTPS port ensures that the traffic between the client and the server is encrypted with an SSL certificate.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/cdn/cdn-custom-ssl?tabs=option-1-default-enable-https-with-a-cdn-managed-certificate",
      "Command":"az",
      "Len":"--query [*].id",
      "Args":"cdn profile list --output json",
      "Second_Args": "cdn endpoint list --profile-name",
      "Second_To_Second_Args":"--query [*].id --resource-group",
      "Third_Args":"cdn endpoint show --ids",
      "Third_To_Third_Args":"--query isHttpsAllowed",
      "Problem": "equal",
      "Type": "stdout",
      "Valid": "true"
    }
}