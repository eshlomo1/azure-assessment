{
  "1": {
    "Part" :"Virtual Machines",
    "num_req": "2",
    "Title": "Check for SSH Authentication Type\n",
    "Risk_Level":"High",
    "Descrip": "Using SSH keys instead of common credentials (i.e. username and password) represents the best way to secure your Linux virtual machines against malicious activities such as brute-force attacks, by providing a level of authorization that can only be fulfilled by privileged users who have ownership to the private key associated with the public key created on these virtual machines. An attacker may be able to get access to the virtual machineâ€™s public key, but without the associated private key, he/she will be unable to gain shell access to the server.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/virtual-machines/linux/ssh-from-windows",
    "Command":"az",
    "Args": "vm list --query [*].id",
    "Second_Args": "vm show --ids",
    "Second_To_Second_Args": "--query osProfile.linuxConfiguration.disablePasswordAuthentication",
    "Problem": "equal",
    "Type": "stdout",
    "Valid":"false"
  },
  "2": {
    "Part" :"Virtual Machines",
    "num_req": "2",
    "Title": "Azure Disk Encryption for Non-Boot Disk Volumes\n",
    "Risk_Level":"High",
    "Descrip": "Ensure that your Microsoft Azure virtual machine (VM) data volumes (i.e. non-boot volumes) are encrypted using Azure Disk Encryption in order to meet security and compliance requirements. ADE encrypts the OS and data disks of Azure virtual machines (VMs) inside your VMs using the CPU via the DM-Crypt feature for Linux or the BitLocker feature for Windows. ADE is integrated with Azure Key Vault to help you control and manage the disk encryption keys and secrets. The VM data volume encryption and decryption is handled transparently and does not require any additional action from you, your Azure virtual machine, or your application.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/virtual-machines/disk-encryption-overview",
    "Command":"az",
    "Args": "vm list --query [*].id",
    "Second_Args": "vm encryption show --ids",
    "Second_To_Second_Args": "--query dataDisk",
    "Problem": "equal",
    "Type": "error",
    "Valid":"WARNING: Azure Disk Encryption is not enabled"
  },
  "3": {
    "Part" :"Virtual Machines",
    "num_req": "4",
    "Title": "Check for Unused Load Balancers\n",
    "Risk_Level":"Low",
    "Descrip": "Identify any unused load balancers available within your Azure cloud account and delete them in order to eliminate unnecessary costs and meet compliance requirements when it comes to cloud resource management. A Microsoft Azure load balancer is considered unused when it doesn't have any associated backend pool instances. The backend pool instances can be individual virtual machines or instances running within a virtual machine scale set.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/load-balancer/load-balancer-overview",
    "Command":"az",
    "Args": "account list --query [*].id",
    "Len":"--query [].id",
    "Second_Args": "network lb list --subscription",
    "Second_To_Second_Args": "--output json",
    "Third_Args":"network lb show --name",
    "Third_To_Third_Args":"--query backendAddressPools[*].backendIpConfigurations[*].id|[] --resource-group",
    "Problem": "equal",
    "Type": "stdout",
    "Valid":""
  },
  "4": {
    "Part" :"Virtual Machines",
    "num_req": "4",
    "Title": "Check for Associated Load Balancers\n",
    "Risk_Level":"Medium",
    "Descrip": "Ensure that each Microsoft Azure virtual machine scale set is integrated with a load balancer in order to distribute incoming traffic among healthy virtual machine instances running within the scale set. Azure load balancer is a layer 4 load balancer that provides low latency, high throughput, and scales up to millions of flows for all TCP and UDP web applications.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/load-balancer/load-balancer-overview",
    "Command":"az",
    "Args": "account list --query [*].id",
    "Len":"--query [].id",
    "Second_Args": "vmss list --subscription",
    "Second_To_Second_Args": "--output json",
    "Third_Args":"vmss show --name",
    "Third_To_Third_Args":"--query virtualMachineProfile.networkProfile.networkInterfaceConfigurations[*].ipConfigurations[*].loadBalancerBackendAddressPools[*].id|[] --resource-group",
    "Problem": "equal",
    "Type": "stdout",
    "Valid":""
  },
  "5": {
    "Part" :"Virtual Machines",
    "num_req": "2",
    "Title": "Azure Disk Encryption for Unattached Disk Volumes\n",
    "Risk_Level":"Medium",
    "Descrip": "Ensure that your detached Microsoft Azure virtual machine (VM) disk volumes are encrypted using Azure Disk Encryption in order to meet security and compliance requirements. ADE encrypts the OS and data disks of Azure virtual machines (VMs) inside your VMs using the CPU via the DM-Crypt feature for Linux or the BitLocker feature for Windows. ADE is integrated with Azure Key Vault to help you control and manage the disk encryption keys and secrets. The unattached disk volumes encryption and decryption is handled transparently and does not require any additional action from you, your Azure virtual machine, or your application.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/virtual-machines/disk-encryption-overview",
    "Command":"az",
    "Args": "disk list --query [?diskState=='Unattached'].id",
    "Second_Args": "disk show --ids",
    "Second_To_Second_Args": "--query encryptionSettingsCollection",
    "Problem": "equal",
    "Type": "stdout",
    "Valid":""
  },
  "6": {
    "Part" :"Virtual Machines",
    "num_req": "2",
    "Title": "Azure Disk Encryption for Boot Disk Volumes\n",
    "Risk_Level":"Medium",
    "Descrip": "Ensure that your Microsoft Azure virtual machine (VM) boot volumes are encrypted using Azure Disk Encryption in order to meet security and compliance requirements. ADE encrypts the OS and data disks of Azure virtual machines (VMs) inside your VMs using the CPU via the DM-Crypt feature for Linux or the BitLocker feature for Windows. ADE is integrated with Azure Key Vault to help you control and manage the disk encryption keys and secrets. The boot (OS) volumes encryption and decryption is handled transparently and does not require any additional action from you, your Azure virtual machine, or your cloud application.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/virtual-machines/disk-encryption-overview",
    "Command":"az",
    "Args": "vm list --query [*].id",
    "Second_Args": "vm encryption show --ids",
    "Second_To_Second_Args": "--query osDisk",
    "Problem": "equal",
    "Type": "error",
    "Valid":"WARNING: Azure Disk Encryption is not enabled"
  },
  "7": {
    "Part" :"Virtual Machines",
    "num_req": "4",
    "Title": "Approved Azure Machine Image in Use\n",
    "Risk_Level":"Medium",
    "Descrip": "Ensure that all the Azure virtual machine (VM) instances necessary for your application stack are launched from an approved base Azure machine image, known as golden machine image, in order to enforce application security best practices, consistency, and save time when scaling your application.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/virtual-machines/windows/capture-image-resource",
    "Command":"az",
    "Args": "account list --query [*].id",
    "Len":"--query [].id",
    "Second_Args": "vm list --subscription",
    "Second_To_Second_Args": "--output json",
    "Third_Args":"vm show --name",
    "Third_To_Third_Args":"--query storageProfile.imageReference.id --resource-group",
    "Problem": "equal",
    "Type": "stdout",
    "Valid":""
  },
  "8": {
    "Part" :"Virtual Machines",
    "num_req": "2",
    "Title": "Disable Premium SSD\n",
    "Risk_Level":"High",
    "Descrip": "Ensure that your Microsoft Azure virtual machines (VMs) are using Standard SSD disk volumes instead of Premium SSD volumes for cost-effective storage that fits a broad range of workloads from web servers to enterprise applications that need consistent performance at lower IOPS levels. Unless you are running mission-critical applications or performance sensitive workloads that need more than 6000 IOPS or 750 MiB/s of throughput per VM disk volume, Cloud Conformity recommends converting your Premium SSD volumes to Standard SSD in order to lower the cost of your Azure monthly bill.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/virtual-machines/disks-types",
    "Command":"az",
    "Args": "vm list --query [*].id",
    "Second_Args": "vm show --ids",
    "Second_To_Second_Args": "--query storageProfile.osDisk.managedDisk.storageAccountType",
    "Problem": "equal",
    "Type": "stdout",
    "Valid":"Premium_LRS"
  },
  "9": {
  "Part" :"Virtual Machines",
    "num_req": "4",
    "Title": "Check for Zone-Redundant Virtual Machine Scale Sets\n",
    "Risk_Level":"High",
    "Descrip": "Ensure that all your Microsoft Azure virtual machine scale sets are using zone-redundant availability configurations instead of single-zone (zonal) configurations, to deploy and load balance virtual machines (VMs) across multiple Availability Zones (AZs) in order to protect your Azure scale sets from datacenter-level failures.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-use-availability-zones",
    "Command":"az",
    "Args": "account list --query [*].id",
    "Len":"--query [].id",
    "Second_Args": "vmss list --subscription",
    "Second_To_Second_Args": "--output json",
    "Third_Args":"vmss show --name",
    "Third_To_Third_Args":"--query zones --resource-group",
    "Problem": "equal",
    "Type": "stdout",
    "Valid":"1" 
  },
  "10": {
    "Part" :"Virtual Machines",
    "num_req": "4",
    "Title": "Enable Automatic Instance Repairs\n",
    "Risk_Level":"Medium",
    "Descrip":"Ensure that unhealthy virtual machine instances are automatically deleted from the scale sets and new ones are created, using the latest instance model settings. Automatic Instance Repairs feature relies on health checks performed for individual instances running in a scale set. These virtual machine instances can be configured to emit an application health status using the Azure Application Health extension or a load balancer health probe. If a VM instance is found to be unhealthy, as reported by the Application Health extension or by the associated load balancer health probe, then the scale set performs the repair action by deleting the unhealthy instance and creating a new one to replace it.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-automatic-instance-repairs",
    "Command":"az",
    "Args": "account list --query [*].id",
    "Len":"--query [].id",
    "Second_Args": "vmss list --subscription",
    "Second_To_Second_Args": "--output json",
    "Third_Args":"vmss show --name",
    "Third_To_Third_Args":"--query automaticRepairsPolicy.enabled --resource-group",
    "Problem": "not_equal",
    "Type": "stdout",
    "Valid":"true"
  },
  "11": {
    "Part" :"Virtual Machines",
    "num_req": "4",
    "Title": "Enable Automatic OS Upgrades\n",
    "Risk_Level":"Medium",
    "Descrip":"Ensure that operating system (OS) upgrades are automatically applied to your Microsoft Azure virtual machine scale sets when a newer version of the OS image is released by the image publishers. Automatic OS Upgrades feature supports both Windows and Linux images, and can be enabled for all virtual machine sizes. An automatic OS upgrade works by replacing the boot (OS) disk of a virtual machine instance running within a scale set with a new disk created using the latest image version available. Any configured extensions and custom data scripts are run on the OS disk, while persisted data disks are retained. To minimize the application downtime, the upgrades take place in multiple batches, with a maximum of 20% of the scale set upgrading at any time.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-automatic-upgrade",
    "Command":"az",
    "Args": "account list --query [*].id",
    "Len":"--query [].id",
    "Second_Args": "vmss list --subscription",
    "Second_To_Second_Args": "--output json",
    "Third_Args":"vmss show --name",
    "Third_To_Third_Args":"--query upgradePolicy.automaticOsUpgradePolicy.enableAutomaticOsUpgrade  --resource-group",
    "Problem": "not_equal",
    "Type": "stdout",
    "Valid":"true"
  },
  "12": {
    "Part" :"Virtual Machines",
    "num_req": "2",
    "Title": "Enable Guest-Level Diagnostics for Virtual Machines\n",
    "Risk_Level":"Medium",
    "Descrip":"Ensure that Guest-Level Diagnostics feature is enabled for your Azure virtual machines (VMs) in order to gather diagnostic data useful to create notification alerts and get vital information about the state of your VM applications using advanced metrics.\n",
    "Reference":"https://learn.microsoft.com/en-us/answers/questions/648955/automate-enable-guest-level-monitoring-on-vm",
    "Command":"az",
    "Args": "vm list --query [*].id",
    "Second_Args": "vm show --ids",
    "Second_To_Second_Args": "--query resources[*].settings.ladCfg.diagnosticMonitorConfiguration",
    "Problem": "equal",
    "Type": "stdout",
    "Valid":""
  },
  "13": {
    "Part" :"Virtual Machines",
    "num_req": "4",
    "Title": "Enable Instance Termination Notifications for Virtual Machine Scale Sets\n",
    "Risk_Level":"Medium",
    "Descrip":"Ensure that your Microsoft Azure virtual machine scale sets are configured to receive instance termination notifications through the Azure Metadata service and have a predefined delay timeout configured for the 'Terminate' operation (event). The termination notifications are delivered through Scheduled Events, an Azure Metadata feature which sends termination notifications, and can also be used to delay impactful operations such as reboots and redeployments. The delay associated with the 'Terminate' event will depend on the delay limit specified in the VM scale set model configuration.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-terminate-notification",
    "Command":"az",
    "Args": "account list --query [*].id",
    "Len":"--query [].id",
    "Second_Args": "vmss list --subscription",
    "Second_To_Second_Args": "--output json",
    "Third_Args":"vmss show --name",
    "Third_To_Third_Args":"--query virtualMachineProfile.scheduledEventsProfile.terminateNotificationProfile.enable  --resource-group",
    "Problem": "not_equal",
    "Type": "stdout",
    "Valid":"true"
  },
  "14": {
    "Part" :"Virtual Machines",
    "num_req": "1",
    "Title": "Enable Just-In-Time Access for Virtual Machines\n",
    "Risk_Level":"High",
    "Descrip":"Ensure that Just-in-Time (JIT) access is enabled for your Azure virtual machines (VMs) in order to allow you to lock down inbound traffic to your VMs and reduce exposure to attacks while providing easy SSH/RDP access when needed.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/defender-for-cloud/just-in-time-access-usage#work-with-jit-vm-access-using-microsoft-defender-for-cloud",
    "Args": "YXogc2VjdXJpdHkgaml0LXBvbGljeSBsaXN0ICAtLXF1ZXJ5ICJbKl0udmlydHVhbE1hY2hpbmVzWypdLmlkfFtdIg==",
    "Problem": "equal",
    "Type": "stdout",
    "Valid":""
  },
  "15": {
    "Part" :"Virtual Machines",
    "num_req": "2",
    "Title": "Enable System-Assigned Managed Identities\n",
    "Risk_Level":"Medium",
    "Descrip":"Ensure that your Microsoft Azure virtual machines (VMs) have system-assigned managed identities enabled in order to allow secure virtual machine access to Azure resources such as key vaults and storage accounts.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/qs-configure-portal-windows-vm",
    "Command":"az",
    "Args": "vm list --query [*].id",
    "Second_Args": "vm show --ids",
    "Second_To_Second_Args":"--query identity",
    "Problem": "equal",
    "Type": "stdout",
    "Valid":""
  },
  "16": {
    "Part" :"Virtual Machines",
    "num_req": "2",
    "Title": "Enable Virtual Machine Boot Diagnostics\n",
    "Risk_Level":"Medium",
    "Descrip":"Ensure that Boot Diagnostics feature is enabled for your Azure virtual machines (VMs) in order to capture server serial console output and the operating system screenshots, required for diagnosing and troubleshooting VM startup issues.\n",
    "Reference":"https://learn.microsoft.com/en-us/troubleshoot/azure/virtual-machines/boot-diagnostics",
    "Command":"az",
    "Args": "vm list --query [*].id",
    "Second_Args": "vm show --ids",
    "Second_To_Second_Args":"--query diagnosticsProfile.bootDiagnostics.enabled",
    "Problem": "not_equal",
    "Type": "stdout",
    "Valid":"true"
  },
  "17": {
    "Part" :"Virtual Machines",
    "num_req": "2",
    "Title": "Remove Unattached Virtual Machine Disk Volumes\n",
    "Risk_Level":"Medium",
    "Descrip":"Identify any unattached (unused) Microsoft Azure virtual machine disk volumes available within your Azure cloud account and delete them in order to lower the cost of your monthly bill and reduce the risk of sensitive data leakage.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/virtual-machines/disks-find-unattached-portal",
    "Command":"az",
    "Args": "disk list --query [*].id",
    "Second_Args": "disk show --ids",
    "Second_To_Second_Args":"--query diskState",
    "Problem": "equal",
    "Type": "stdout",
    "Valid":"Unattached"
  },
  "18": {
    "Part" :"Virtual Machines",
    "num_req": "2",
    "Title": "Use BYOK for Disk Volumes Encryption\n",
    "Risk_Level":"High",
    "Descrip":"Ensure that your Azure virtual machine disk volumes are using customer-managed keys (also known as Bring Your Own Keys - BYOKs) instead of service-managed keys (default keys used by Microsoft Azure for disk encryption), in order to have a more granular control over your VM data encryption/decryption process.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/virtual-machines/windows/disk-encryption-faq",
    "Command":"az",
    "Args": "vm list --query [*].id",
    "Second_Args": "vm encryption show --ids",
    "Second_To_Second_Args":"--query disks[*].encryptionSettings[*].keyEncryptionKey.keyUrl[]",
    "Problem": "not_equal",
    "Type": "error",
    "Valid":"WARNING: Azure Disk Encryption is not enabled"
  },
  "19": {
    "Part" :"Virtual Machines",
    "num_req": "2",
    "Title": "Use Customer Managed Keys for Virtual Hard Disk Encryption\n",
    "Risk_Level":"Medium",
    "Descrip":"Ensure that your Microsoft Azure Virtual Hard Disk (VHD) volumes are using Customer Managed Keys (CMKs) instead of Platform-Managed Keys (PMKs â€“ default keys used by Microsoft Azure for disk encryption) in order to have full control over your VHD data encryption and decryption process. Virtual Hard Disks are the old style disks that were attached to Azure virtual machines (VMs). VHDs are stored in blob storage accounts.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/virtual-machines/disks-enable-customer-managed-keys-portal",
    "Command":"az",
    "Args": "disk list --query [*].id",
    "Second_Args": "disk show --ids",
    "Second_To_Second_Args":"--query encryption.type",
    "Problem": "equal",
    "Type": "stdout",
    "Valid":"EncryptionAtRestWithPlatformKey"
  },
  "20": {
    "Part" :"Virtual Machines",
    "num_req": "2",
    "Title": "Server Side Encryption for Unattached Disk using CMK\n",
    "Risk_Level":"High",
    "Descrip":"Microsoft Azure provides multiple distinct layers of encryption protection for virtual machine (VM) managed disks. VM managed disks are encrypted with Azure Storage encryption, also known as Server-Side Encryption (SSE), using platform-managed keys (PMK), to protect your data at rest and help you meet your organizational security and compliance commitments. By default, VM managed disk volumes (regardless of the VM attachment status) use platform-managed encryption keys. However, in order to have a more granular control over your data encryption/decryption process, it is strongly recommended to use your own keys (CMKs) instead of platform-managed keys (PMKs) for data (non-boot) disk volume encryption.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/virtual-machines/disk-encryption",
    "Command":"az",
    "Args": "disk list --query [?diskState=='Unattached'].id",
    "Second_Args": "disk show --ids",
    "Second_To_Second_Args":"--query encryption.type",
    "Problem": "equal",
    "Type": "stdout",
    "Valid":"EncryptionAtRestWithPlatformKey"
  },
  "21": {
    "Part" :"Virtual Machines",
    "num_req": "3",
    "Title": "Enable Accelerated Networking for Virtual Machines\n",
    "Risk_Level":"Medium",
    "Descrip":"Ensure that Accelerated Networking feature is enabled for your Azure virtual machines (VMs) in order to provide low latency and high throughput for the network interfaces (NICs) attached to the VMs. Accelerated networking enables single root input/output virtualization (SR-IOV) for virtual machines, vastly improving its networking performance. This high-performance pathway bypasses the host from the datapath, reducing latency, jitter and CPU utilization, so it can be used with the most demanding network workloads that can be installed on the supported VM types.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/virtual-network/create-vm-accelerated-networking-powershell",
    "Command":"az",
    "Args": "vm list --query [*].id",
    "Second_Args": "vm show --ids",
    "Second_To_Second_Args":"--query networkProfile.networkInterfaces[*].id",
    "Third_Args":"network nic show --ids",
    "Third_To_Third_Args":"--query enableAcceleratedNetworking",
    "Problem": "equal",
    "Type": "stdout",
    "Valid":"false"
  },
  "22": {
    "Part" :"Virtual Machines",
    "num_req": "6",
    "Title": "Use Managed Disk Volumes for Virtual Machines\n",
    "Risk_Level":"Medium",
    "Descrip":"Ensure that your Microsoft Azure virtual machines (VMs) are configured to use managed disk volumes for reliable, efficient and simplified disk management. A managed disk is an abstraction of current Standard/Premium storage disk in Azure Storage. Managed disks provide granular access control with RBAC and better reliability for the virtual machines deployed within an Azure Availability Set. The main benefits of using managed disk volumes for VMs are: High availability (HA) - the managed disk volumes have a 99.99% SLA in all Availability Zones (AZs). High fault tolerance - the managed disks provisioned within an Azure Availability Set are spread across multiple storage fault domains to protect against single points of failure. High scalability - can be deployed up to 50,000 managed disk volumes per Azure subscription per region.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/virtual-machines/managed-disks-overview",
    "Command":"az",
    "first":"dataDiskType",
    "second":"osDiskType",
    "Args": "vm list --query [*].id",
    "Second_Args": "vm show --ids",
    "Second_To_Second_Args":"--query storageProfile.{\"osDiskType\":osDisk.managedDisk.id,\"dataDiskType\":dataDisks[*].managedDisk.id}",
    "Valid1": "[]",
    "Valid2": "null",
    "Problem": "equal",
    "Type": "stdout"
  },
  "23": {
    "Part" :"Virtual Machines",
    "num_req": "3",
    "Title": "Server Side Encryption for Disk using CMK\n",
    "Risk_Level":"High",
    "Descrip":"Microsoft Azure provides multiple distinct layers of encryption protection for virtual machine (VM) managed disks. VM managed disks are encrypted with Azure Storage encryption, also known as Server-Side Encryption (SSE), using platform-managed keys (PMK), to protect your data at rest and help you meet your organizational security and compliance commitments. By default, VM managed disk volumes (OS and data disk volumes) use platform-managed encryption keys. However, in order to have a more granular control over your data encryption/decryption process, it is strongly recommended to use your own keys (CMKs) instead of platform-managed keys (PMKs) for disk volume encryption.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/virtual-machines/disk-encryption",
    "Command":"az",
    "Args": "vm list --query [*].resourceGroup",
    "Second_Args": "disk list --resource-group",
    "Second_To_Second_Args":"--query [*].id",
    "Third_Args":"disk show --ids",
    "Third_To_Third_Args":"--query encryption.type",
    "Problem": "equal",
    "Type": "stdout",
    "Valid":"EncryptionAtRestWithPlatformKey"
  },
  "24": {
    "Part" :"Virtual Machines",
    "num_req": "2",
    "Title": "Check for Basic Azure Admin Username\n",
    "Risk_Level":"High",
    "Descrip":"Microsoft Azure provides multiple distinct layers of encryption protection for virtual machine (VM) managed disks. VM managed disks are encrypted with Azure Storage encryption, also known as Server-Side Encryption (SSE), using platform-managed keys (PMK), to protect your data at rest and help you meet your organizational security and compliance commitments. By default, VM managed disk volumes (OS and data disk volumes) use platform-managed encryption keys. However, in order to have a more granular control over your data encryption/decryption process, it is strongly recommended to use your own keys (CMKs) instead of platform-managed keys (PMKs) for disk volume encryption.\n",
    "Reference":"https://learn.microsoft.com/en-us/troubleshoot/azure/virtual-machines/reset-rdp",
    "Command":"az",
    "Args": "vm list --query [*].id",
    "Second_Args": "vm show --ids",
    "Second_To_Second_Args":"--query osProfile.adminUsername",
    "Problem": "equal_basic_username",
    "Type": "stdout",
    "Valid":"azureuser"
  },
  "25": {
    "Part" :"Virtual Machines",
    "num_req": "4",
    "Title": "Enable and Configure Health Monitoring\n",
    "Risk_Level":"Medium",
    "Descrip": "Ensure that Monitor Application Health feature is enabled for all the instances running within your Azure virtual machine scale set. Health monitoring via Application Health extension is required for OS upgrades and automatic instance repairs. The Azure Application Health extension reports on the application health from inside the virtual machine scale set instances. You can configure the health extension to probe on an application endpoint and update the status of the application on that instance. This status is checked by Microsoft Azure to determine whether the instance is eligible for upgrade or repair operations.\n",
    "Reference":"https://azure.microsoft.com/tr-tr/blog/guest-health-feature-in-azure-monitor-for-virtual-machines/",
    "Command":"az",
    "Args": "account list --query [*].id",
    "Len":"--query [].id",
    "Second_Args": "vmss list --subscription",
    "Second_To_Second_Args": "--output json",
    "Third_Args":"vmss show --name",
    "Third_To_Third_Args":"--query virtualMachineProfile.extensionProfile.extensions[*].name --resource-group",
    "Problem": "equal",
    "Type": "two_or_iter_equal",
    "Valid":"ApplicationHealthLinux",
    "Valid2":"healthRepairExtension"
  },
  "26": {
    "Part" :"Virtual Machines",
    "num_req": "2",
    "Title": "Enable Performance Diagnostics for Azure Virtual Machines\n",
    "Risk_Level":"Medium",
    "Descrip": "Ensure that Performance Diagnostics feature is enabled for your Microsoft Azure virtual machine instances in order to help mitigate VM performance issues. Performance Diagnostics installs a VM extension that runs a self-help diagnostics tool named PerfInsights, available for both Windows and Linux operating systems. PerfInsights can collect and analyze diagnostic information such as virtual machine hardware and storage configuration, various log files, OS information, PCI device information, guest OS log files, configuration files, information about running processes, virtual machine instance disk, memory, CPU usage, and networking information. Once this data is properly collected and analyzed, PerfInsights provides an easy-to-read report of findings and recommendations necessary to remediate the performance issues found. You can run performance diagnostics directly from the Azure Portal, where you can also review VM instance performance insights and diagnostics data.n",
    "Reference":"https://learn.microsoft.com/en-us/troubleshoot/azure/virtual-machines/performance-diagnostics",
    "Command":"az",
    "Args": "vm list --query [*].id",
    "Second_Args": "vm extension list --ids",
    "Second_To_Second_Args": "--query [?provisioningState=='Succeeded'].name",
    "Problem": "equal",
    "Type": "one_iter_equal",
    "Valid":"AzurePerformanceDiagnosticsLinux"
  },
  "27": {
    "Part" :"Virtual Machines",
    "num_req": "2",
    "Title": "Enable Virtual Machine Access using Active Directory Authentication\n",
    "Risk_Level":"Medium",
    "Descrip": "Ensure that your Microsoft Azure virtual machines (VMs) are configured to use Azure Active Directory (AAD) credentials for secure SSH/RDP access. Once enabled, you can use your corporate Active Directory credentials to log in to your virtual machines, enforce Multi-Factor Authentication (MFA), or enable access via RBAC roles.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/active-directory/devices/howto-vm-sign-in-azure-ad-linux",
    "Command":"az",
    "Args": "vm list --query [*].id",
    "Second_Args": "vm extension list --ids",
    "Second_To_Second_Args": "--query [*].name",
    "Problem": "equal",
    "Type": "two_or_iter_equal",
    "Valid":"AADLoginForWindows",
    "Valid2":"AADLoginForLinux"
  },
  "28": {
    "Part" :"Virtual Machines",
    "num_req": "2",
    "Title": "Install Endpoint Protection\n",
    "Risk_Level":"High",
    "Descrip": "Ensure that all your Microsoft Azure virtual machines (VMs) have endpoint protection installed in order to help you identify malicious activities.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/defender-for-cloud/endpoint-protection-recommendations-technical?wt.mc_id=defenderforcloud_inproduct_portal_recoremediation&WT.mc_id=Portal-Microsoft_Azure_Security",
    "Command":"az",
    "Args": "vm list --query [*].id",
    "Second_Args": "vm extension list --ids",
    "Second_To_Second_Args": "--query [*].name",
    "Problem": "equal",
    "Type": "two_or_iter_equal",
    "Valid":"EndpointSecurity",
    "Valid2":"EndpointProtection"
  },
  "29": {
    "Part" :"Virtual Machines",
    "num_req": "2",
    "Title": "Install Malware Protection\n",
    "Risk_Level":"High",
    "Descrip": "Ensure that all your Microsoft Azure virtual machines (VMs) have Anti-malware installed in order to help you identify and remove viruses, spyware and other malicious software. The Azure Security Center service monitors the status of anti-malware protection for Azure virtual machines (VMs) and highlights if there is insufficient protection, marking the virtual machines without endpoint protection as vulnerable to malware threats.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/security/fundamentals/antimalware",
    "Command":"az",
    "Args": "vm list --query [*].id",
    "Second_Args": "vm extension list --ids",
    "Second_To_Second_Args": "--query [*].name",
    "Problem": "equal",
    "Type": "one_iter_equal",
    "Valid":"Antimalware"
  },
  "30": {
    "Part" :"Virtual Machines",
    "num_req": "2",
    "Title": "Enable File Security Extensions For VMs\n",
    "Risk_Level":"High",
    "Descrip": "Ensure that all your Microsoft Azure virtual machines (VMs) have File Security extensions. File security extensions will protect your datas against malicious activities. We should protect our systems with File Security extensions.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/virtual-machines/extensions/overview",
    "Command":"az",
    "Args": "vm list --query [*].id",
    "Second_Args": "vm extension list --ids",
    "Second_To_Second_Args": "--query [*].name",
    "Problem": "equal",
    "Type": "one_iter_equal",
    "Valid":"FileSecurity"
  },
  "31": {
    "Part" :"App Service",
    "num_req": "2",
    "Title": "Enable Registration with Azure Active Directory\n",
    "Risk_Level":"Medium",
    "Descrip": "Ensure that registration with Azure Active Directory (AAD) is enabled for Microsoft Azure App Service web applications so that your applications can connect to other Azure cloud services securely without the need of access credentials such as user names and passwords.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app",
    "Command":"az",
    "Args": "webapp list --query [*].id",
    "Second_Args": "webapp identity show --ids",
    "Second_To_Second_Args": "--query principalId",
    "Problem": "equal",
    "Type": "stdout",
    "Valid":""
  },
  "32": {
    "Part" :"App Service",
    "num_req": "2",
    "Title": "Check for TLS Protocol Latest Version\n",
    "Risk_Level":"Medium",
    "Descrip": "Ensure that all Microsoft Azure App Service web applications are using the latest version of TLS encryption protocol to secure the applications traffic over the Internet and comply with the industry standards.\n",
    "Reference":"https://azure.microsoft.com/tr-tr/updates/app-service-and-functions-hosted-apps-can-now-update-tls-versions/",
    "Command":"az",
    "Args": "webapp list --query [*].id",
    "Second_Args": "webapp config show --ids",
    "Second_To_Second_Args": "--query minTlsVersion",
    "Problem": "not_equal",
    "Type": "stdout",
    "Valid":"1.2"
  },
  "33": {
    "Part" :"App Service",
    "num_req": "2",
    "Title": "Disable Plain FTP Deployment\n",
    "Risk_Level":"Medium",
    "Descrip": "Ensure that your Microsoft Azure App Services web applications are not configured to be deployed over plain FTP. Instead the deployment can be disabled over FTP or performed over FTPS. FTPS (Secure FTP) is used to enhance security for your Azure web application as it adds an extra layer of security to the FTP protocol, and helps you to comply with the industry standards and regulations.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/app-service/deploy-ftp?tabs=portal",
    "Command":"az",
    "Args": "webapp list --query [*].id",
    "Second_Args": "webapp config show --ids",
    "Second_To_Second_Args": "--query ftpsState",
    "Problem": "equal",
    "Type": "stdout",
    "Valid":"AllAllowed"
  },
  "34": {
    "Part" :"App Service",
    "num_req": "2",
    "Title": "Disable Remote Debugging\n",
    "Risk_Level":"High",
    "Descrip": "Ensure that your Azure App Services web applications have remote debugging disabled in order to enhance security and protect the applications from unauthorized access. Remote Debugging feature is available for web applications (e.g. ASP.NET, ASP.NET Core, Node.js, Python).\n",
    "Reference":"https://learn.microsoft.com/en-us/rest/api/azurespringapps/deployments/disable-remote-debugging?tabs=HTTP",
    "Command":"az",
    "Args": "webapp list --query [*].id",
    "Second_Args": "webapp config show --ids",
    "Second_To_Second_Args": "--query remoteDebuggingEnabled",
    "Problem": "equal",
    "Type": "stdout",
    "Valid":"true"
  },
  "35": {
    "Part" :"App Service",
    "num_req": "2",
    "Title": "Enable Incoming Client Certificates\n",
    "Risk_Level":"Medium",
    "Descrip": "Ensure that your Microsoft Azure App Service web applications are configured to request an SSL certificate for all incoming requests, for security and compliance purposes. Once the certificate is implemented, only web clients that have this valid SSL certificate will be able to reach your application. By default, incoming client certificates are disabled for Azure App Service web applications.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/app-service/app-service-web-configure-tls-mutual-auth?tabs=azurecli#enable-client-certificates",
    "Command":"az",
    "Args": "webapp list --query [*].id",
    "Second_Args": "webapp config show --ids",
    "Second_To_Second_Args": "--query alwaysOn",
    "Problem": "equal",
    "Type": "stdout",
    "Valid":"false"
  },
  "36": {
    "Part" :"App Service",
    "num_req": "2",
    "Title": "Enable HTTPS-Only Traffic\n",
    "Risk_Level":"Medium",
    "Descrip": "Ensure that your Azure App Service web applications redirect all non-secure HTTP traffic to HTTPS in order to encrypt the communication between applications and web clients. HTTPS uses the Secure Sockets Layer (SSL)/Transport Layer Security (TLS) protocol to provide a secure connection, which is both encrypted and authenticated. This adds an extra layer of security to the HTTP requests made to the web application.\n",
    "Reference":"https://techcommunity.microsoft.com/t5/azure-paas-blog/enable-https-setting-on-azure-app-service-using-azure-policy/ba-p/3286603",
    "Command":"az",
    "Args": "webapp list --query [*].id",
    "Second_Args": "webapp config show --ids",
    "Second_To_Second_Args": "--query httpsOnly",
    "Problem": "equal",
    "Type": "stdout",
    "Valid":"false"
  },
  "37": {
    "Part" :"App Service",
    "num_req": "2",
    "Title": "Enable HTTP/2\n",
    "Risk_Level":"Low",
    "Descrip": "Ensure that your Microsoft Azure App Service web applications are using the latest version of the HTTP protocol (i.e. HTTP/2) in order to make your web applications load faster. HTTP 2.0 represents a major upgrade of the HTTP/1.1 protocol, that has the primary goal of reducing the impact of latency and connection load on web servers by implementing full request and response multiplexing, minimizing protocol overhead via compression of HTTP header fields, and by adding support for HTTP request prioritization and server push.\n",
    "Reference":"https://azure.microsoft.com/en-us/blog/announcing-http-2-support-in-azure-app-service/",
    "Command":"az",
    "Args": "webapp list --query [*].id",
    "Second_Args": "webapp config show --ids",
    "Second_To_Second_Args": "--query http20Enabled",
    "Problem": "equal",
    "Type": "stdout",
    "Valid":"false"
  },
  "38": {
    "Part" :"App Service",
    "num_req": "2",
    "Title": "Enable FTPS-Only Access\n",
    "Risk_Level":"Medium",
    "Descrip": "Ensure that your Azure App Services web applications enforce FTPS-only access to encrypt FTP traffic. FTPS (Secure FTP) is used to enhance security for your Azure web application as it adds an extra layer of security to the FTP protocol, and help you to comply with the industry standards and regulations.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/app-service/deploy-ftp?tabs=portal",
    "Command":"az",
    "Args": "webapp list --query [*].id",
    "Second_Args": "webapp config show --ids",
    "Second_To_Second_Args": "--query ftpsState",
    "Problem": "equal",
    "Type": "stdout",
    "Valid":"AllAllowed"
  },
  "39": {
    "Part" :"App Service",
    "num_req": "2",
    "Title": "Enable App Service Authentication\n",
    "Risk_Level":"Medium",
    "Descrip": "Ensure that App Service Authentication feature is enabled for Microsoft Azure App Service to add an extra layer of security to the authentication process implemented by your web applications.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/app-service/overview-authentication-authorization",
    "Command":"az",
    "Args": "webapp list --query [*].id",
    "Second_Args": "webapp auth show --ids",
    "Second_To_Second_Args": "--query enabled",
    "Problem": "equal",
    "Type": "stdout",
    "Valid":"false"
  },
  "40": {
    "Part" :"App Service",
    "num_req": "5",
    "Title": "Enable Automated Backups\n",
    "Risk_Level":"High",
    "Descrip": "Ensure that Backup and Restore feature is enabled and configured to create automated (scheduled) backups for your Microsoft Azure App Services applications.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/app-service/manage-backup?tabs=portal",
    "Command":"az",
    "Len":"--query [].availabilityState",
    "Args":"webapp list --output json",
    "Second_Args": "webapp config backup show --webapp-name",
    "Second_To_Second_Args":"--resource-group ",
    "Problem": "equal",
    "Type": "error",
    "Valid": "ERROR: Backup configuration not found"
  },
  "41": {
    "Part" :"App Service",
    "num_req": "2",
    "Title": "Enable Always On\n",
    "Risk_Level":"Medium",
    "Descrip": "Ensure that your Microsoft Azure App Services web applications have Always On feature enabled in order to prevent applications from being idled out due to inactivity. Always On keeps your websites/web applications loaded even when there's no traffic.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/app-service/configure-common?tabs=portal",
    "Command":"az",
    "Args":"webapp list --query [*].id",
    "Second_Args": "webapp config show --ids",
    "Second_To_Second_Args":"--query alwaysOn",
    "Problem": "equal",
    "Type": "stdout",
    "Valid": "false"
  },
  "42": {
    "Part" :"AKS",
    "num_req": "5",
    "Title": "Enable Azure Secrets Provider for Azure Kubernetes Service\n",
    "Risk_Level":"Medium",
    "Descrip": "Ensure that Secret Provider feature is enabled and configured to store secrets for your Microsoft Azure Kubernetes applications.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/aks/csi-secrets-store-driver",
    "Command":"az",
    "Len":"--query [*].id",
    "Args":"aks list --output json",
    "Second_Args": "aks show --name",
    "Second_To_Second_Args":"--query addonProfiles.azureKeyvaultSecretsProvider.enabled --resource-group ",
    "Problem": "not_equal",
    "Type": "stdout",
    "Valid": "true"
  },
  "43": {
    "Part" :"AKS",
    "num_req": "5",
    "Title": "Enable OMS Agent for Azure Kubernetes Service\n",
    "Risk_Level":"Medium",
    "Descrip": "Ensure that OMS Agent feature is enabled and configured to monitor your resources for your Microsoft Azure Kubernetes applications.\n",
    "Reference":"https://learn.microsoft.com/en-us/azure/azure-monitor/containers/container-insights-enable-aks?tabs=azure-cli",
    "Command":"az",
    "Len":"--query [*].id",
    "Args":"aks list --output json",
    "Second_Args": "aks show --name",
    "Second_To_Second_Args":"--query addonProfiles.omsAgent.enabled --resource-group ",
    "Problem": "not_equal",
    "Type": "stdout",
    "Valid": "true"
  },
  "44": {
      "Part" :"AKS",
      "num_req": "5",
      "Title": "Enable Auto Scaling for Azure Kubernetes Service\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that Auto Scaling feature is enabled and configured to scale your resources for your Microsoft Azure Kubernetes applications. It is a feature in which the cluster is capable of increasing the number of nodes as the demand for service response increases and decrease the number of nodes as the requirement decreases.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/aks/cluster-autoscaler",
      "Command":"az",
      "Len":"--query [*].id",
      "Args":"aks list --output json",
      "Second_Args": "aks show --name",
      "Second_To_Second_Args":"--query agentPoolProfiles[*].enableAutoScaling --resource-group ",
      "Problem": "not_equal",
      "Type": "stdout",
      "Valid": "true"
    },
  "45": {
      "Part" :"AKS",
      "num_req": "5",
      "Title": "Enable Encryption At Host\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that Encryption feature is enabled and configured to encrypt your resources at host for your Microsoft Azure Kubernetes applications.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/virtual-machines/disks-enable-host-based-encryption-portal?tabs=azure-powershell",
      "Command":"az",
      "Len":"--query [*].id",
      "Args":"aks list --output json",
      "Second_Args": "aks show --name",
      "Second_To_Second_Args":"--query agentPoolProfiles[*].enableEncryptionAtHost --resource-group ",
      "Problem": "not_equal",
      "Type": "stdout",
      "Valid": "true"
    },
    "46": {
      "Part" :"AKS",
      "num_req": "5",
      "Title": "Enable Federal Information Process Standard (FIPS) for Azure Kubernetes Service\n",
      "Risk_Level":"Low",
      "Descrip": "Ensure that FIPS feature is enabled for your Microsoft Azure Kubernetes applications. The Federal Information Processing Standard (FIPS) 140-2 is a US government standard that defines minimum security requirements for cryptographic modules in information technology products and systems. \n",
      "Reference":"https://learn.microsoft.com/en-us/azure/aks/enable-fips-nodes",
      "Command":"az",
      "Len":"--query [*].id",
      "Args":"aks list --output json",
      "Second_Args": "aks show --name",
      "Second_To_Second_Args":"--query agentPoolProfiles[*].enableFips --resource-group ",
      "Problem": "not_equal",
      "Type": "stdout",
      "Valid": "true"
    },
    "47": {
      "Part" :"AKS",
      "num_req": "5",
      "Title": "Check for Nodes with Public IP Addresses\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that Kubernetes nodes don't have public ip addresses. It can be dangerous for systems.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/batch/simplified-node-communication-pool-no-public-ip",
      "Command":"az",
      "Len":"--query [*].id",
      "Args":"aks list --output json",
      "Second_Args": "aks show --name",
      "Second_To_Second_Args":"--query agentPoolProfiles[*].enableNodePublicIp --resource-group ",
      "Problem": "equal",
      "Type": "stdout",
      "Valid": "true"
    },
    "48": {
      "Part" :"AKS",
      "num_req": "5",
      "Title": "Enable Kubernetes Role-Based Access Control\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that Kubernetes Role-Based Access Control (RBAC) is enabled for all Azure Kubernetes Service (AKS) clusters in order to achieve fine-grained control over AKS cluster resources. The Kubernetes Role-Based Access Control (RBAC) represents an efficient method of regulating access to Azure Kubernetes Service resources based on the roles of individual users or groups within an organization.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/aks/azure-ad-rbac?tabs=portal",
      "Command":"az",
      "Len":"--query [*].id",
      "Args":"aks list --output json",
      "Second_Args": "aks show --name",
      "Second_To_Second_Args":"--query enableRbac --resource-group ",
      "Problem": "not_equal",
      "Type": "stdout",
      "Valid": "true"
    },
    "49": {
      "Part" :"AKS",
      "num_req": "5",
      "Title": "Enable Defender for Azure Kubernetes Service\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that Defender is enabled for all Azure Kubernetes Service (AKS) clusters. Defender for Cloud provides real-time threat protection for your Azure Kubernetes Service (AKS) containerized environments and generates alerts for suspicious activities. You can use this information to quickly remediate security issues and improve the security of your containers.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-containers-enable?tabs=aks-deploy-portal%2Ck8s-deploy-asc%2Ck8s-verify-asc%2Ck8s-remove-arc%2Caks-removeprofile-api&pivots=defender-for-container-aks",
      "Command":"az",
      "Len":"--query [*].id",
      "Args":"aks list --output json",
      "Second_Args": "aks show --name",
      "Second_To_Second_Args":"--query securityProfile.defender --resource-group ",
      "Problem": "not_equal",
      "Type": "stdout",
      "Valid": "true"
    },
    "50": {
      "Part" :"AKS",
      "num_req": "5",
      "Title": "Check for Kubernetes Services with Public Network Access\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that Kubernetes services have public network access turned off. It is not good for Kubernetes services to have public network access.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/aks/concepts-network",
      "Command":"az",
      "Len":"--query [*].id",
      "Args":"aks list --output json",
      "Second_Args": "aks show --name",
      "Second_To_Second_Args":"--query publicNetworkAccess --resource-group ",
      "Problem": "not_equal",
      "Type": "stdout",
      "Valid": "true"
    }, 
    "51": {
      "Part" :"Logic App",
      "num_req": "1",
      "Title": "Enable Logic Apps Client Certificates\n",
      "Risk_Level":"Low",
      "Descrip": "By enabling client certificates, you can ensure that the communication between the Logic Apps and the client is secure and protected. This rule helps to ensure that only authorized clients are able to access the Logic Apps, and that the data transmitted between the client and the Logic Apps is encrypted and secured.Enabling client certificates involves configuring your Azure environment to require the client to provide a valid certificate during the SSL handshake process. This certificate is then used to verify the identity of the client, which helps to prevent unauthorized access to the Logic Apps. \n",
      "Reference":"https://learn.microsoft.com/en-us/azure/logic-apps/logic-apps-enterprise-integration-certificates",
      "Args":"YXogbG9naWNhcHAgbGlzdCAtLXF1ZXJ5ICJbP2NsaWVudENlcnRFbmFibGVkPT1cYGZhbHNlXGBdLmlkIiA=",
      "Problem": "not_equal",
      "Type": "print_iter",
      "Valid": ""
    }, 
    "52": {
      "Part" :"Logic App",
      "num_req": "1",
      "Title": "Check your SSL State\n",
      "Risk_Level":"Medium",
      "Descrip": "To enable client certificates, the SSL handshake process needs to be configured to require the client to provide a valid certificate. The certificate is then used to verify the identity of the client, which prevents unauthorized access to the Logic Apps. This rule provides an extra layer of security for your Logic Apps and helps to protect sensitive data and information from unauthorized access. To ensure that the SSL state is correct, it is necessary to check the certificate chain to make sure it is valid and that there are no errors or warnings related to the certificate. This rule helps to prevent potential security vulnerabilities, and ensures that communication between clients and the server is secure and protected.\n",
      "Reference":"https://learn.microsoft.com/tr-tr/azure/logic-apps/logic-apps-securing-a-logic-app?tabs=azure-portal",
      "Args":"YXogbG9naWNhcHAgbGlzdCAtLXF1ZXJ5ICJbKl0uaG9zdE5hbWVTc2xTdGF0ZXNbP3NzbFN0YXRlPT0nRGlzYWJsZWQnXS5uYW1lIg==",
      "Problem": "not_equal",
      "Type": "print_iter",
      "Valid": ""
    }, 
    "53": {
      "Part" :"Logic App",
      "num_req": "1",
      "Title": "Ensure that Your Traffic is Only Using HTTPS\n",
      "Risk_Level":"Medium",
      "Descrip": "The rule that involves ensuring that your traffic is only using HTTPS is an important security measure for your Azure environment. By using HTTPS (Hypertext Transfer Protocol Secure), you can ensure that any sensitive data or information transmitted between the client and the server is encrypted and secured. This rule involves configuring your Azure environment to only allow HTTPS traffic. HTTP (Hypertext Transfer Protocol) traffic is not secure, and sensitive data can be intercepted and compromised by attackers. By only allowing HTTPS traffic, you can prevent potential security vulnerabilities and ensure that communication between the client and server is secure and protected.\n",
      "Reference":"https://learn.microsoft.com/tr-tr/azure/logic-apps/logic-apps-securing-a-logic-app?tabs=azure-portal",
      "Args":"YXogbG9naWNhcHAgbGlzdCAtLXF1ZXJ5ICJbP2h0dHBzT25seSE9XGB0cnVlXGBdLmlkIg==",
      "Problem": "not_equal",
      "Type": "print_iter",
      "Valid": ""
    }, 
    "54": {
      "Part" :"Logic App",
      "num_req": "1",
      "Title": "Check for Logic App with Public Network Access\n",
      "Risk_Level":"Medium",
      "Descrip": "The rule involves checking for Logic Apps that have public network access enabled in your Azure environment. When public network access is enabled, the Logic App can be accessed from any internet-connected device, making it vulnerable to potential security breaches. To ensure the security of your Azure environment, it is important to check and disable public network access for Logic Apps that don't require it. This can be done by modifying the Logic App's configuration settings and disabling the'Public endpoint' option. By checking for Logic Apps with public network access, you can prevent unauthorized access and potential security breaches, and ensure that your Azure environment is secure and protected.\n",
      "Reference":"https://learn.microsoft.com/tr-tr/azure/logic-apps/logic-apps-securing-a-logic-app?tabs=azure-portal",
      "Args":"YXogbG9naWNhcHAgbGlzdCAtLXF1ZXJ5ICJbP3B1YmxpY05ldHdvcmtBY2Nlc3M9PSdFbmFibGVkJ10uaWQi",
      "Problem": "not_equal",
      "Type": "print_iter",
      "Valid": ""
    }, 
    "55": {
      "Part" :"Function App",
      "num_req": "1",
      "Title": "Enable Function Apps Client Certificates\n",
      "Risk_Level":"Low",
      "Descrip": "This rule involves configuring secure client authentication for your Function Apps in Azure. By enabling client certificates for Function Apps, you can ensure that only authorized clients are able to access and interact with your Function Apps. Client certificates are a type of digital certificate that provides secure client authentication. By requiring a client certificate to access a Function App, you can ensure that only clients with a valid and authorized certificate are able to interact with the app. This can help to prevent potential security breaches and unauthorized access to your sensitive data. To implement this rule, you may need to modify the configuration settings of your Function App and enable client certificates. This involves generating and configuring a client certificate for your app, and setting up the app to require a valid certificate for authentication.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/logic-apps/logic-apps-enterprise-integration-certificates",
      "Args":"YXogZnVuY3Rpb25hcHAgbGlzdCAtLXF1ZXJ5ICJbP2NsaWVudENlcnRFbmFibGVkPT1cYGZhbHNlXGBdLmlkIiA=",
      "Problem": "not_equal",
      "Type": "print_iter",
      "Valid": ""
    }, 
    "56": {
      "Part" :"Function App",
      "num_req": "1",
      "Title": "Check your SSL State\n",
      "Risk_Level":"Medium",
      "Descrip": "This rule involves checking the SSL state for your Function Apps in Azure to ensure the security of your applications. SSL (Secure Sockets Layer) is a protocol that encrypts communication between a client and a server, providing a secure and private connection. By using SSL, you can help protect your sensitive data and prevent unauthorized access to your applications. To implement this rule, you can check the SSL state of your Function Apps by reviewing the SSL binding settings in the Azure portal. You should ensure that SSL is enabled and that all traffic is being directed over HTTPS. You should also check that the SSL certificate being used is valid and up-to-date. An expired or invalid SSL certificate can leave your application vulnerable to potential security breaches and attacks.\n",
      "Reference":"https://learn.microsoft.com/tr-tr/azure/logic-apps/logic-apps-securing-a-logic-app?tabs=azure-portal",
      "Args":"YXogZnVuY3Rpb25hcHAgbGlzdCAtLXF1ZXJ5ICJbKl0uaG9zdE5hbWVTc2xTdGF0ZXNbP3NzbFN0YXRlPT0nRGlzYWJsZWQnXS5uYW1lIg==",
      "Problem": "not_equal",
      "Type": "print_iter",
      "Valid": ""
    }, 
    "57": {
      "Part" :"Function App",
      "num_req": "1",
      "Title": "Ensure that Your Traffic is Only Using HTTPS\n",
      "Risk_Level":"Medium",
      "Descrip": "This rule involves ensuring that all traffic to your Function Apps in Azure is only using HTTPS. HTTPS (Hypertext Transfer Protocol Secure) is a protocol that encrypts communication between a client and a server, providing a secure and private connection. By using HTTPS, you can help protect your sensitive data and prevent unauthorized access to your applications. To implement this rule, you should configure your Function Apps to only allow traffic over HTTPS. This can be done by enabling HTTPS-only access for your app and disabling HTTP access. You should also ensure that any custom domains or subdomains you are using are configured to use HTTPS. By ensuring that all traffic to your Function Apps is only using HTTPS, you can help protect your applications and data from potential security breaches and attacks.\n",
      "Reference":"https://learn.microsoft.com/tr-tr/azure/logic-apps/logic-apps-securing-a-logic-app?tabs=azure-portal",
      "Args":"YXogZnVuY3Rpb25hcHAgbGlzdCAtLXF1ZXJ5ICJbP2h0dHBzT25seSE9XGB0cnVlXGBdLmlkIg==",
      "Problem": "not_equal",
      "Type": "print_iter",
      "Valid": ""
    }, 
    "58": {
      "Part" :"Function App",
      "num_req": "1",
      "Title": "Check for Function App with Public Network Access\n",
      "Risk_Level":"Medium",
      "Descrip": "This rule involves checking for Function Apps in Azure that have public network access, which can potentially expose your application to security risks. By default, Function Apps are configured to only allow access from within the Azure network. However, in some cases, you may have configured your Function App to have public network access, such as by enabling access from specific IP addresses or by allowing all networks. To implement this rule, you should review the network settings for your Function Apps to ensure that public network access is not enabled. You can do this by reviewing the network security group (NSG) associated with your app, as well as any virtual network (VNet) configurations. If you find that your Function App has public network access enabled, you should take steps to restrict access to only trusted networks or IP addresses. This can help to prevent potential security breaches and unauthorized access to your sensitive data.\n",
      "Reference":"https://learn.microsoft.com/tr-tr/azure/logic-apps/logic-apps-securing-a-logic-app?tabs=azure-portal",
      "Args":"YXogZnVuY3Rpb25hcHAgbGlzdCAtLXF1ZXJ5ICJbP3B1YmxpY05ldHdvcmtBY2Nlc3M9PSdFbmFibGVkJ10uaWQi",
      "Problem": "not_equal",
      "Type": "print_iter",
      "Valid": ""
    }, 
    "59": {
      "Part" :"Container App",
      "num_req": "1",
      "Title": "Disable Insecure Container App Ingress\n",
      "Risk_Level":"Medium",
      "Descrip": "This rule involves disabling insecure container app ingress in Azure to help ensure the security of your containerized applications. Container app ingress allows traffic to be directed to your containerized applications. However, if ingress is not configured securely, it can leave your applications vulnerable to potential security breaches and attacks. To implement this rule, you should review the ingress settings for your container app and disable any insecure ingress options. This can include disabling HTTP ingress or disallowing traffic from untrusted networks or sources. You should also ensure that any ingress traffic is being directed over HTTPS, which provides encryption and helps protect your sensitive data from unauthorized access.\n",
      "Reference":"https://azure.github.io/PSRule.Rules.Azure/en/rules/Azure.ContainerApp.Insecure/",
      "Args":"YXogY29udGFpbmVyYXBwIGxpc3QgLS1xdWVyeSAiWz9wcm9wZXJ0aWVzLmNvbmZpZ3VyYXRpb24uaW5ncmVzcy5hbGxvd0luc2VjdXJlIT0nZmFsc2UnXS5uYW1lIg==",
      "Problem": "not_equal",
      "Type": "print_iter",
      "Valid": ""
    }, 
    "60": {
      "Part" :"Container App",
      "num_req": "1",
      "Title": "Ensure that Your Traffic is Only Using HTTP2\n",
      "Risk_Level":"Medium",
      "Descrip": "This rule involves ensuring that all traffic to your Azure container apps is only using HTTP2. HTTP2 is the next version of the HTTP protocol, which provides improved performance and security over the previous version, HTTP/1.1. By using HTTP2, you can help ensure that your container apps are faster and more secure. To implement this rule, you should configure your Azure container apps to only use HTTP2. This can be done by enabling HTTP2 on your web server or load balancer, and disabling HTTP/1.1. You should also ensure that any third-party services or APIs your container app is using are compatible with HTTP2.\n",
      "Reference":"https://learn.microsoft.com/tr-tr/azure/logic-apps/logic-apps-securing-a-logic-app?tabs=azure-portal",
      "Args":"YXogY29udGFpbmVyYXBwIGxpc3QgLS1xdWVyeSAiWz9wcm9wZXJ0aWVzLmNvbmZpZ3VyYXRpb24uaW5ncmVzcy50cmFuc3BvcnQhPSdIdHRwMiddLmlkIiAg",
      "Problem": "not_equal",
      "Type": "print_iter",
      "Valid": ""
    }
}
