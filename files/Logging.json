{
    "1": {
      "Part" :"Activity Log",
      "num_req": "6",
      "Title": "Create Alert for 'Create Policy Assignment' Events\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that an Azure activity log alert is used to detect 'Create Policy Assignment' events within your Microsoft Azure cloud account. Activity log alerts get activated when a new activity log event that matches the condition specified in the alert occurs. In this case, the condition used is 'Whenever the Policy Activity Log 'Create policy assignment (policyAssignments)' has 'any' level, with 'any' status and event is initiated by 'any''.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-create-new-alert-rule?tabs=metric",
      "Command":"az",
      "main":"allOf",
      "first":"equals",
      "second":"field",
      "number":"1",
      "Args": "monitor activity-log alert list  --query [?(enabled==`true`)].id",
      "Second_Args": "monitor activity-log alert show --ids",
      "Second_To_Second_Args": "--query condition",
      "Valid1": "Microsoft.Authorization/policyAssignments/write",
      "Valid2": "operationName",
      "Problem": "equal_is_not_equal",
      "Type": "stdout"
    },
    "2": {
      "Part" :"Activity Log",
      "num_req": "6",
      "Title": "Create Alert for 'Create or Update Load Balancer' Events\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that an Azure activity log alert is fired whenever 'Create or Update Load Balancer' events are triggered within your Microsoft Azure cloud account. Activity log alerts get triggered when a new activity log event that matches the condition specified in the alert configuration occurs. For this conformity rule, the matched condition is 'Whenever the Activity Log has an event with Category='Administrative', Signal name='Create or Update Load Balancer (loadBalancers)''.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-create-new-alert-rule?tabs=metric",
      "Command":"az",
      "main":"allOf",
      "first":"equals",
      "second":"field",
      "number":"1",
      "Args": "monitor activity-log alert list  --query [?(enabled==`true`)].id",
      "Second_Args": "monitor activity-log alert show --ids",
      "Second_To_Second_Args": "--query condition",
      "Valid1": "Microsoft.Network/loadBalancers/write",
      "Valid2": "operationName",
      "Problem": "equal_is_not_equal",
      "Type": "stdout"
    },
    "3": {
      "Part" :"Activity Log",
      "num_req": "6",
      "Title": "Create Alert for 'Create or Update Public IP Address' Events\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that activity log alerts are used to detect 'Create or Update Public IP Address' events within your Microsoft Azure cloud account. An activity log alert gets activated when a new activity log event that matches the condition specified in the alert occurs.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-create-new-alert-rule?tabs=metric",
      "Command":"az",
      "main":"allOf",
      "first":"equals",
      "second":"field",
      "number":"1",
      "Args": "monitor activity-log alert list  --query [?(enabled==`true`)].id",
      "Second_Args": "monitor activity-log alert show --ids",
      "Second_To_Second_Args": "--query condition",
      "Valid1": "Microsoft.Network/publicIPAddresses/write",
      "Valid2": "operationName",
      "Problem": "equal_is_not_equal",
      "Type": "stdout"
    },
    "4": {
      "Part" :"Activity Log",
      "num_req": "6",
      "Title": "Create Alert for 'Create or Update Security Solution' Events\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that an Azure activity log alert is fired whenever Create or Update Security Solution events are triggered in your Microsoft Azure cloud account. Activity log alerts get activated when a new activity log event that matches the condition specified in the alert occurs. In this case, the alert condition that this conformity rule searches for is 'Whenever the Security Activity Log Create or Update Security Solutions (Microsoft.Security/securitySolutions) has any level, with any status and event is initiated by any.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-create-new-alert-rule?tabs=metric",
      "Command":"az",
      "main":"allOf",
      "first":"equals",
      "second":"field",
      "number":"1",
      "Args": "monitor activity-log alert list  --query [?(enabled==`true`)].id",
      "Second_Args": "monitor activity-log alert show --ids",
      "Second_To_Second_Args": "--query condition",
      "Valid1": "Microsoft.Security/securitySolutions/write",
      "Valid2": "operationName",
      "Problem": "equal_is_not_equal",
      "Type": "stdout"
    },
    "5": {
      "Part" :"Activity Log",
      "num_req": "6",
      "Title": "Create Alert for 'Create or Update Virtual Machine' Events\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that an Azure activity log alert is fired whenever Create Virtual Machine or Update Virtual Machine events are triggered in your Microsoft Azure cloud account. Activity log alerts get triggered when a new activity log event that matches the condition specified in the alert configuration occurs. For this conformity rule, the matched condition is `Whenever the Administrative Activity Log Create or Update Virtual Machine (Microsoft.Compute/virtualMachines) has any Event level, with any Status and Event initiated by any'.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-create-new-alert-rule?tabs=metric",
      "Command":"az",
      "main":"allOf",
      "first":"equals",
      "second":"field",
      "number":"1",
      "Args": "monitor activity-log alert list  --query [?(enabled==`true`)].id",
      "Second_Args": "monitor activity-log alert show --ids",
      "Second_To_Second_Args": "--query condition",
      "Valid1": "Microsoft.Compute/virtualMachines/write",
      "Valid2": "operationName",
      "Problem": "equal_is_not_equal",
      "Type": "stdout"
    },
    "6": {
      "Part" :"Activity Log",
      "num_req": "6",
      "Title": "Create Alert for 'Create, Update or Delete SQL Server Firewall Rule' Events\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that an Azure activity log alert is fired whenever “Create”, “Update” or “Delete SQL Server Firewall Rule” events are triggered in your Microsoft Azure cloud account. Activity log alerts get activated when a new activity log event that matches the condition specified in the alert occurs. In this case, the condition required for the alert is 'Whenever the Administrative Activity Log Create/Update server firewall rule (Microsoft.Sql/servers/firewallRules) has any level, with any status and event is initiated by any'.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-create-new-alert-rule?tabs=metric",
      "Command":"az",
      "main":"allOf",
      "first":"equals",
      "second":"field",
      "number":"1",
      "Args": "monitor activity-log alert list  --query [?(enabled==`true`)].id",
      "Second_Args": "monitor activity-log alert show --ids",
      "Second_To_Second_Args": "--query condition",
      "Valid1": "Microsoft.Sql/servers/firewallRules/write",
      "Valid2": "operationName",
      "Problem": "equal_is_not_equal",
      "Type": "stdout"
    },
    "7": {
      "Part" :"Activity Log",
      "num_req": "6",
      "Title": "Create Alert for 'Create/Update Azure SQL Database' Events\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that an Azure activity log alert is fired whenever Create/Update Azure SQL Database events are triggered within your Microsoft Azure cloud account. Activity log alerts get triggered when a new activity log event that matches the condition specified in the alert configuration occurs. For this conformity rule, the matched condition is Whenever the Activity Log has an event with Category='Administrative', Signal name='Create/Update Azure SQL Database (servers/databases)'.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-create-new-alert-rule?tabs=metric",
      "Command":"az",
      "main":"allOf",
      "first":"equals",
      "second":"field",
      "number":"1",
      "Args": "monitor activity-log alert list  --query [?(enabled==`true`)].id",
      "Second_Args": "monitor activity-log alert show --ids",
      "Second_To_Second_Args": "--query condition",
      "Valid1": "Microsoft.Sql/servers/databases/write",
      "Valid2": "operationName",
      "Problem": "equal_is_not_equal",
      "Type": "stdout"
    },
    "8": {
      "Part" :"Activity Log",
      "num_req": "6",
      "Title": "Create Alert for 'Create/Update Network Security Group' Events\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that an Azure activity log alert is fired whenever Create or Update Network Security Group events are triggered within your Microsoft Azure cloud account. Activity log alerts get activated when a new activity log event that matches the condition specified in the alert occurs. In this case, the alert condition that we search for is 'Whenever the Administrative Activity Log Create or Update Network Security Group (Microsoft.Network/networkSecurityGroups) has any level, with any status and event is initiated by any'.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-create-new-alert-rule?tabs=metric",
      "Command":"az",
      "main":"allOf",
      "first":"equals",
      "second":"field",
      "number":"1",
      "Args": "monitor activity-log alert list  --query [?(enabled==`true`)].id",
      "Second_Args": "monitor activity-log alert show --ids",
      "Second_To_Second_Args": "--query condition",
      "Valid1": "Microsoft.Network/networkSecurityGroups/write",
      "Valid2": "operationName",
      "Problem": "equal_is_not_equal",
      "Type": "stdout"
    },
    "9": {
      "Part" :"Activity Log",
      "num_req": "6",
      "Title": "Create Alert for 'Create/Update Storage Account' Events\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that an Azure activity log alert is fired whenever Create/Update Storage Account events are triggered in your Microsoft Azure cloud account. Activity log alerts get triggered when a new activity log event that matches the condition specified in the alert configuration occurs. For this conformity rule, the matched condition is `Whenever the Activity Log has an event with Category=Administrative, Signal name=Create/Update Storage Account (Microsoft.Storage/storageAccounts)`.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-create-new-alert-rule?tabs=metric",
      "Command":"az",
      "main":"allOf",
      "first":"equals",
      "second":"field",
      "number":"1",
      "Args": "monitor activity-log alert list  --query [?(enabled==`true`)].id",
      "Second_Args": "monitor activity-log alert show --ids",
      "Second_To_Second_Args": "--query condition",
      "Valid1": "Microsoft.Storage/storageAccounts/write",
      "Valid2": "operationName",
      "Problem": "equal_is_not_equal",
      "Type": "stdout"
    },
    "10": {
      "Part" :"Activity Log",
      "num_req": "6",
      "Title": "Create Alert for 'Deallocate Virtual Machine' Events\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that an Azure activity log alert is fired whenever Deallocate Virtual Machine events are triggered within your Microsoft Azure cloud account. An Azure activity log alert is triggered when a new activity log event that matches the condition specified in the alert configuration occurs. For this conformity rule, the matched condition is `Whenever the Administrative Activity Log Deallocate Virtual Machine (Microsoft.Compute/virtualMachines) has any Event level, with any Status and Event initiated by any`.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-create-new-alert-rule?tabs=metric",
      "Command":"az",
      "main":"allOf",
      "first":"equals",
      "second":"field",
      "number":"1",
      "Args": "monitor activity-log alert list  --query [?(enabled==`true`)].id",
      "Second_Args": "monitor activity-log alert show --ids",
      "Second_To_Second_Args": "--query condition",
      "Valid1": "Microsoft.Compute/virtualMachines/deallocate/action",
      "Valid2": "operationName",
      "Problem": "equal_is_not_equal",
      "Type": "stdout"
    },
    "11": {
      "Part" :"Activity Log",
      "num_req": "6",
      "Title": "Create Alert for 'Delete Azure SQL Database' Events\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that a Microsoft Azure activity log alert is fired whenever a Delete Azure SQL Database event is triggered within your cloud account. An Azure activity log alert fires each time the action event that matches the condition specified in the alert configuration is triggered. The alert condition that this conformity rule searches for is Whenever the Activity Log has an event with Category='Administrative', Signal name='Delete Azure SQL Database (Microsoft.Sql/servers/databases)'.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-create-new-alert-rule?tabs=metric",
      "Command":"az",
      "main":"allOf",
      "first":"equals",
      "second":"field",
      "number":"1",
      "Args": "monitor activity-log alert list  --query [?(enabled==`true`)].id",
      "Second_Args": "monitor activity-log alert show --ids",
      "Second_To_Second_Args": "--query condition",
      "Valid1": "Microsoft.Sql/servers/databases/delete",
      "Valid2": "operationName",
      "Problem": "equal_is_not_equal",
      "Type": "stdout"
    },
    "12": {
      "Part" :"Activity Log",
      "num_req": "6",
      "Title": "Create Alert for 'Delete Key Vault' Events\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that a Microsoft Azure activity log alert is fired whenever a Delete Key Vault event is triggered inside your Azure cloud account. An activity log alert fires each time the action event that matches the condition specified in the alert configuration is triggered. The alert condition that this conformity rule checks for is Whenever the Activity Log has an event with Category='Administrative', Signal name='Delete Key Vault (vaults)'.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-create-new-alert-rule?tabs=metric",
      "Command":"az",
      "main":"allOf",
      "first":"equals",
      "second":"field",
      "number":"1",
      "Args": "monitor activity-log alert list  --query [?(enabled==`true`)].id",
      "Second_Args": "monitor activity-log alert show --ids",
      "Second_To_Second_Args": "--query condition",
      "Valid1": "Microsoft.KeyVault/vaults/delete",
      "Valid2": "operationName",
      "Problem": "equal_is_not_equal",
      "Type": "stdout"
    },
    "13": {
      "Part" :"Activity Log",
      "num_req": "6",
      "Title": "Create Alert for 'Delete Load Balancer' Events\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that a Microsoft Azure activity log alert is fired whenever a Delete Load Balancer event is triggered within your cloud account. An Azure activity log alert fires each time the action event that matches the condition specified in the alert configuration is triggered. The alert condition that this conformity rule searches for is Whenever the Activity Log has an event with Category='Administrative', Signal name='Delete Load Balancer (loadBalancers)'.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-create-new-alert-rule?tabs=metric",
      "Command":"az",
      "main":"allOf",
      "first":"equals",
      "second":"field",
      "number":"1",
      "Args": "monitor activity-log alert list  --query [?(enabled==`true`)].id",
      "Second_Args": "monitor activity-log alert show --ids",
      "Second_To_Second_Args": "--query condition",
      "Valid1": "Microsoft.Network/loadBalancers/delete",
      "Valid2": "operationName",
      "Problem": "equal_is_not_equal",
      "Type": "stdout"
    },
    "14": {
      "Part" :"Activity Log",
      "num_req": "6",
      "Title": "Create Alert for 'Delete Network Security Group Rule' Events\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that an Azure activity log alert is used to detect Delete Network Security Group Rule events in your Microsoft Azure cloud account. Activity log alerts get activated when a new activity log event that matches the condition specified in the alert occurs. In this case the condition used is 'Whenever the Administrative Activity Log Delete Security Rule (networkSecurityGroups/securityRules) has any level with any status and event is initiated by any'.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-create-new-alert-rule?tabs=metric",
      "Command":"az",
      "main":"allOf",
      "first":"equals",
      "second":"field",
      "number":"1",
      "Args": "monitor activity-log alert list  --query [?(enabled==`true`)].id",
      "Second_Args": "monitor activity-log alert show --ids",
      "Second_To_Second_Args": "--query condition",
      "Valid1": "Microsoft.Network/networkSecurityGroups/securityRules/delete",
      "Valid2": "operationName",
      "Problem": "equal_is_not_equal",
      "Type": "stdout"
    },
    "15": {
      "Part" :"Activity Log",
      "num_req": "6",
      "Title": "Create Alert for 'Delete Network Security Group' Events\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that an Azure activity log alert is used to detect Delete Network Security Group events in your Microsoft Azure cloud account. Activity log alerts get activated when a new activity log event that matches the condition specified in the alert occurs. In this case the condition used is 'Whenever the Administrative Activity Log Delete Network Security Group (networkSecurityGroups) has any level, with any status and event is initiated by any'.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-create-new-alert-rule?tabs=metric",
      "Command":"az",
      "main":"allOf",
      "first":"equals",
      "second":"field",
      "number":"1",
      "Args": "monitor activity-log alert list  --query [?(enabled==`true`)].id",
      "Second_Args": "monitor activity-log alert show --ids",
      "Second_To_Second_Args": "--query condition",
      "Valid1": "Microsoft.Network/networkSecurityGroups/delete",
      "Valid2": "operationName",
      "Problem": "equal_is_not_equal",
      "Type": "stdout"
    },
    "16": {
      "Part" :"Activity Log",
      "num_req": "6",
      "Title": "Create Alert for 'Delete Policy Assignment' Events\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that an Azure activity log alert is used to detect Delete Policy Assignment events within your Microsoft Azure cloud account. Activity log alerts get activated when a new activity log event that matches the condition specified in the alert occurs. In this case, the condition used is 'Whenever the Policy Activity Log Delete policy assignment (policyAssignments) has any level, with any status and event is initiated by any'.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-create-new-alert-rule?tabs=metric",
      "Command":"az",
      "main":"allOf",
      "first":"equals",
      "second":"field",
      "number":"1",
      "Args": "monitor activity-log alert list  --query [?(enabled==`true`)].id",
      "Second_Args": "monitor activity-log alert show --ids",
      "Second_To_Second_Args": "--query condition",
      "Valid1": "Microsoft.Authorization/policyAssignments/delete",
      "Valid2": "operationName",
      "Problem": "equal_is_not_equal",
      "Type": "stdout"
    },
    "17": {
      "Part" :"Activity Log",
      "num_req": "6",
      "Title": "Create Alert for 'Delete Public IP Address' Events\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that activity log alerts are used to detect Delete Public IP Address events within your Microsoft Azure cloud account. An activity log alert gets activated when a new activity log event that matches the condition specified in the alert occurs.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-create-new-alert-rule?tabs=metric",
      "Command":"az",
      "main":"allOf",
      "first":"equals",
      "second":"field",
      "number":"1",
      "Args": "monitor activity-log alert list  --query [?(enabled==`true`)].id",
      "Second_Args": "monitor activity-log alert show --ids",
      "Second_To_Second_Args": "--query condition",
      "Valid1": "Microsoft.Network/publicIPAddresses/delete",
      "Valid2": "operationName",
      "Problem": "equal_is_not_equal",
      "Type": "stdout"
    },
    "18": {
      "Part" :"Activity Log",
      "num_req": "6",
      "Title": "Create Alert for 'Delete Security Solution' Events\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that an Azure activity log alert is used to detect Delete Security Solution events within your Microsoft Azure cloud account. Activity log alerts get activated when a new activity log event that matches the condition specified in the alert occurs. In this case, the condition required is 'Whenever the Security Activity Log Delete Security Solutions (Microsoft.Security/securitySolutions) has any level, with any status and event is initiated by any'.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-create-new-alert-rule?tabs=metric",
      "Command":"az",
      "main":"allOf",
      "first":"equals",
      "second":"field",
      "number":"1",
      "Args": "monitor activity-log alert list  --query [?(enabled==`true`)].id",
      "Second_Args": "monitor activity-log alert show --ids",
      "Second_To_Second_Args": "--query condition",
      "Valid1": "Microsoft.Security/securitySolutions/delete",
      "Valid2": "operationName",
      "Problem": "equal_is_not_equal",
      "Type": "stdout"
    },
    "19": {
      "Part" :"Activity Log",
      "num_req": "6",
      "Title": "Create Alert for 'Delete Storage Account' Events\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that a Microsoft Azure activity log alert is fired whenever a Delete Storage Account event is triggered within your cloud account. An Azure activity log alert fires each time the event that matches the condition specified in the alert configuration is triggered. The alert condition that this conformity rule checks for is `Whenever the Administrative Activity Log Delete Storage Account (Microsoft.Storage/storageAccounts) has any Event level, with any status and event is initiated by any`.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-create-new-alert-rule?tabs=metric",
      "Command":"az",
      "main":"allOf",
      "first":"equals",
      "second":"field",
      "number":"1",
      "Args": "monitor activity-log alert list  --query [?(enabled==`true`)].id",
      "Second_Args": "monitor activity-log alert show --ids",
      "Second_To_Second_Args": "--query condition",
      "Valid1": "Microsoft.Storage/storageAccounts/delete",
      "Valid2": "operationName",
      "Problem": "equal_is_not_equal",
      "Type": "stdout"
    },
    "20": {
      "Part" :"Activity Log",
      "num_req": "6",
      "Title": "Create Alert for 'Delete Virtual Machine' Events\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that a Microsoft Azure activity log alert is fired whenever a Delete Virtual Machine event is triggered within your cloud account. An Azure activity log alert fires each time the action event that matches the condition specified in the alert configuration is triggered. The alert condition that this conformity rule searches for is `Whenever the Administrative Activity Log Delete Virtual Machine (Microsoft.Compute/virtualMachines) has any Event level, with any Status and Event initiated by any`.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-create-new-alert-rule?tabs=metric",
      "Command":"az",
      "main":"allOf",
      "first":"equals",
      "second":"field",
      "number":"1",
      "Args": "monitor activity-log alert list  --query [?(enabled==`true`)].id",
      "Second_Args": "monitor activity-log alert show --ids",
      "Second_To_Second_Args": "--query condition",
      "Valid1": "Microsoft.Compute/virtualMachines/delete",
      "Valid2": "operationName",
      "Problem": "equal_is_not_equal",
      "Type": "stdout"
    },
    "21": {
      "Part" :"Activity Log",
      "num_req": "6",
      "Title": "Create Alert for 'Power Off Virtual Machine' Events\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that a Microsoft Azure activity log alert is fired whenever a Power Off Virtual Machine event is triggered within your cloud account. An Azure activity log alert fires each time the action event that matches the condition defined in the alert configuration is triggered. The alert condition that this conformity rule checks for is `Whenever the Administrative Activity Log Power Off Virtual Machine (Microsoft.Compute/virtualMachines) has any Event level, with any Status and Event initiated by any`.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-create-new-alert-rule?tabs=metric",
      "Command":"az",
      "main":"allOf",
      "first":"equals",
      "second":"field",
      "number":"1",
      "Args": "monitor activity-log alert list  --query [?(enabled==`true`)].id",
      "Second_Args": "monitor activity-log alert show --ids",
      "Second_To_Second_Args": "--query condition",
      "Valid1": "Microsoft.Compute/virtualMachines/powerOff/action",
      "Valid2": "operationName",
      "Problem": "equal_is_not_equal",
      "Type": "stdout"
    },
    "22": {
      "Part" :"Activity Log",
      "num_req": "6",
      "Title": "Create Alert for 'Rename Azure SQL Database' Events\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that an Azure activity log alert is fired whenever Rename Azure SQL Database events are triggered within your Microsoft Azure cloud account. Activity log alerts get triggered when a new activity log event that matches the condition specified in the alert configuration occurs. For this conformity rule, the matched condition is Whenever the Activity Log has an event with Category='Administrative', Signal name='Rename Azure SQL Database (servers/databases)'.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-create-new-alert-rule?tabs=metric",
      "Command":"az",
      "main":"allOf",
      "first":"equals",
      "second":"field",
      "number":"1",
      "Args": "monitor activity-log alert list  --query [?(enabled==`true`)].id",
      "Second_Args": "monitor activity-log alert show --ids",
      "Second_To_Second_Args": "--query condition",
      "Valid1": "Microsoft.Sql/servers/databases/move/action",
      "Valid2": "operationName",
      "Problem": "equal_is_not_equal",
      "Type": "stdout"
    },
    "23": {
      "Part" :"Activity Log",
      "num_req": "6",
      "Title": "Create Alert for 'Update Key Vault' Events\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that an Azure activity log alert is fired whenever Update Key Vault events are triggered within your Microsoft Azure cloud account. Activity log alerts get triggered when a new activity log event that matches the condition specified in the alert configuration occurs. For this conformity rule, the matched condition is Whenever the Activity Log has an event with Category='Administrative', Signal name='Update Key Vault (vaults)'.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-create-new-alert-rule?tabs=metric",
      "Command":"az",
      "main":"allOf",
      "first":"equals",
      "second":"field",
      "number":"1",
      "Args": "monitor activity-log alert list  --query [?(enabled==`true`)].id",
      "Second_Args": "monitor activity-log alert show --ids",
      "Second_To_Second_Args": "--query condition",
      "Valid1": "Microsoft.KeyVault/vaults/write",
      "Valid2": "operationName",
      "Problem": "equal_is_not_equal",
      "Type": "stdout"
    },
    "24": {
      "Part" :"Activity Log",
      "num_req": "6",
      "Title": "Create Alert for 'Update Security Policy' Events\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that an Azure activity log alert is used to detect Update Security Policy events within your Microsoft Azure cloud account. Activity log alerts get activated when a new activity log event that matches the condition specified in the alert occurs. In this case, the required alert condition is 'Whenever the Security Activity Log Update security policy (Microsoft.Security/policies) has any level, with any status and event is initiated by any'.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-create-new-alert-rule?tabs=metric",
      "Command":"az",
      "main":"allOf",
      "first":"equals",
      "second":"field",
      "number":"1",
      "Args": "monitor activity-log alert list  --query [?(enabled==`true`)].id",
      "Second_Args": "monitor activity-log alert show --ids",
      "Second_To_Second_Args": "--query condition",
      "Valid1": "Microsoft.Security/policies/write",
      "Valid2": "operationName",
      "Problem": "equal_is_not_equal",
      "Type": "stdout"
    },
    "25": {
      "Part" :"Activity Log",
      "num_req": "6",
      "Title": "Create Alert for 'Create/Update MySQL Database' Events\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that an Azure activity log alert is fired whenever “Create/Update MySQL Database” events are triggered within your Microsoft Azure cloud account. The log alerts get triggered when a new activity log event that matches the condition specified in the alert configuration occurs. For this conformity rule, the matched condition is Whenever the Activity Log has an event with Category='Administrative', Signal name='Create/Update MySQL Database (servers/databases)'.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-create-new-alert-rule?tabs=metric",
      "Command":"az",
      "main":"allOf",
      "first":"equals",
      "second":"field",
      "number":"1",
      "Args": "monitor activity-log alert list  --query [?(enabled==`true`)].id",
      "Second_Args": "monitor activity-log alert show --ids",
      "Second_To_Second_Args": "--query condition",
      "Valid1": "Microsoft.DBforMySQL/servers/databases/write",
      "Valid2": "operationName",
      "Problem": "equal_is_not_equal",
      "Type": "stdout"
    },
    "26": {
      "Part" :"Activity Log",
      "num_req": "6",
      "Title": "Create Alert for 'Create/Update Network Security Group Rule' Events\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that an Azure activity log alert is fired whenever “Create” or “Update Network Security Group Rule” events are triggered within your Microsoft Azure cloud account. Activity log alerts get activated when a new activity log event that matches the condition specified in the alert occurs. In this case, the alert condition required is 'Whenever the Administrative Activity Log Create or Update Security Rule (networkSecurityGroups/securityRules) has any level, with any status and event is initiated by any'.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-create-new-alert-rule?tabs=metric",
      "Command":"az",
      "main":"allOf",
      "first":"equals",
      "second":"field",
      "number":"1",
      "Args": "monitor activity-log alert list  --query [?(enabled==`true`)].id",
      "Second_Args": "monitor activity-log alert show --ids",
      "Second_To_Second_Args": "--query condition",
      "Valid1": "Microsoft.Network/networkSecurityGroups/securityRules/write",
      "Valid2": "operationName",
      "Problem": "equal_is_not_equal",
      "Type": "stdout"
    },
    "27": {
      "Part" :"Activity Log",
      "num_req": "6",
      "Title": "Create Alert for 'Create/Update PostgreSQL Database' Events\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that an Azure activity log alert is fired whenever “Create/Update PostgreSQL Database” events are triggered within your Microsoft Azure cloud account. The log alerts get triggered when a new activity log event that matches the condition specified in the alert configuration occurs. For this conformity rule, the matched condition is Whenever the Activity Log has an event with Category='Administrative', Signal name='Create/Update PostgreSQL Database (servers/databases)'.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-create-new-alert-rule?tabs=metric",
      "Command":"az",
      "main":"allOf",
      "first":"equals",
      "second":"field",
      "number":"1",
      "Args": "monitor activity-log alert list  --query [?(enabled==`true`)].id",
      "Second_Args": "monitor activity-log alert show --ids",
      "Second_To_Second_Args": "--query condition",
      "Valid1": "Microsoft.DBforPostgreSQL/servers/databases/write",
      "Valid2": "operationName",
      "Problem": "equal_is_not_equal",
      "Type": "stdout"
    },
    "28": {
      "Part" :"Activity Log",
      "num_req": "6",
      "Title": "Create Alert for 'Delete MySQL Database' Events\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that a Microsoft Azure activity log alert is fired whenever a “Delete MySQL Database” event is triggered within your cloud account. An Azure activity log alert fires each time the action event that matches the condition specified in the alert configuration is triggered. The alert condition that this conformity rule checks for is Whenever the Activity Log has an event with Category='Administrative', Signal name='Delete MySQL Database (servers/databases)'.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-create-new-alert-rule?tabs=metric",
      "Command":"az",
      "main":"allOf",
      "first":"equals",
      "second":"field",
      "number":"1",
      "Args": "monitor activity-log alert list  --query [?(enabled==`true`)].id",
      "Second_Args": "monitor activity-log alert show --ids",
      "Second_To_Second_Args": "--query condition",
      "Valid1": "Microsoft.DBforMySQL/servers/databases/delete",
      "Valid2": "operationName",
      "Problem": "equal_is_not_equal",
      "Type": "stdout"
    },
    "29": {
      "Part" :"Activity Log",
      "num_req": "6",
      "Title": "Create Alert for 'Delete PostgreSQL Database' Events\n",
      "Risk_Level":"High",
      "Descrip": "Ensure that a Microsoft Azure activity log alert is fired whenever a “Delete PostgreSQL Database” event is triggered within your cloud account. An Azure activity log alert fires each time the action event that matches the condition specified in the alert configuration is triggered. The alert condition that this conformity rule checks for is Whenever the Activity Log has an event with Category='Administrative', Signal name='Delete PostgreSQL Database (Microsoft.DBforPostgreSQL/servers/databases)'.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-create-new-alert-rule?tabs=metric",
      "Command":"az",
      "main":"allOf",
      "first":"equals",
      "second":"field",
      "number":"1",
      "Args": "monitor activity-log alert list  --query [?(enabled==`true`)].id",
      "Second_Args": "monitor activity-log alert show --ids",
      "Second_To_Second_Args": "--query condition",
      "Valid1": "Microsoft.DBforMySQL/servers/databases/delete",
      "Valid2": "operationName",
      "Problem": "equal_is_not_equal",
      "Type": "stdout"
    },
    "30": {
      "Part" :"Monitor",
      "num_req": "1",
      "Title": "Activity Log Retention\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure that the Log Profile created for your Azure activity log has a retention period of 365 days or more, configured for reliability and compliance purposes. A Log Profile controls how the activity log is exported and retained within your Azure cloud account. The retention period represents the number of days to retain activity logs for a Microsoft Azure cloud subscription.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/azure-monitor/essentials/activity-log",
      "Args": "YXogbW9uaXRvciBsb2ctcHJvZmlsZXMgbGlzdCAtLXF1ZXJ5ICdbKl0ucmV0ZW50aW9uUG9saWN5Jw==",
      "Problem": "equal-less",
      "Type": "stdout",
      "Valid":"365"
    },
  "31": {
      "Part" :"Monitor",
      "num_req": "1",
      "Title": "Azure Activity Log Profile in Use\n",
      "Risk_Level":"Medium",
      "Descrip": "Ensure there is a Log Profile created for each Microsoft Azure account subscription for exporting activity logs. The Azure activity log captures all management activities performed on a subscription. By default, the Azure Portal retains activity logs only for 90 days. To make sure that all activity events recorded for your subscription are retained for a longer duration, you can create and configure a Log Profile to archive the activity log to an Azure storage account or stream it to an Event Hub. Each Microsoft Azure subscription can have only one Log Profile.\n",
      "Reference":"https://learn.microsoft.com/en-us/azure/azure-monitor/essentials/activity-log?tabs=powershell",
      "Args": "YXogbW9uaXRvciBsb2ctcHJvZmlsZXMgbGlzdCAtLXF1ZXJ5ICdbKl0ubmFtZSc=",
      "Problem": "equal",
      "Type": "stdout",
      "Valid":""
    },
    "32": {
        "Part" :"Monitor",
        "num_req": "2",
        "Title": "Enable Subscription Activity Log Diagnostic Settings\n",
        "Risk_Level":"Medium",
        "Descrip": "Ensure that Azure Monitor Activity Logs for your subscription are exported to an appropriate data store using diagnostic settings. Diagnostic settings improve on the legacy Log Profile method for exporting Activity Logs by providing better functionality and consistency with resource logs. The Azure activity log captures all management activities performed on a subscription. By default, the Azure Portal only retains activity logs for 90 days. To make sure that all activity events recorded for your subscription are retained for a longer duration, configure a diagnostic setting to export and archive the activity log to an Azure storage account or stream it to an Event Hub.\n",
        "Reference":"https://learn.microsoft.com/en-us/azure/azure-monitor/essentials/diagnostic-settings?tabs=portal",
        "Command":"az",
        "Args": "account list --query [*].id",
        "Second_Args": "monitor diagnostic-settings subscription list --subscription",
        "Second_To_Second_Args": "--query value[*].id",
        "Problem": "equal",
        "Type": "stdout",
        "Valid":""
      }
}